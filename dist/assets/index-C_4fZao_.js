(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ET(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dw={exports:{}},wu={},Lw={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ha=Symbol.for("react.element"),TT=Symbol.for("react.portal"),IT=Symbol.for("react.fragment"),NT=Symbol.for("react.strict_mode"),ST=Symbol.for("react.profiler"),kT=Symbol.for("react.provider"),CT=Symbol.for("react.context"),AT=Symbol.for("react.forward_ref"),PT=Symbol.for("react.suspense"),RT=Symbol.for("react.memo"),jT=Symbol.for("react.lazy"),xy=Symbol.iterator;function DT(t){return t===null||typeof t!="object"?null:(t=xy&&t[xy]||t["@@iterator"],typeof t=="function"?t:null)}var Mw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ow=Object.assign,Vw={};function Ji(t,e,n){this.props=t,this.context=e,this.refs=Vw,this.updater=n||Mw}Ji.prototype.isReactComponent={};Ji.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ji.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Fw(){}Fw.prototype=Ji.prototype;function om(t,e,n){this.props=t,this.context=e,this.refs=Vw,this.updater=n||Mw}var am=om.prototype=new Fw;am.constructor=om;Ow(am,Ji.prototype);am.isPureReactComponent=!0;var _y=Array.isArray,Uw=Object.prototype.hasOwnProperty,lm={current:null},$w={key:!0,ref:!0,__self:!0,__source:!0};function Bw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Uw.call(e,r)&&!$w.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ha,type:t,key:i,ref:o,props:s,_owner:lm.current}}function LT(t,e){return{$$typeof:Ha,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ha}function MT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var by=/\/+/g;function Od(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MT(""+t.key):e.toString(36)}function Xl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ha:case TT:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Od(o,0):r,_y(s)?(n="",t!=null&&(n=t.replace(by,"$&/")+"/"),Xl(s,e,n,"",function(d){return d})):s!=null&&(cm(s)&&(s=LT(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(by,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",_y(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Od(i,l);o+=Xl(i,e,n,u,s)}else if(u=DT(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Od(i,l++),o+=Xl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Tl(t,e,n){if(t==null)return t;var r=[],s=0;return Xl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function OT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var It={current:null},Jl={transition:null},VT={ReactCurrentDispatcher:It,ReactCurrentBatchConfig:Jl,ReactCurrentOwner:lm};function zw(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Tl,forEach:function(t,e,n){Tl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Tl(t,function(){e++}),e},toArray:function(t){return Tl(t,function(e){return e})||[]},only:function(t){if(!cm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=Ji;ae.Fragment=IT;ae.Profiler=ST;ae.PureComponent=om;ae.StrictMode=NT;ae.Suspense=PT;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VT;ae.act=zw;ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ow({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=lm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Uw.call(e,u)&&!$w.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Ha,type:t.type,key:s,ref:i,props:r,_owner:o}};ae.createContext=function(t){return t={$$typeof:CT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kT,_context:t},t.Consumer=t};ae.createElement=Bw;ae.createFactory=function(t){var e=Bw.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:AT,render:t}};ae.isValidElement=cm;ae.lazy=function(t){return{$$typeof:jT,_payload:{_status:-1,_result:t},_init:OT}};ae.memo=function(t,e){return{$$typeof:RT,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=Jl.transition;Jl.transition={};try{t()}finally{Jl.transition=e}};ae.unstable_act=zw;ae.useCallback=function(t,e){return It.current.useCallback(t,e)};ae.useContext=function(t){return It.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return It.current.useDeferredValue(t)};ae.useEffect=function(t,e){return It.current.useEffect(t,e)};ae.useId=function(){return It.current.useId()};ae.useImperativeHandle=function(t,e,n){return It.current.useImperativeHandle(t,e,n)};ae.useInsertionEffect=function(t,e){return It.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return It.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return It.current.useMemo(t,e)};ae.useReducer=function(t,e,n){return It.current.useReducer(t,e,n)};ae.useRef=function(t){return It.current.useRef(t)};ae.useState=function(t){return It.current.useState(t)};ae.useSyncExternalStore=function(t,e,n){return It.current.useSyncExternalStore(t,e,n)};ae.useTransition=function(){return It.current.useTransition()};ae.version="18.3.1";Lw.exports=ae;var A=Lw.exports;const qw=ET(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FT=A,UT=Symbol.for("react.element"),$T=Symbol.for("react.fragment"),BT=Object.prototype.hasOwnProperty,zT=FT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qT={key:!0,ref:!0,__self:!0,__source:!0};function Hw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)BT.call(e,r)&&!qT.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:UT,type:t,key:i,ref:o,props:s,_owner:zT.current}}wu.Fragment=$T;wu.jsx=Hw;wu.jsxs=Hw;Dw.exports=wu;var a=Dw.exports,Ah={},Ww={exports:{}},Xt={},Gw={exports:{}},Kw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,F){var L=B.length;B.push(F);e:for(;0<L;){var q=L-1>>>1,ee=B[q];if(0<s(ee,F))B[q]=F,B[L]=ee,L=q;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var F=B[0],L=B.pop();if(L!==F){B[0]=L;e:for(var q=0,ee=B.length,we=ee>>>1;q<we;){var me=2*(q+1)-1,pe=B[me],Pe=me+1,ct=B[Pe];if(0>s(pe,L))Pe<ee&&0>s(ct,pe)?(B[q]=ct,B[Pe]=L,q=Pe):(B[q]=pe,B[me]=L,q=me);else if(Pe<ee&&0>s(ct,L))B[q]=ct,B[Pe]=L,q=Pe;else break e}}return F}function s(B,F){var L=B.sortIndex-F.sortIndex;return L!==0?L:B.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,m=null,g=3,v=!1,S=!1,N=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(B){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=B)r(d),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(d)}}function R(B){if(N=!1,E(B),!S)if(n(u)!==null)S=!0,G(P);else{var F=n(d);F!==null&&z(R,F.startTime-B)}}function P(B,F){S=!1,N&&(N=!1,x(w),w=-1),v=!0;var L=g;try{for(E(F),m=n(u);m!==null&&(!(m.expirationTime>F)||B&&!j());){var q=m.callback;if(typeof q=="function"){m.callback=null,g=m.priorityLevel;var ee=q(m.expirationTime<=F);F=t.unstable_now(),typeof ee=="function"?m.callback=ee:m===n(u)&&r(u),E(F)}else r(u);m=n(u)}if(m!==null)var we=!0;else{var me=n(d);me!==null&&z(R,me.startTime-F),we=!1}return we}finally{m=null,g=L,v=!1}}var O=!1,T=null,w=-1,I=5,C=-1;function j(){return!(t.unstable_now()-C<I)}function D(){if(T!==null){var B=t.unstable_now();C=B;var F=!0;try{F=T(!0,B)}finally{F?k():(O=!1,T=null)}}else O=!1}var k;if(typeof y=="function")k=function(){y(D)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,J=H.port2;H.port1.onmessage=D,k=function(){J.postMessage(null)}}else k=function(){b(D,0)};function G(B){T=B,O||(O=!0,k())}function z(B,F){w=b(function(){B(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){S||v||(S=!0,G(P))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(B){switch(g){case 1:case 2:case 3:var F=3;break;default:F=g}var L=g;g=F;try{return B()}finally{g=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,F){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var L=g;g=B;try{return F()}finally{g=L}},t.unstable_scheduleCallback=function(B,F,L){var q=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?q+L:q):L=q,B){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=L+ee,B={id:h++,callback:F,priorityLevel:B,startTime:L,expirationTime:ee,sortIndex:-1},L>q?(B.sortIndex=L,e(d,B),n(u)===null&&B===n(d)&&(N?(x(w),w=-1):N=!0,z(R,L-q))):(B.sortIndex=ee,e(u,B),S||v||(S=!0,G(P))),B},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(B){var F=g;return function(){var L=g;g=F;try{return B.apply(this,arguments)}finally{g=L}}}})(Kw);Gw.exports=Kw;var HT=Gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WT=A,Yt=HT;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qw=new Set,da={};function Js(t,e){Fi(t,e),Fi(t+"Capture",e)}function Fi(t,e){for(da[t]=e,t=0;t<e.length;t++)Qw.add(e[t])}var or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ph=Object.prototype.hasOwnProperty,GT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ey={},Ty={};function KT(t){return Ph.call(Ty,t)?!0:Ph.call(Ey,t)?!1:GT.test(t)?Ty[t]=!0:(Ey[t]=!0,!1)}function QT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function YT(t,e,n,r){if(e===null||typeof e>"u"||QT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new Nt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new Nt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new Nt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new Nt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new Nt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new Nt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new Nt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new Nt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new Nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var um=/[\-:]([a-z])/g;function dm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(um,dm);ot[e]=new Nt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(um,dm);ot[e]=new Nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(um,dm);ot[e]=new Nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new Nt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new Nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function hm(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YT(e,n,s,r)&&(n=null),r||s===null?KT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var vr=WT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Il=Symbol.for("react.element"),pi=Symbol.for("react.portal"),gi=Symbol.for("react.fragment"),fm=Symbol.for("react.strict_mode"),Rh=Symbol.for("react.profiler"),Yw=Symbol.for("react.provider"),Xw=Symbol.for("react.context"),mm=Symbol.for("react.forward_ref"),jh=Symbol.for("react.suspense"),Dh=Symbol.for("react.suspense_list"),pm=Symbol.for("react.memo"),Ar=Symbol.for("react.lazy"),Jw=Symbol.for("react.offscreen"),Iy=Symbol.iterator;function So(t){return t===null||typeof t!="object"?null:(t=Iy&&t[Iy]||t["@@iterator"],typeof t=="function"?t:null)}var Le=Object.assign,Vd;function Oo(t){if(Vd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vd=e&&e[1]||""}return`
`+Vd+t}var Fd=!1;function Ud(t,e){if(!t||Fd)return"";Fd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Fd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oo(t):""}function XT(t){switch(t.tag){case 5:return Oo(t.type);case 16:return Oo("Lazy");case 13:return Oo("Suspense");case 19:return Oo("SuspenseList");case 0:case 2:case 15:return t=Ud(t.type,!1),t;case 11:return t=Ud(t.type.render,!1),t;case 1:return t=Ud(t.type,!0),t;default:return""}}function Lh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gi:return"Fragment";case pi:return"Portal";case Rh:return"Profiler";case fm:return"StrictMode";case jh:return"Suspense";case Dh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Xw:return(t.displayName||"Context")+".Consumer";case Yw:return(t._context.displayName||"Context")+".Provider";case mm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pm:return e=t.displayName||null,e!==null?e:Lh(t.type)||"Memo";case Ar:e=t._payload,t=t._init;try{return Lh(t(e))}catch{}}return null}function JT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lh(e);case 8:return e===fm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZT(t){var e=Zw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nl(t){t._valueTracker||(t._valueTracker=ZT(t))}function ex(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Zw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function bc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mh(t,e){var n=e.checked;return Le({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ny(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tx(t,e){e=e.checked,e!=null&&hm(t,"checked",e,!1)}function Oh(t,e){tx(t,e);var n=Zr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vh(t,e.type,Zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vh(t,e,n){(e!=="number"||bc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Vo=Array.isArray;function Si(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Fh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Le({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ky(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(Vo(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zr(n)}}function nx(t,e){var n=Zr(e.value),r=Zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sl,sx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ha(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ko={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eI=["Webkit","ms","Moz","O"];Object.keys(Ko).forEach(function(t){eI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ko[e]=Ko[t]})});function ix(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ko.hasOwnProperty(t)&&Ko[t]?(""+e).trim():e+"px"}function ox(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ix(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var tI=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $h(t,e){if(e){if(tI[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Bh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zh=null;function gm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qh=null,ki=null,Ci=null;function Ay(t){if(t=Ka(t)){if(typeof qh!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Tu(e),qh(t.stateNode,t.type,e))}}function ax(t){ki?Ci?Ci.push(t):Ci=[t]:ki=t}function lx(){if(ki){var t=ki,e=Ci;if(Ci=ki=null,Ay(t),e)for(t=0;t<e.length;t++)Ay(e[t])}}function cx(t,e){return t(e)}function ux(){}var $d=!1;function dx(t,e,n){if($d)return t(e,n);$d=!0;try{return cx(t,e,n)}finally{$d=!1,(ki!==null||Ci!==null)&&(ux(),lx())}}function fa(t,e){var n=t.stateNode;if(n===null)return null;var r=Tu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Hh=!1;if(or)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){Hh=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{Hh=!1}function nI(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Qo=!1,Ec=null,Tc=!1,Wh=null,rI={onError:function(t){Qo=!0,Ec=t}};function sI(t,e,n,r,s,i,o,l,u){Qo=!1,Ec=null,nI.apply(rI,arguments)}function iI(t,e,n,r,s,i,o,l,u){if(sI.apply(this,arguments),Qo){if(Qo){var d=Ec;Qo=!1,Ec=null}else throw Error(W(198));Tc||(Tc=!0,Wh=d)}}function Zs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Py(t){if(Zs(t)!==t)throw Error(W(188))}function oI(t){var e=t.alternate;if(!e){if(e=Zs(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Py(s),t;if(i===r)return Py(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function fx(t){return t=oI(t),t!==null?mx(t):null}function mx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=mx(t);if(e!==null)return e;t=t.sibling}return null}var px=Yt.unstable_scheduleCallback,Ry=Yt.unstable_cancelCallback,aI=Yt.unstable_shouldYield,lI=Yt.unstable_requestPaint,Be=Yt.unstable_now,cI=Yt.unstable_getCurrentPriorityLevel,ym=Yt.unstable_ImmediatePriority,gx=Yt.unstable_UserBlockingPriority,Ic=Yt.unstable_NormalPriority,uI=Yt.unstable_LowPriority,yx=Yt.unstable_IdlePriority,xu=null,Ln=null;function dI(t){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(xu,t,void 0,(t.current.flags&128)===128)}catch{}}var gn=Math.clz32?Math.clz32:mI,hI=Math.log,fI=Math.LN2;function mI(t){return t>>>=0,t===0?32:31-(hI(t)/fI|0)|0}var kl=64,Cl=4194304;function Fo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Fo(l):(i&=o,i!==0&&(r=Fo(i)))}else o=n&~s,o!==0?r=Fo(o):i!==0&&(r=Fo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-gn(e),s=1<<n,r|=t[n],e&=~s;return r}function pI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gI(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-gn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=pI(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Gh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vx(){var t=kl;return kl<<=1,!(kl&4194240)&&(kl=64),t}function Bd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gn(e),t[e]=n}function yI(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-gn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function vm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-gn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ve=0;function wx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var xx,wm,_x,bx,Ex,Kh=!1,Al=[],$r=null,Br=null,zr=null,ma=new Map,pa=new Map,Rr=[],vI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jy(t,e){switch(t){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":ma.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pa.delete(e.pointerId)}}function Co(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ka(e),e!==null&&wm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function wI(t,e,n,r,s){switch(e){case"focusin":return $r=Co($r,t,e,n,r,s),!0;case"dragenter":return Br=Co(Br,t,e,n,r,s),!0;case"mouseover":return zr=Co(zr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ma.set(i,Co(ma.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,pa.set(i,Co(pa.get(i)||null,t,e,n,r,s)),!0}return!1}function Tx(t){var e=ks(t.target);if(e!==null){var n=Zs(e);if(n!==null){if(e=n.tag,e===13){if(e=hx(n),e!==null){t.blockedOn=e,Ex(t.priority,function(){_x(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zh=r,n.target.dispatchEvent(r),zh=null}else return e=Ka(n),e!==null&&wm(e),t.blockedOn=n,!1;e.shift()}return!0}function Dy(t,e,n){Zl(t)&&n.delete(e)}function xI(){Kh=!1,$r!==null&&Zl($r)&&($r=null),Br!==null&&Zl(Br)&&(Br=null),zr!==null&&Zl(zr)&&(zr=null),ma.forEach(Dy),pa.forEach(Dy)}function Ao(t,e){t.blockedOn===e&&(t.blockedOn=null,Kh||(Kh=!0,Yt.unstable_scheduleCallback(Yt.unstable_NormalPriority,xI)))}function ga(t){function e(s){return Ao(s,t)}if(0<Al.length){Ao(Al[0],t);for(var n=1;n<Al.length;n++){var r=Al[n];r.blockedOn===t&&(r.blockedOn=null)}}for($r!==null&&Ao($r,t),Br!==null&&Ao(Br,t),zr!==null&&Ao(zr,t),ma.forEach(e),pa.forEach(e),n=0;n<Rr.length;n++)r=Rr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Rr.length&&(n=Rr[0],n.blockedOn===null);)Tx(n),n.blockedOn===null&&Rr.shift()}var Ai=vr.ReactCurrentBatchConfig,Sc=!0;function _I(t,e,n,r){var s=ve,i=Ai.transition;Ai.transition=null;try{ve=1,xm(t,e,n,r)}finally{ve=s,Ai.transition=i}}function bI(t,e,n,r){var s=ve,i=Ai.transition;Ai.transition=null;try{ve=4,xm(t,e,n,r)}finally{ve=s,Ai.transition=i}}function xm(t,e,n,r){if(Sc){var s=Qh(t,e,n,r);if(s===null)Jd(t,e,r,kc,n),jy(t,r);else if(wI(s,t,e,n,r))r.stopPropagation();else if(jy(t,r),e&4&&-1<vI.indexOf(t)){for(;s!==null;){var i=Ka(s);if(i!==null&&xx(i),i=Qh(t,e,n,r),i===null&&Jd(t,e,r,kc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Jd(t,e,r,null,n)}}var kc=null;function Qh(t,e,n,r){if(kc=null,t=gm(r),t=ks(t),t!==null)if(e=Zs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return kc=t,null}function Ix(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cI()){case ym:return 1;case gx:return 4;case Ic:case uI:return 16;case yx:return 536870912;default:return 16}default:return 16}}var Vr=null,_m=null,ec=null;function Nx(){if(ec)return ec;var t,e=_m,n=e.length,r,s="value"in Vr?Vr.value:Vr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ec=s.slice(t,1<r?1-r:void 0)}function tc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Pl(){return!0}function Ly(){return!1}function Jt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Pl:Ly,this.isPropagationStopped=Ly,this}return Le(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pl)},persist:function(){},isPersistent:Pl}),e}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bm=Jt(Zi),Ga=Le({},Zi,{view:0,detail:0}),EI=Jt(Ga),zd,qd,Po,_u=Le({},Ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Em,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Po&&(Po&&t.type==="mousemove"?(zd=t.screenX-Po.screenX,qd=t.screenY-Po.screenY):qd=zd=0,Po=t),zd)},movementY:function(t){return"movementY"in t?t.movementY:qd}}),My=Jt(_u),TI=Le({},_u,{dataTransfer:0}),II=Jt(TI),NI=Le({},Ga,{relatedTarget:0}),Hd=Jt(NI),SI=Le({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),kI=Jt(SI),CI=Le({},Zi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),AI=Jt(CI),PI=Le({},Zi,{data:0}),Oy=Jt(PI),RI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=DI[t])?!!e[t]:!1}function Em(){return LI}var MI=Le({},Ga,{key:function(t){if(t.key){var e=RI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Em,charCode:function(t){return t.type==="keypress"?tc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OI=Jt(MI),VI=Le({},_u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vy=Jt(VI),FI=Le({},Ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Em}),UI=Jt(FI),$I=Le({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),BI=Jt($I),zI=Le({},_u,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qI=Jt(zI),HI=[9,13,27,32],Tm=or&&"CompositionEvent"in window,Yo=null;or&&"documentMode"in document&&(Yo=document.documentMode);var WI=or&&"TextEvent"in window&&!Yo,Sx=or&&(!Tm||Yo&&8<Yo&&11>=Yo),Fy=" ",Uy=!1;function kx(t,e){switch(t){case"keyup":return HI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yi=!1;function GI(t,e){switch(t){case"compositionend":return Cx(e);case"keypress":return e.which!==32?null:(Uy=!0,Fy);case"textInput":return t=e.data,t===Fy&&Uy?null:t;default:return null}}function KI(t,e){if(yi)return t==="compositionend"||!Tm&&kx(t,e)?(t=Nx(),ec=_m=Vr=null,yi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Sx&&e.locale!=="ko"?null:e.data;default:return null}}var QI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!QI[t.type]:e==="textarea"}function Ax(t,e,n,r){ax(r),e=Cc(e,"onChange"),0<e.length&&(n=new bm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xo=null,ya=null;function YI(t){$x(t,0)}function bu(t){var e=xi(t);if(ex(e))return t}function XI(t,e){if(t==="change")return e}var Px=!1;if(or){var Wd;if(or){var Gd="oninput"in document;if(!Gd){var By=document.createElement("div");By.setAttribute("oninput","return;"),Gd=typeof By.oninput=="function"}Wd=Gd}else Wd=!1;Px=Wd&&(!document.documentMode||9<document.documentMode)}function zy(){Xo&&(Xo.detachEvent("onpropertychange",Rx),ya=Xo=null)}function Rx(t){if(t.propertyName==="value"&&bu(ya)){var e=[];Ax(e,ya,t,gm(t)),dx(YI,e)}}function JI(t,e,n){t==="focusin"?(zy(),Xo=e,ya=n,Xo.attachEvent("onpropertychange",Rx)):t==="focusout"&&zy()}function ZI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bu(ya)}function eN(t,e){if(t==="click")return bu(e)}function tN(t,e){if(t==="input"||t==="change")return bu(e)}function nN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wn=typeof Object.is=="function"?Object.is:nN;function va(t,e){if(wn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ph.call(e,s)||!wn(t[s],e[s]))return!1}return!0}function qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hy(t,e){var n=qy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=qy(n)}}function jx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?jx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Dx(){for(var t=window,e=bc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=bc(t.document)}return e}function Im(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function rN(t){var e=Dx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&jx(n.ownerDocument.documentElement,n)){if(r!==null&&Im(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Hy(n,i);var o=Hy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var sN=or&&"documentMode"in document&&11>=document.documentMode,vi=null,Yh=null,Jo=null,Xh=!1;function Wy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xh||vi==null||vi!==bc(r)||(r=vi,"selectionStart"in r&&Im(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jo&&va(Jo,r)||(Jo=r,r=Cc(Yh,"onSelect"),0<r.length&&(e=new bm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=vi)))}function Rl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:Rl("Animation","AnimationEnd"),animationiteration:Rl("Animation","AnimationIteration"),animationstart:Rl("Animation","AnimationStart"),transitionend:Rl("Transition","TransitionEnd")},Kd={},Lx={};or&&(Lx=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function Eu(t){if(Kd[t])return Kd[t];if(!wi[t])return t;var e=wi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Lx)return Kd[t]=e[n];return t}var Mx=Eu("animationend"),Ox=Eu("animationiteration"),Vx=Eu("animationstart"),Fx=Eu("transitionend"),Ux=new Map,Gy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(t,e){Ux.set(t,e),Js(e,[t])}for(var Qd=0;Qd<Gy.length;Qd++){var Yd=Gy[Qd],iN=Yd.toLowerCase(),oN=Yd[0].toUpperCase()+Yd.slice(1);cs(iN,"on"+oN)}cs(Mx,"onAnimationEnd");cs(Ox,"onAnimationIteration");cs(Vx,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(Fx,"onTransitionEnd");Fi("onMouseEnter",["mouseout","mouseover"]);Fi("onMouseLeave",["mouseout","mouseover"]);Fi("onPointerEnter",["pointerout","pointerover"]);Fi("onPointerLeave",["pointerout","pointerover"]);Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Js("onBeforeInput",["compositionend","keypress","textInput","paste"]);Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uo));function Ky(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,iI(r,e,void 0,t),t.currentTarget=null}function $x(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Ky(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Ky(s,l,d),i=u}}}if(Tc)throw t=Wh,Tc=!1,Wh=null,t}function Te(t,e){var n=e[nf];n===void 0&&(n=e[nf]=new Set);var r=t+"__bubble";n.has(r)||(Bx(e,t,2,!1),n.add(r))}function Xd(t,e,n){var r=0;e&&(r|=4),Bx(n,t,r,e)}var jl="_reactListening"+Math.random().toString(36).slice(2);function wa(t){if(!t[jl]){t[jl]=!0,Qw.forEach(function(n){n!=="selectionchange"&&(aN.has(n)||Xd(n,!1,t),Xd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jl]||(e[jl]=!0,Xd("selectionchange",!1,e))}}function Bx(t,e,n,r){switch(Ix(e)){case 1:var s=_I;break;case 4:s=bI;break;default:s=xm}n=s.bind(null,e,n,t),s=void 0,!Hh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Jd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ks(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}dx(function(){var d=i,h=gm(n),m=[];e:{var g=Ux.get(t);if(g!==void 0){var v=bm,S=t;switch(t){case"keypress":if(tc(n)===0)break e;case"keydown":case"keyup":v=OI;break;case"focusin":S="focus",v=Hd;break;case"focusout":S="blur",v=Hd;break;case"beforeblur":case"afterblur":v=Hd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=My;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=II;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=UI;break;case Mx:case Ox:case Vx:v=kI;break;case Fx:v=BI;break;case"scroll":v=EI;break;case"wheel":v=qI;break;case"copy":case"cut":case"paste":v=AI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Vy}var N=(e&4)!==0,b=!N&&t==="scroll",x=N?g!==null?g+"Capture":null:g;N=[];for(var y=d,E;y!==null;){E=y;var R=E.stateNode;if(E.tag===5&&R!==null&&(E=R,x!==null&&(R=fa(y,x),R!=null&&N.push(xa(y,R,E)))),b)break;y=y.return}0<N.length&&(g=new v(g,S,null,n,h),m.push({event:g,listeners:N}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==zh&&(S=n.relatedTarget||n.fromElement)&&(ks(S)||S[ar]))break e;if((v||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,v?(S=n.relatedTarget||n.toElement,v=d,S=S?ks(S):null,S!==null&&(b=Zs(S),S!==b||S.tag!==5&&S.tag!==6)&&(S=null)):(v=null,S=d),v!==S)){if(N=My,R="onMouseLeave",x="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(N=Vy,R="onPointerLeave",x="onPointerEnter",y="pointer"),b=v==null?g:xi(v),E=S==null?g:xi(S),g=new N(R,y+"leave",v,n,h),g.target=b,g.relatedTarget=E,R=null,ks(h)===d&&(N=new N(x,y+"enter",S,n,h),N.target=E,N.relatedTarget=b,R=N),b=R,v&&S)t:{for(N=v,x=S,y=0,E=N;E;E=ci(E))y++;for(E=0,R=x;R;R=ci(R))E++;for(;0<y-E;)N=ci(N),y--;for(;0<E-y;)x=ci(x),E--;for(;y--;){if(N===x||x!==null&&N===x.alternate)break t;N=ci(N),x=ci(x)}N=null}else N=null;v!==null&&Qy(m,g,v,N,!1),S!==null&&b!==null&&Qy(m,b,S,N,!0)}}e:{if(g=d?xi(d):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var P=XI;else if($y(g))if(Px)P=tN;else{P=ZI;var O=JI}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(P=eN);if(P&&(P=P(t,d))){Ax(m,P,n,h);break e}O&&O(t,g,d),t==="focusout"&&(O=g._wrapperState)&&O.controlled&&g.type==="number"&&Vh(g,"number",g.value)}switch(O=d?xi(d):window,t){case"focusin":($y(O)||O.contentEditable==="true")&&(vi=O,Yh=d,Jo=null);break;case"focusout":Jo=Yh=vi=null;break;case"mousedown":Xh=!0;break;case"contextmenu":case"mouseup":case"dragend":Xh=!1,Wy(m,n,h);break;case"selectionchange":if(sN)break;case"keydown":case"keyup":Wy(m,n,h)}var T;if(Tm)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else yi?kx(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Sx&&n.locale!=="ko"&&(yi||w!=="onCompositionStart"?w==="onCompositionEnd"&&yi&&(T=Nx()):(Vr=h,_m="value"in Vr?Vr.value:Vr.textContent,yi=!0)),O=Cc(d,w),0<O.length&&(w=new Oy(w,t,null,n,h),m.push({event:w,listeners:O}),T?w.data=T:(T=Cx(n),T!==null&&(w.data=T)))),(T=WI?GI(t,n):KI(t,n))&&(d=Cc(d,"onBeforeInput"),0<d.length&&(h=new Oy("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=T))}$x(m,e)})}function xa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Cc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=fa(t,n),i!=null&&r.unshift(xa(t,i,s)),i=fa(t,e),i!=null&&r.push(xa(t,i,s))),t=t.return}return r}function ci(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=fa(n,i),u!=null&&o.unshift(xa(n,u,l))):s||(u=fa(n,i),u!=null&&o.push(xa(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var lN=/\r\n?/g,cN=/\u0000|\uFFFD/g;function Yy(t){return(typeof t=="string"?t:""+t).replace(lN,`
`).replace(cN,"")}function Dl(t,e,n){if(e=Yy(e),Yy(t)!==e&&n)throw Error(W(425))}function Ac(){}var Jh=null,Zh=null;function ef(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tf=typeof setTimeout=="function"?setTimeout:void 0,uN=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,dN=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(t){return Xy.resolve(null).then(t).catch(hN)}:tf;function hN(t){setTimeout(function(){throw t})}function Zd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ga(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ga(e)}function qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var eo=Math.random().toString(36).slice(2),Rn="__reactFiber$"+eo,_a="__reactProps$"+eo,ar="__reactContainer$"+eo,nf="__reactEvents$"+eo,fN="__reactListeners$"+eo,mN="__reactHandles$"+eo;function ks(t){var e=t[Rn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ar]||n[Rn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jy(t);t!==null;){if(n=t[Rn])return n;t=Jy(t)}return e}t=n,n=t.parentNode}return null}function Ka(t){return t=t[Rn]||t[ar],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Tu(t){return t[_a]||null}var rf=[],_i=-1;function us(t){return{current:t}}function Ne(t){0>_i||(t.current=rf[_i],rf[_i]=null,_i--)}function be(t,e){_i++,rf[_i]=t.current,t.current=e}var es={},yt=us(es),Dt=us(!1),Fs=es;function Ui(t,e){var n=t.type.contextTypes;if(!n)return es;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Lt(t){return t=t.childContextTypes,t!=null}function Pc(){Ne(Dt),Ne(yt)}function Zy(t,e,n){if(yt.current!==es)throw Error(W(168));be(yt,e),be(Dt,n)}function zx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,JT(t)||"Unknown",s));return Le({},n,r)}function Rc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||es,Fs=yt.current,be(yt,t),be(Dt,Dt.current),!0}function e0(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=zx(t,e,Fs),r.__reactInternalMemoizedMergedChildContext=t,Ne(Dt),Ne(yt),be(yt,t)):Ne(Dt),be(Dt,n)}var Gn=null,Iu=!1,eh=!1;function qx(t){Gn===null?Gn=[t]:Gn.push(t)}function pN(t){Iu=!0,qx(t)}function ds(){if(!eh&&Gn!==null){eh=!0;var t=0,e=ve;try{var n=Gn;for(ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gn=null,Iu=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(t+1)),px(ym,ds),s}finally{ve=e,eh=!1}}return null}var bi=[],Ei=0,jc=null,Dc=0,Zt=[],en=0,Us=null,Yn=1,Xn="";function Is(t,e){bi[Ei++]=Dc,bi[Ei++]=jc,jc=t,Dc=e}function Hx(t,e,n){Zt[en++]=Yn,Zt[en++]=Xn,Zt[en++]=Us,Us=t;var r=Yn;t=Xn;var s=32-gn(r)-1;r&=~(1<<s),n+=1;var i=32-gn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Yn=1<<32-gn(e)+s|n<<s|r,Xn=i+t}else Yn=1<<i|n<<s|r,Xn=t}function Nm(t){t.return!==null&&(Is(t,1),Hx(t,1,0))}function Sm(t){for(;t===jc;)jc=bi[--Ei],bi[Ei]=null,Dc=bi[--Ei],bi[Ei]=null;for(;t===Us;)Us=Zt[--en],Zt[en]=null,Xn=Zt[--en],Zt[en]=null,Yn=Zt[--en],Zt[en]=null}var Kt=null,qt=null,ke=!1,mn=null;function Wx(t,e){var n=nn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function t0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kt=t,qt=qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kt=t,qt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Us!==null?{id:Yn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Kt=t,qt=null,!0):!1;default:return!1}}function sf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function of(t){if(ke){var e=qt;if(e){var n=e;if(!t0(t,e)){if(sf(t))throw Error(W(418));e=qr(n.nextSibling);var r=Kt;e&&t0(t,e)?Wx(r,n):(t.flags=t.flags&-4097|2,ke=!1,Kt=t)}}else{if(sf(t))throw Error(W(418));t.flags=t.flags&-4097|2,ke=!1,Kt=t}}}function n0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kt=t}function Ll(t){if(t!==Kt)return!1;if(!ke)return n0(t),ke=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ef(t.type,t.memoizedProps)),e&&(e=qt)){if(sf(t))throw Gx(),Error(W(418));for(;e;)Wx(t,e),e=qr(e.nextSibling)}if(n0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){qt=qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}qt=null}}else qt=Kt?qr(t.stateNode.nextSibling):null;return!0}function Gx(){for(var t=qt;t;)t=qr(t.nextSibling)}function $i(){qt=Kt=null,ke=!1}function km(t){mn===null?mn=[t]:mn.push(t)}var gN=vr.ReactCurrentBatchConfig;function Ro(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Ml(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function r0(t){var e=t._init;return e(t._payload)}function Kx(t){function e(x,y){if(t){var E=x.deletions;E===null?(x.deletions=[y],x.flags|=16):E.push(y)}}function n(x,y){if(!t)return null;for(;y!==null;)e(x,y),y=y.sibling;return null}function r(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=Kr(x,y),x.index=0,x.sibling=null,x}function i(x,y,E){return x.index=E,t?(E=x.alternate,E!==null?(E=E.index,E<y?(x.flags|=2,y):E):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,y,E,R){return y===null||y.tag!==6?(y=ah(E,x.mode,R),y.return=x,y):(y=s(y,E),y.return=x,y)}function u(x,y,E,R){var P=E.type;return P===gi?h(x,y,E.props.children,R,E.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ar&&r0(P)===y.type)?(R=s(y,E.props),R.ref=Ro(x,y,E),R.return=x,R):(R=lc(E.type,E.key,E.props,null,x.mode,R),R.ref=Ro(x,y,E),R.return=x,R)}function d(x,y,E,R){return y===null||y.tag!==4||y.stateNode.containerInfo!==E.containerInfo||y.stateNode.implementation!==E.implementation?(y=lh(E,x.mode,R),y.return=x,y):(y=s(y,E.children||[]),y.return=x,y)}function h(x,y,E,R,P){return y===null||y.tag!==7?(y=Ls(E,x.mode,R,P),y.return=x,y):(y=s(y,E),y.return=x,y)}function m(x,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ah(""+y,x.mode,E),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Il:return E=lc(y.type,y.key,y.props,null,x.mode,E),E.ref=Ro(x,null,y),E.return=x,E;case pi:return y=lh(y,x.mode,E),y.return=x,y;case Ar:var R=y._init;return m(x,R(y._payload),E)}if(Vo(y)||So(y))return y=Ls(y,x.mode,E,null),y.return=x,y;Ml(x,y)}return null}function g(x,y,E,R){var P=y!==null?y.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return P!==null?null:l(x,y,""+E,R);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Il:return E.key===P?u(x,y,E,R):null;case pi:return E.key===P?d(x,y,E,R):null;case Ar:return P=E._init,g(x,y,P(E._payload),R)}if(Vo(E)||So(E))return P!==null?null:h(x,y,E,R,null);Ml(x,E)}return null}function v(x,y,E,R,P){if(typeof R=="string"&&R!==""||typeof R=="number")return x=x.get(E)||null,l(y,x,""+R,P);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Il:return x=x.get(R.key===null?E:R.key)||null,u(y,x,R,P);case pi:return x=x.get(R.key===null?E:R.key)||null,d(y,x,R,P);case Ar:var O=R._init;return v(x,y,E,O(R._payload),P)}if(Vo(R)||So(R))return x=x.get(E)||null,h(y,x,R,P,null);Ml(y,R)}return null}function S(x,y,E,R){for(var P=null,O=null,T=y,w=y=0,I=null;T!==null&&w<E.length;w++){T.index>w?(I=T,T=null):I=T.sibling;var C=g(x,T,E[w],R);if(C===null){T===null&&(T=I);break}t&&T&&C.alternate===null&&e(x,T),y=i(C,y,w),O===null?P=C:O.sibling=C,O=C,T=I}if(w===E.length)return n(x,T),ke&&Is(x,w),P;if(T===null){for(;w<E.length;w++)T=m(x,E[w],R),T!==null&&(y=i(T,y,w),O===null?P=T:O.sibling=T,O=T);return ke&&Is(x,w),P}for(T=r(x,T);w<E.length;w++)I=v(T,x,w,E[w],R),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?w:I.key),y=i(I,y,w),O===null?P=I:O.sibling=I,O=I);return t&&T.forEach(function(j){return e(x,j)}),ke&&Is(x,w),P}function N(x,y,E,R){var P=So(E);if(typeof P!="function")throw Error(W(150));if(E=P.call(E),E==null)throw Error(W(151));for(var O=P=null,T=y,w=y=0,I=null,C=E.next();T!==null&&!C.done;w++,C=E.next()){T.index>w?(I=T,T=null):I=T.sibling;var j=g(x,T,C.value,R);if(j===null){T===null&&(T=I);break}t&&T&&j.alternate===null&&e(x,T),y=i(j,y,w),O===null?P=j:O.sibling=j,O=j,T=I}if(C.done)return n(x,T),ke&&Is(x,w),P;if(T===null){for(;!C.done;w++,C=E.next())C=m(x,C.value,R),C!==null&&(y=i(C,y,w),O===null?P=C:O.sibling=C,O=C);return ke&&Is(x,w),P}for(T=r(x,T);!C.done;w++,C=E.next())C=v(T,x,w,C.value,R),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?w:C.key),y=i(C,y,w),O===null?P=C:O.sibling=C,O=C);return t&&T.forEach(function(D){return e(x,D)}),ke&&Is(x,w),P}function b(x,y,E,R){if(typeof E=="object"&&E!==null&&E.type===gi&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Il:e:{for(var P=E.key,O=y;O!==null;){if(O.key===P){if(P=E.type,P===gi){if(O.tag===7){n(x,O.sibling),y=s(O,E.props.children),y.return=x,x=y;break e}}else if(O.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ar&&r0(P)===O.type){n(x,O.sibling),y=s(O,E.props),y.ref=Ro(x,O,E),y.return=x,x=y;break e}n(x,O);break}else e(x,O);O=O.sibling}E.type===gi?(y=Ls(E.props.children,x.mode,R,E.key),y.return=x,x=y):(R=lc(E.type,E.key,E.props,null,x.mode,R),R.ref=Ro(x,y,E),R.return=x,x=R)}return o(x);case pi:e:{for(O=E.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===E.containerInfo&&y.stateNode.implementation===E.implementation){n(x,y.sibling),y=s(y,E.children||[]),y.return=x,x=y;break e}else{n(x,y);break}else e(x,y);y=y.sibling}y=lh(E,x.mode,R),y.return=x,x=y}return o(x);case Ar:return O=E._init,b(x,y,O(E._payload),R)}if(Vo(E))return S(x,y,E,R);if(So(E))return N(x,y,E,R);Ml(x,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,y!==null&&y.tag===6?(n(x,y.sibling),y=s(y,E),y.return=x,x=y):(n(x,y),y=ah(E,x.mode,R),y.return=x,x=y),o(x)):n(x,y)}return b}var Bi=Kx(!0),Qx=Kx(!1),Lc=us(null),Mc=null,Ti=null,Cm=null;function Am(){Cm=Ti=Mc=null}function Pm(t){var e=Lc.current;Ne(Lc),t._currentValue=e}function af(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Pi(t,e){Mc=t,Cm=Ti=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jt=!0),t.firstContext=null)}function on(t){var e=t._currentValue;if(Cm!==t)if(t={context:t,memoizedValue:e,next:null},Ti===null){if(Mc===null)throw Error(W(308));Ti=t,Mc.dependencies={lanes:0,firstContext:t}}else Ti=Ti.next=t;return e}var Cs=null;function Rm(t){Cs===null?Cs=[t]:Cs.push(t)}function Yx(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Rm(e)):(n.next=s.next,s.next=n),e.interleaved=n,lr(t,r)}function lr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pr=!1;function jm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function er(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,lr(t,n)}return s=r.interleaved,s===null?(e.next=e,Rm(r)):(e.next=s.next,s.next=e),r.interleaved=e,lr(t,n)}function nc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vm(t,n)}}function s0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Oc(t,e,n,r){var s=t.updateQueue;Pr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,h=d=u=null,l=i;do{var g=l.lane,v=l.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=t,N=l;switch(g=e,v=n,N.tag){case 1:if(S=N.payload,typeof S=="function"){m=S.call(v,m,g);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=N.payload,g=typeof S=="function"?S.call(v,m,g):S,g==null)break e;m=Le({},m,g);break e;case 2:Pr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else v={eventTime:v,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=v,u=m):h=h.next=v,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Bs|=o,t.lanes=o,t.memoizedState=m}}function i0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var Qa={},Mn=us(Qa),ba=us(Qa),Ea=us(Qa);function As(t){if(t===Qa)throw Error(W(174));return t}function Dm(t,e){switch(be(Ea,e),be(ba,t),be(Mn,Qa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Uh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Uh(e,t)}Ne(Mn),be(Mn,e)}function zi(){Ne(Mn),Ne(ba),Ne(Ea)}function Jx(t){As(Ea.current);var e=As(Mn.current),n=Uh(e,t.type);e!==n&&(be(ba,t),be(Mn,n))}function Lm(t){ba.current===t&&(Ne(Mn),Ne(ba))}var Re=us(0);function Vc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var th=[];function Mm(){for(var t=0;t<th.length;t++)th[t]._workInProgressVersionPrimary=null;th.length=0}var rc=vr.ReactCurrentDispatcher,nh=vr.ReactCurrentBatchConfig,$s=0,De=null,Ke=null,Ze=null,Fc=!1,Zo=!1,Ta=0,yN=0;function dt(){throw Error(W(321))}function Om(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wn(t[n],e[n]))return!1;return!0}function Vm(t,e,n,r,s,i){if($s=i,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rc.current=t===null||t.memoizedState===null?_N:bN,t=n(r,s),Zo){i=0;do{if(Zo=!1,Ta=0,25<=i)throw Error(W(301));i+=1,Ze=Ke=null,e.updateQueue=null,rc.current=EN,t=n(r,s)}while(Zo)}if(rc.current=Uc,e=Ke!==null&&Ke.next!==null,$s=0,Ze=Ke=De=null,Fc=!1,e)throw Error(W(300));return t}function Fm(){var t=Ta!==0;return Ta=0,t}function An(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?De.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function an(){if(Ke===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=Ke.next;var e=Ze===null?De.memoizedState:Ze.next;if(e!==null)Ze=e,Ke=t;else{if(t===null)throw Error(W(310));Ke=t,t={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},Ze===null?De.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function Ia(t,e){return typeof e=="function"?e(t):e}function rh(t){var e=an(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=Ke,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if(($s&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=m,o=r):u=u.next=m,De.lanes|=h,Bs|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,wn(r,e.memoizedState)||(jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,De.lanes|=i,Bs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function sh(t){var e=an(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);wn(i,e.memoizedState)||(jt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Zx(){}function e_(t,e){var n=De,r=an(),s=e(),i=!wn(r.memoizedState,s);if(i&&(r.memoizedState=s,jt=!0),r=r.queue,Um(r_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,Na(9,n_.bind(null,n,r,s,e),void 0,null),et===null)throw Error(W(349));$s&30||t_(n,e,s)}return s}function t_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function n_(t,e,n,r){e.value=n,e.getSnapshot=r,s_(e)&&i_(t)}function r_(t,e,n){return n(function(){s_(e)&&i_(t)})}function s_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wn(t,n)}catch{return!0}}function i_(t){var e=lr(t,1);e!==null&&yn(e,t,1,-1)}function o0(t){var e=An();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:t},e.queue=t,t=t.dispatch=xN.bind(null,De,t),[e.memoizedState,t]}function Na(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function o_(){return an().memoizedState}function sc(t,e,n,r){var s=An();De.flags|=t,s.memoizedState=Na(1|e,n,void 0,r===void 0?null:r)}function Nu(t,e,n,r){var s=an();r=r===void 0?null:r;var i=void 0;if(Ke!==null){var o=Ke.memoizedState;if(i=o.destroy,r!==null&&Om(r,o.deps)){s.memoizedState=Na(e,n,i,r);return}}De.flags|=t,s.memoizedState=Na(1|e,n,i,r)}function a0(t,e){return sc(8390656,8,t,e)}function Um(t,e){return Nu(2048,8,t,e)}function a_(t,e){return Nu(4,2,t,e)}function l_(t,e){return Nu(4,4,t,e)}function c_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function u_(t,e,n){return n=n!=null?n.concat([t]):null,Nu(4,4,c_.bind(null,e,t),n)}function $m(){}function d_(t,e){var n=an();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Om(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function h_(t,e){var n=an();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Om(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function f_(t,e,n){return $s&21?(wn(n,e)||(n=vx(),De.lanes|=n,Bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jt=!0),t.memoizedState=n)}function vN(t,e){var n=ve;ve=n!==0&&4>n?n:4,t(!0);var r=nh.transition;nh.transition={};try{t(!1),e()}finally{ve=n,nh.transition=r}}function m_(){return an().memoizedState}function wN(t,e,n){var r=Gr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},p_(t))g_(e,n);else if(n=Yx(t,e,n,r),n!==null){var s=Et();yn(n,t,r,s),y_(n,e,r)}}function xN(t,e,n){var r=Gr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(p_(t))g_(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,wn(l,o)){var u=e.interleaved;u===null?(s.next=s,Rm(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Yx(t,e,s,r),n!==null&&(s=Et(),yn(n,t,r,s),y_(n,e,r))}}function p_(t){var e=t.alternate;return t===De||e!==null&&e===De}function g_(t,e){Zo=Fc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function y_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vm(t,n)}}var Uc={readContext:on,useCallback:dt,useContext:dt,useEffect:dt,useImperativeHandle:dt,useInsertionEffect:dt,useLayoutEffect:dt,useMemo:dt,useReducer:dt,useRef:dt,useState:dt,useDebugValue:dt,useDeferredValue:dt,useTransition:dt,useMutableSource:dt,useSyncExternalStore:dt,useId:dt,unstable_isNewReconciler:!1},_N={readContext:on,useCallback:function(t,e){return An().memoizedState=[t,e===void 0?null:e],t},useContext:on,useEffect:a0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sc(4194308,4,c_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sc(4194308,4,t,e)},useInsertionEffect:function(t,e){return sc(4,2,t,e)},useMemo:function(t,e){var n=An();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=An();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=wN.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=An();return t={current:t},e.memoizedState=t},useState:o0,useDebugValue:$m,useDeferredValue:function(t){return An().memoizedState=t},useTransition:function(){var t=o0(!1),e=t[0];return t=vN.bind(null,t[1]),An().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,s=An();if(ke){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),et===null)throw Error(W(349));$s&30||t_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,a0(r_.bind(null,r,i,t),[t]),r.flags|=2048,Na(9,n_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=An(),e=et.identifierPrefix;if(ke){var n=Xn,r=Yn;n=(r&~(1<<32-gn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ta++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bN={readContext:on,useCallback:d_,useContext:on,useEffect:Um,useImperativeHandle:u_,useInsertionEffect:a_,useLayoutEffect:l_,useMemo:h_,useReducer:rh,useRef:o_,useState:function(){return rh(Ia)},useDebugValue:$m,useDeferredValue:function(t){var e=an();return f_(e,Ke.memoizedState,t)},useTransition:function(){var t=rh(Ia)[0],e=an().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:e_,useId:m_,unstable_isNewReconciler:!1},EN={readContext:on,useCallback:d_,useContext:on,useEffect:Um,useImperativeHandle:u_,useInsertionEffect:a_,useLayoutEffect:l_,useMemo:h_,useReducer:sh,useRef:o_,useState:function(){return sh(Ia)},useDebugValue:$m,useDeferredValue:function(t){var e=an();return Ke===null?e.memoizedState=t:f_(e,Ke.memoizedState,t)},useTransition:function(){var t=sh(Ia)[0],e=an().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:e_,useId:m_,unstable_isNewReconciler:!1};function hn(t,e){if(t&&t.defaultProps){e=Le({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function lf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Le({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Su={isMounted:function(t){return(t=t._reactInternals)?Zs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Et(),s=Gr(t),i=er(r,s);i.payload=e,n!=null&&(i.callback=n),e=Hr(t,i,s),e!==null&&(yn(e,t,s,r),nc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Et(),s=Gr(t),i=er(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Hr(t,i,s),e!==null&&(yn(e,t,s,r),nc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Et(),r=Gr(t),s=er(n,r);s.tag=2,e!=null&&(s.callback=e),e=Hr(t,s,r),e!==null&&(yn(e,t,r,n),nc(e,t,r))}};function l0(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!va(n,r)||!va(s,i):!0}function v_(t,e,n){var r=!1,s=es,i=e.contextType;return typeof i=="object"&&i!==null?i=on(i):(s=Lt(e)?Fs:yt.current,r=e.contextTypes,i=(r=r!=null)?Ui(t,s):es),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Su,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function c0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Su.enqueueReplaceState(e,e.state,null)}function cf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},jm(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=on(i):(i=Lt(e)?Fs:yt.current,s.context=Ui(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(lf(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Su.enqueueReplaceState(s,s.state,null),Oc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function qi(t,e){try{var n="",r=e;do n+=XT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ih(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function uf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var TN=typeof WeakMap=="function"?WeakMap:Map;function w_(t,e,n){n=er(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Bc||(Bc=!0,xf=r),uf(t,e)},n}function x_(t,e,n){n=er(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){uf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){uf(t,e),typeof r!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function u0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new TN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=VN.bind(null,t,e,n),e.then(t,t))}function d0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function h0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=er(-1,1),e.tag=2,Hr(n,e,1))),n.lanes|=1),t)}var IN=vr.ReactCurrentOwner,jt=!1;function bt(t,e,n,r){e.child=t===null?Qx(e,null,n,r):Bi(e,t.child,n,r)}function f0(t,e,n,r,s){n=n.render;var i=e.ref;return Pi(e,s),r=Vm(t,e,n,r,i,s),n=Fm(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,cr(t,e,s)):(ke&&n&&Nm(e),e.flags|=1,bt(t,e,r,s),e.child)}function m0(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Qm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,__(t,e,i,r,s)):(t=lc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:va,n(o,r)&&t.ref===e.ref)return cr(t,e,s)}return e.flags|=1,t=Kr(i,r),t.ref=e.ref,t.return=e,e.child=t}function __(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(va(i,r)&&t.ref===e.ref)if(jt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jt=!0);else return e.lanes=t.lanes,cr(t,e,s)}return df(t,e,n,r,s)}function b_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Ni,Bt),Bt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Ni,Bt),Bt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,be(Ni,Bt),Bt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,be(Ni,Bt),Bt|=r;return bt(t,e,s,n),e.child}function E_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function df(t,e,n,r,s){var i=Lt(n)?Fs:yt.current;return i=Ui(e,i),Pi(e,s),n=Vm(t,e,n,r,i,s),r=Fm(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,cr(t,e,s)):(ke&&r&&Nm(e),e.flags|=1,bt(t,e,n,s),e.child)}function p0(t,e,n,r,s){if(Lt(n)){var i=!0;Rc(e)}else i=!1;if(Pi(e,s),e.stateNode===null)ic(t,e),v_(e,n,r),cf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=on(d):(d=Lt(n)?Fs:yt.current,d=Ui(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&c0(e,o,r,d),Pr=!1;var g=e.memoizedState;o.state=g,Oc(e,r,o,s),u=e.memoizedState,l!==r||g!==u||Dt.current||Pr?(typeof h=="function"&&(lf(e,n,h,r),u=e.memoizedState),(l=Pr||l0(e,n,l,r,g,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Xx(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:hn(e.type,l),o.props=d,m=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=on(u):(u=Lt(n)?Fs:yt.current,u=Ui(e,u));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&c0(e,o,r,u),Pr=!1,g=e.memoizedState,o.state=g,Oc(e,r,o,s);var S=e.memoizedState;l!==m||g!==S||Dt.current||Pr?(typeof v=="function"&&(lf(e,n,v,r),S=e.memoizedState),(d=Pr||l0(e,n,d,r,g,S,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return hf(t,e,n,r,i,s)}function hf(t,e,n,r,s,i){E_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&e0(e,n,!1),cr(t,e,i);r=e.stateNode,IN.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Bi(e,t.child,null,i),e.child=Bi(e,null,l,i)):bt(t,e,l,i),e.memoizedState=r.state,s&&e0(e,n,!0),e.child}function T_(t){var e=t.stateNode;e.pendingContext?Zy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zy(t,e.context,!1),Dm(t,e.containerInfo)}function g0(t,e,n,r,s){return $i(),km(s),e.flags|=256,bt(t,e,n,r),e.child}var ff={dehydrated:null,treeContext:null,retryLane:0};function mf(t){return{baseLanes:t,cachePool:null,transitions:null}}function I_(t,e,n){var r=e.pendingProps,s=Re.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Re,s&1),t===null)return of(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Au(o,r,0,null),t=Ls(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=mf(n),e.memoizedState=ff,t):Bm(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return NN(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Kr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Kr(l,i):(i=Ls(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?mf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=ff,r}return i=t.child,t=i.sibling,r=Kr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bm(t,e){return e=Au({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ol(t,e,n,r){return r!==null&&km(r),Bi(e,t.child,null,n),t=Bm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function NN(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ih(Error(W(422))),Ol(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Au({mode:"visible",children:r.children},s,0,null),i=Ls(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Bi(e,t.child,null,o),e.child.memoizedState=mf(o),e.memoizedState=ff,i);if(!(e.mode&1))return Ol(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=ih(i,r,void 0),Ol(t,e,o,r)}if(l=(o&t.childLanes)!==0,jt||l){if(r=et,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,lr(t,s),yn(r,t,s,-1))}return Km(),r=ih(Error(W(421))),Ol(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=FN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,qt=qr(s.nextSibling),Kt=e,ke=!0,mn=null,t!==null&&(Zt[en++]=Yn,Zt[en++]=Xn,Zt[en++]=Us,Yn=t.id,Xn=t.overflow,Us=e),e=Bm(e,r.children),e.flags|=4096,e)}function y0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),af(t.return,e,n)}function oh(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function N_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(bt(t,e,r.children,n),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y0(t,n,e);else if(t.tag===19)y0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Re,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Vc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),oh(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Vc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}oh(e,!0,n,null,i);break;case"together":oh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ic(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function cr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SN(t,e,n){switch(e.tag){case 3:T_(e),$i();break;case 5:Jx(e);break;case 1:Lt(e.type)&&Rc(e);break;case 4:Dm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(Lc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Re,Re.current&1),e.flags|=128,null):n&e.child.childLanes?I_(t,e,n):(be(Re,Re.current&1),t=cr(t,e,n),t!==null?t.sibling:null);be(Re,Re.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return N_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,b_(t,e,n)}return cr(t,e,n)}var S_,pf,k_,C_;S_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pf=function(){};k_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,As(Mn.current);var i=null;switch(n){case"input":s=Mh(t,s),r=Mh(t,r),i=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),i=[];break;case"textarea":s=Fh(t,s),r=Fh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ac)}$h(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(da.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(da.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Te("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};C_=function(t,e,n,r){n!==r&&(e.flags|=4)};function jo(t,e){if(!ke)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ht(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function kN(t,e,n){var r=e.pendingProps;switch(Sm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(e),null;case 1:return Lt(e.type)&&Pc(),ht(e),null;case 3:return r=e.stateNode,zi(),Ne(Dt),Ne(yt),Mm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ll(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,mn!==null&&(Ef(mn),mn=null))),pf(t,e),ht(e),null;case 5:Lm(e);var s=As(Ea.current);if(n=e.type,t!==null&&e.stateNode!=null)k_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return ht(e),null}if(t=As(Mn.current),Ll(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Rn]=e,r[_a]=i,t=(e.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(s=0;s<Uo.length;s++)Te(Uo[s],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":Ny(r,i),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Te("invalid",r);break;case"textarea":ky(r,i),Te("invalid",r)}$h(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Dl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Dl(r.textContent,l,t),s=["children",""+l]):da.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Te("scroll",r)}switch(n){case"input":Nl(r),Sy(r,i,!0);break;case"textarea":Nl(r),Cy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ac)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Rn]=e,t[_a]=r,S_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Bh(n,r),n){case"dialog":Te("cancel",t),Te("close",t),s=r;break;case"iframe":case"object":case"embed":Te("load",t),s=r;break;case"video":case"audio":for(s=0;s<Uo.length;s++)Te(Uo[s],t);s=r;break;case"source":Te("error",t),s=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),s=r;break;case"details":Te("toggle",t),s=r;break;case"input":Ny(t,r),s=Mh(t,r),Te("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),Te("invalid",t);break;case"textarea":ky(t,r),s=Fh(t,r),Te("invalid",t);break;default:s=r}$h(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?ox(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&sx(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ha(t,u):typeof u=="number"&&ha(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(da.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Te("scroll",t):u!=null&&hm(t,i,u,o))}switch(n){case"input":Nl(t),Sy(t,r,!1);break;case"textarea":Nl(t),Cy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Si(t,!!r.multiple,i,!1):r.defaultValue!=null&&Si(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ac)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ht(e),null;case 6:if(t&&e.stateNode!=null)C_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=As(Ea.current),As(Mn.current),Ll(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rn]=e,(i=r.nodeValue!==n)&&(t=Kt,t!==null))switch(t.tag){case 3:Dl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Dl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rn]=e,e.stateNode=r}return ht(e),null;case 13:if(Ne(Re),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ke&&qt!==null&&e.mode&1&&!(e.flags&128))Gx(),$i(),e.flags|=98560,i=!1;else if(i=Ll(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Rn]=e}else $i(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ht(e),i=!1}else mn!==null&&(Ef(mn),mn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?Qe===0&&(Qe=3):Km())),e.updateQueue!==null&&(e.flags|=4),ht(e),null);case 4:return zi(),pf(t,e),t===null&&wa(e.stateNode.containerInfo),ht(e),null;case 10:return Pm(e.type._context),ht(e),null;case 17:return Lt(e.type)&&Pc(),ht(e),null;case 19:if(Ne(Re),i=e.memoizedState,i===null)return ht(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)jo(i,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Vc(t),o!==null){for(e.flags|=128,jo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Re,Re.current&1|2),e.child}t=t.sibling}i.tail!==null&&Be()>Hi&&(e.flags|=128,r=!0,jo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),jo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ke)return ht(e),null}else 2*Be()-i.renderingStartTime>Hi&&n!==1073741824&&(e.flags|=128,r=!0,jo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Be(),e.sibling=null,n=Re.current,be(Re,r?n&1|2:n&1),e):(ht(e),null);case 22:case 23:return Gm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Bt&1073741824&&(ht(e),e.subtreeFlags&6&&(e.flags|=8192)):ht(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function CN(t,e){switch(Sm(e),e.tag){case 1:return Lt(e.type)&&Pc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zi(),Ne(Dt),Ne(yt),Mm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lm(e),null;case 13:if(Ne(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));$i()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ne(Re),null;case 4:return zi(),null;case 10:return Pm(e.type._context),null;case 22:case 23:return Gm(),null;case 24:return null;default:return null}}var Vl=!1,pt=!1,AN=typeof WeakSet=="function"?WeakSet:Set,X=null;function Ii(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Fe(t,e,r)}else n.current=null}function gf(t,e,n){try{n()}catch(r){Fe(t,e,r)}}var v0=!1;function PN(t,e){if(Jh=Sc,t=Dx(),Im(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,m=t,g=null;t:for(;;){for(var v;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===t)break t;if(g===n&&++d===s&&(l=o),g===i&&++h===r&&(u=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zh={focusedElem:t,selectionRange:n},Sc=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var N=S.memoizedProps,b=S.memoizedState,x=e.stateNode,y=x.getSnapshotBeforeUpdate(e.elementType===e.type?N:hn(e.type,N),b);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(R){Fe(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return S=v0,v0=!1,S}function ea(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&gf(e,n,i)}s=s.next}while(s!==r)}}function ku(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function yf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function A_(t){var e=t.alternate;e!==null&&(t.alternate=null,A_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rn],delete e[_a],delete e[nf],delete e[fN],delete e[mN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function P_(t){return t.tag===5||t.tag===3||t.tag===4}function w0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||P_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ac));else if(r!==4&&(t=t.child,t!==null))for(vf(t,e,n),t=t.sibling;t!==null;)vf(t,e,n),t=t.sibling}function wf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(wf(t,e,n),t=t.sibling;t!==null;)wf(t,e,n),t=t.sibling}var nt=null,fn=!1;function kr(t,e,n){for(n=n.child;n!==null;)R_(t,e,n),n=n.sibling}function R_(t,e,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(xu,n)}catch{}switch(n.tag){case 5:pt||Ii(n,e);case 6:var r=nt,s=fn;nt=null,kr(t,e,n),nt=r,fn=s,nt!==null&&(fn?(t=nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(fn?(t=nt,n=n.stateNode,t.nodeType===8?Zd(t.parentNode,n):t.nodeType===1&&Zd(t,n),ga(t)):Zd(nt,n.stateNode));break;case 4:r=nt,s=fn,nt=n.stateNode.containerInfo,fn=!0,kr(t,e,n),nt=r,fn=s;break;case 0:case 11:case 14:case 15:if(!pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&gf(n,e,o),s=s.next}while(s!==r)}kr(t,e,n);break;case 1:if(!pt&&(Ii(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Fe(n,e,l)}kr(t,e,n);break;case 21:kr(t,e,n);break;case 22:n.mode&1?(pt=(r=pt)||n.memoizedState!==null,kr(t,e,n),pt=r):kr(t,e,n);break;default:kr(t,e,n)}}function x0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new AN),e.forEach(function(r){var s=UN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function dn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:nt=l.stateNode,fn=!1;break e;case 3:nt=l.stateNode.containerInfo,fn=!0;break e;case 4:nt=l.stateNode.containerInfo,fn=!0;break e}l=l.return}if(nt===null)throw Error(W(160));R_(i,o,s),nt=null,fn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Fe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)j_(e,t),e=e.sibling}function j_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dn(e,t),Cn(t),r&4){try{ea(3,t,t.return),ku(3,t)}catch(N){Fe(t,t.return,N)}try{ea(5,t,t.return)}catch(N){Fe(t,t.return,N)}}break;case 1:dn(e,t),Cn(t),r&512&&n!==null&&Ii(n,n.return);break;case 5:if(dn(e,t),Cn(t),r&512&&n!==null&&Ii(n,n.return),t.flags&32){var s=t.stateNode;try{ha(s,"")}catch(N){Fe(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&tx(s,i),Bh(l,o);var d=Bh(l,i);for(o=0;o<u.length;o+=2){var h=u[o],m=u[o+1];h==="style"?ox(s,m):h==="dangerouslySetInnerHTML"?sx(s,m):h==="children"?ha(s,m):hm(s,h,m,d)}switch(l){case"input":Oh(s,i);break;case"textarea":nx(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Si(s,!!i.multiple,v,!1):g!==!!i.multiple&&(i.defaultValue!=null?Si(s,!!i.multiple,i.defaultValue,!0):Si(s,!!i.multiple,i.multiple?[]:"",!1))}s[_a]=i}catch(N){Fe(t,t.return,N)}}break;case 6:if(dn(e,t),Cn(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){Fe(t,t.return,N)}}break;case 3:if(dn(e,t),Cn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ga(e.containerInfo)}catch(N){Fe(t,t.return,N)}break;case 4:dn(e,t),Cn(t);break;case 13:dn(e,t),Cn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Hm=Be())),r&4&&x0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(pt=(d=pt)||h,dn(e,t),pt=d):dn(e,t),Cn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(X=t,h=t.child;h!==null;){for(m=X=h;X!==null;){switch(g=X,v=g.child,g.tag){case 0:case 11:case 14:case 15:ea(4,g,g.return);break;case 1:Ii(g,g.return);var S=g.stateNode;if(typeof S.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(N){Fe(r,n,N)}}break;case 5:Ii(g,g.return);break;case 22:if(g.memoizedState!==null){b0(m);continue}}v!==null?(v.return=g,X=v):b0(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=ix("display",o))}catch(N){Fe(t,t.return,N)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(N){Fe(t,t.return,N)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:dn(e,t),Cn(t),r&4&&x0(t);break;case 21:break;default:dn(e,t),Cn(t)}}function Cn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(P_(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ha(s,""),r.flags&=-33);var i=w0(t);wf(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=w0(t);vf(t,l,o);break;default:throw Error(W(161))}}catch(u){Fe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function RN(t,e,n){X=t,D_(t)}function D_(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Vl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||pt;l=Vl;var d=pt;if(Vl=o,(pt=u)&&!d)for(X=s;X!==null;)o=X,u=o.child,o.tag===22&&o.memoizedState!==null?E0(s):u!==null?(u.return=o,X=u):E0(s);for(;i!==null;)X=i,D_(i),i=i.sibling;X=s,Vl=l,pt=d}_0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):_0(t)}}function _0(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:pt||ku(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!pt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:hn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&i0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}i0(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&ga(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}pt||e.flags&512&&yf(e)}catch(g){Fe(e,e.return,g)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function b0(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function E0(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ku(4,e)}catch(u){Fe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Fe(e,s,u)}}var i=e.return;try{yf(e)}catch(u){Fe(e,i,u)}break;case 5:var o=e.return;try{yf(e)}catch(u){Fe(e,o,u)}}}catch(u){Fe(e,e.return,u)}if(e===t){X=null;break}var l=e.sibling;if(l!==null){l.return=e.return,X=l;break}X=e.return}}var jN=Math.ceil,$c=vr.ReactCurrentDispatcher,zm=vr.ReactCurrentOwner,rn=vr.ReactCurrentBatchConfig,he=0,et=null,qe=null,it=0,Bt=0,Ni=us(0),Qe=0,Sa=null,Bs=0,Cu=0,qm=0,ta=null,At=null,Hm=0,Hi=1/0,Wn=null,Bc=!1,xf=null,Wr=null,Fl=!1,Fr=null,zc=0,na=0,_f=null,oc=-1,ac=0;function Et(){return he&6?Be():oc!==-1?oc:oc=Be()}function Gr(t){return t.mode&1?he&2&&it!==0?it&-it:gN.transition!==null?(ac===0&&(ac=vx()),ac):(t=ve,t!==0||(t=window.event,t=t===void 0?16:Ix(t.type)),t):1}function yn(t,e,n,r){if(50<na)throw na=0,_f=null,Error(W(185));Wa(t,n,r),(!(he&2)||t!==et)&&(t===et&&(!(he&2)&&(Cu|=n),Qe===4&&jr(t,it)),Mt(t,r),n===1&&he===0&&!(e.mode&1)&&(Hi=Be()+500,Iu&&ds()))}function Mt(t,e){var n=t.callbackNode;gI(t,e);var r=Nc(t,t===et?it:0);if(r===0)n!==null&&Ry(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ry(n),e===1)t.tag===0?pN(T0.bind(null,t)):qx(T0.bind(null,t)),dN(function(){!(he&6)&&ds()}),n=null;else{switch(wx(r)){case 1:n=ym;break;case 4:n=gx;break;case 16:n=Ic;break;case 536870912:n=yx;break;default:n=Ic}n=B_(n,L_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function L_(t,e){if(oc=-1,ac=0,he&6)throw Error(W(327));var n=t.callbackNode;if(Ri()&&t.callbackNode!==n)return null;var r=Nc(t,t===et?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=qc(t,r);else{e=r;var s=he;he|=2;var i=O_();(et!==t||it!==e)&&(Wn=null,Hi=Be()+500,Ds(t,e));do try{MN();break}catch(l){M_(t,l)}while(!0);Am(),$c.current=i,he=s,qe!==null?e=0:(et=null,it=0,e=Qe)}if(e!==0){if(e===2&&(s=Gh(t),s!==0&&(r=s,e=bf(t,s))),e===1)throw n=Sa,Ds(t,0),jr(t,r),Mt(t,Be()),n;if(e===6)jr(t,r);else{if(s=t.current.alternate,!(r&30)&&!DN(s)&&(e=qc(t,r),e===2&&(i=Gh(t),i!==0&&(r=i,e=bf(t,i))),e===1))throw n=Sa,Ds(t,0),jr(t,r),Mt(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:Ns(t,At,Wn);break;case 3:if(jr(t,r),(r&130023424)===r&&(e=Hm+500-Be(),10<e)){if(Nc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Et(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=tf(Ns.bind(null,t,At,Wn),e);break}Ns(t,At,Wn);break;case 4:if(jr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-gn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jN(r/1960))-r,10<r){t.timeoutHandle=tf(Ns.bind(null,t,At,Wn),r);break}Ns(t,At,Wn);break;case 5:Ns(t,At,Wn);break;default:throw Error(W(329))}}}return Mt(t,Be()),t.callbackNode===n?L_.bind(null,t):null}function bf(t,e){var n=ta;return t.current.memoizedState.isDehydrated&&(Ds(t,e).flags|=256),t=qc(t,e),t!==2&&(e=At,At=n,e!==null&&Ef(e)),t}function Ef(t){At===null?At=t:At.push.apply(At,t)}function DN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!wn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jr(t,e){for(e&=~qm,e&=~Cu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-gn(e),r=1<<n;t[n]=-1,e&=~r}}function T0(t){if(he&6)throw Error(W(327));Ri();var e=Nc(t,0);if(!(e&1))return Mt(t,Be()),null;var n=qc(t,e);if(t.tag!==0&&n===2){var r=Gh(t);r!==0&&(e=r,n=bf(t,r))}if(n===1)throw n=Sa,Ds(t,0),jr(t,e),Mt(t,Be()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ns(t,At,Wn),Mt(t,Be()),null}function Wm(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(Hi=Be()+500,Iu&&ds())}}function zs(t){Fr!==null&&Fr.tag===0&&!(he&6)&&Ri();var e=he;he|=1;var n=rn.transition,r=ve;try{if(rn.transition=null,ve=1,t)return t()}finally{ve=r,rn.transition=n,he=e,!(he&6)&&ds()}}function Gm(){Bt=Ni.current,Ne(Ni)}function Ds(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uN(n)),qe!==null)for(n=qe.return;n!==null;){var r=n;switch(Sm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pc();break;case 3:zi(),Ne(Dt),Ne(yt),Mm();break;case 5:Lm(r);break;case 4:zi();break;case 13:Ne(Re);break;case 19:Ne(Re);break;case 10:Pm(r.type._context);break;case 22:case 23:Gm()}n=n.return}if(et=t,qe=t=Kr(t.current,null),it=Bt=e,Qe=0,Sa=null,qm=Cu=Bs=0,At=ta=null,Cs!==null){for(e=0;e<Cs.length;e++)if(n=Cs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Cs=null}return t}function M_(t,e){do{var n=qe;try{if(Am(),rc.current=Uc,Fc){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Fc=!1}if($s=0,Ze=Ke=De=null,Zo=!1,Ta=0,zm.current=null,n===null||n.return===null){Qe=1,Sa=e,qe=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=it,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=d0(o);if(v!==null){v.flags&=-257,h0(v,o,l,i,e),v.mode&1&&u0(i,d,e),e=v,u=d;var S=e.updateQueue;if(S===null){var N=new Set;N.add(u),e.updateQueue=N}else S.add(u);break e}else{if(!(e&1)){u0(i,d,e),Km();break e}u=Error(W(426))}}else if(ke&&l.mode&1){var b=d0(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),h0(b,o,l,i,e),km(qi(u,l));break e}}i=u=qi(u,l),Qe!==4&&(Qe=2),ta===null?ta=[i]:ta.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=w_(i,u,e);s0(i,x);break e;case 1:l=u;var y=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Wr===null||!Wr.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=x_(i,l,e);s0(i,R);break e}}i=i.return}while(i!==null)}F_(n)}catch(P){e=P,qe===n&&n!==null&&(qe=n=n.return);continue}break}while(!0)}function O_(){var t=$c.current;return $c.current=Uc,t===null?Uc:t}function Km(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),et===null||!(Bs&268435455)&&!(Cu&268435455)||jr(et,it)}function qc(t,e){var n=he;he|=2;var r=O_();(et!==t||it!==e)&&(Wn=null,Ds(t,e));do try{LN();break}catch(s){M_(t,s)}while(!0);if(Am(),he=n,$c.current=r,qe!==null)throw Error(W(261));return et=null,it=0,Qe}function LN(){for(;qe!==null;)V_(qe)}function MN(){for(;qe!==null&&!aI();)V_(qe)}function V_(t){var e=$_(t.alternate,t,Bt);t.memoizedProps=t.pendingProps,e===null?F_(t):qe=e,zm.current=null}function F_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=CN(n,e),n!==null){n.flags&=32767,qe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,qe=null;return}}else if(n=kN(n,e,Bt),n!==null){qe=n;return}if(e=e.sibling,e!==null){qe=e;return}qe=e=t}while(e!==null);Qe===0&&(Qe=5)}function Ns(t,e,n){var r=ve,s=rn.transition;try{rn.transition=null,ve=1,ON(t,e,n,r)}finally{rn.transition=s,ve=r}return null}function ON(t,e,n,r){do Ri();while(Fr!==null);if(he&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(yI(t,i),t===et&&(qe=et=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fl||(Fl=!0,B_(Ic,function(){return Ri(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=rn.transition,rn.transition=null;var o=ve;ve=1;var l=he;he|=4,zm.current=null,PN(t,n),j_(n,t),rN(Zh),Sc=!!Jh,Zh=Jh=null,t.current=n,RN(n),lI(),he=l,ve=o,rn.transition=i}else t.current=n;if(Fl&&(Fl=!1,Fr=t,zc=s),i=t.pendingLanes,i===0&&(Wr=null),dI(n.stateNode),Mt(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Bc)throw Bc=!1,t=xf,xf=null,t;return zc&1&&t.tag!==0&&Ri(),i=t.pendingLanes,i&1?t===_f?na++:(na=0,_f=t):na=0,ds(),null}function Ri(){if(Fr!==null){var t=wx(zc),e=rn.transition,n=ve;try{if(rn.transition=null,ve=16>t?16:t,Fr===null)var r=!1;else{if(t=Fr,Fr=null,zc=0,he&6)throw Error(W(331));var s=he;for(he|=4,X=t.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(X=d;X!==null;){var h=X;switch(h.tag){case 0:case 11:case 15:ea(8,h,i)}var m=h.child;if(m!==null)m.return=h,X=m;else for(;X!==null;){h=X;var g=h.sibling,v=h.return;if(A_(h),h===d){X=null;break}if(g!==null){g.return=v,X=g;break}X=v}}}var S=i.alternate;if(S!==null){var N=S.child;if(N!==null){S.child=null;do{var b=N.sibling;N.sibling=null,N=b}while(N!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ea(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,X=x;break e}X=i.return}}var y=t.current;for(X=y;X!==null;){o=X;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,X=E;else e:for(o=y;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ku(9,l)}}catch(P){Fe(l,l.return,P)}if(l===o){X=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,X=R;break e}X=l.return}}if(he=s,ds(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(xu,t)}catch{}r=!0}return r}finally{ve=n,rn.transition=e}}return!1}function I0(t,e,n){e=qi(n,e),e=w_(t,e,1),t=Hr(t,e,1),e=Et(),t!==null&&(Wa(t,1,e),Mt(t,e))}function Fe(t,e,n){if(t.tag===3)I0(t,t,n);else for(;e!==null;){if(e.tag===3){I0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wr===null||!Wr.has(r))){t=qi(n,t),t=x_(e,t,1),e=Hr(e,t,1),t=Et(),e!==null&&(Wa(e,1,t),Mt(e,t));break}}e=e.return}}function VN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Et(),t.pingedLanes|=t.suspendedLanes&n,et===t&&(it&n)===n&&(Qe===4||Qe===3&&(it&130023424)===it&&500>Be()-Hm?Ds(t,0):qm|=n),Mt(t,e)}function U_(t,e){e===0&&(t.mode&1?(e=Cl,Cl<<=1,!(Cl&130023424)&&(Cl=4194304)):e=1);var n=Et();t=lr(t,e),t!==null&&(Wa(t,e,n),Mt(t,n))}function FN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),U_(t,n)}function UN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),U_(t,n)}var $_;$_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dt.current)jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jt=!1,SN(t,e,n);jt=!!(t.flags&131072)}else jt=!1,ke&&e.flags&1048576&&Hx(e,Dc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ic(t,e),t=e.pendingProps;var s=Ui(e,yt.current);Pi(e,n),s=Vm(null,e,r,t,s,n);var i=Fm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lt(r)?(i=!0,Rc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jm(e),s.updater=Su,e.stateNode=s,s._reactInternals=e,cf(e,r,t,n),e=hf(null,e,r,!0,i,n)):(e.tag=0,ke&&i&&Nm(e),bt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ic(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=BN(r),t=hn(r,t),s){case 0:e=df(null,e,r,t,n);break e;case 1:e=p0(null,e,r,t,n);break e;case 11:e=f0(null,e,r,t,n);break e;case 14:e=m0(null,e,r,hn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hn(r,s),df(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hn(r,s),p0(t,e,r,s,n);case 3:e:{if(T_(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Xx(t,e),Oc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=qi(Error(W(423)),e),e=g0(t,e,r,n,s);break e}else if(r!==s){s=qi(Error(W(424)),e),e=g0(t,e,r,n,s);break e}else for(qt=qr(e.stateNode.containerInfo.firstChild),Kt=e,ke=!0,mn=null,n=Qx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($i(),r===s){e=cr(t,e,n);break e}bt(t,e,r,n)}e=e.child}return e;case 5:return Jx(e),t===null&&of(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,ef(r,s)?o=null:i!==null&&ef(r,i)&&(e.flags|=32),E_(t,e),bt(t,e,o,n),e.child;case 6:return t===null&&of(e),null;case 13:return I_(t,e,n);case 4:return Dm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Bi(e,null,r,n):bt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hn(r,s),f0(t,e,r,s,n);case 7:return bt(t,e,e.pendingProps,n),e.child;case 8:return bt(t,e,e.pendingProps.children,n),e.child;case 12:return bt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,be(Lc,r._currentValue),r._currentValue=o,i!==null)if(wn(i.value,o)){if(i.children===s.children&&!Dt.current){e=cr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=er(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),af(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),af(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}bt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Pi(e,n),s=on(s),r=r(s),e.flags|=1,bt(t,e,r,n),e.child;case 14:return r=e.type,s=hn(r,e.pendingProps),s=hn(r.type,s),m0(t,e,r,s,n);case 15:return __(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:hn(r,s),ic(t,e),e.tag=1,Lt(r)?(t=!0,Rc(e)):t=!1,Pi(e,n),v_(e,r,s),cf(e,r,s,n),hf(null,e,r,!0,t,n);case 19:return N_(t,e,n);case 22:return b_(t,e,n)}throw Error(W(156,e.tag))};function B_(t,e){return px(t,e)}function $N(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(t,e,n,r){return new $N(t,e,n,r)}function Qm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function BN(t){if(typeof t=="function")return Qm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mm)return 11;if(t===pm)return 14}return 2}function Kr(t,e){var n=t.alternate;return n===null?(n=nn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function lc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Qm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case gi:return Ls(n.children,s,i,e);case fm:o=8,s|=8;break;case Rh:return t=nn(12,n,e,s|2),t.elementType=Rh,t.lanes=i,t;case jh:return t=nn(13,n,e,s),t.elementType=jh,t.lanes=i,t;case Dh:return t=nn(19,n,e,s),t.elementType=Dh,t.lanes=i,t;case Jw:return Au(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Yw:o=10;break e;case Xw:o=9;break e;case mm:o=11;break e;case pm:o=14;break e;case Ar:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=nn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ls(t,e,n,r){return t=nn(7,t,r,e),t.lanes=n,t}function Au(t,e,n,r){return t=nn(22,t,r,e),t.elementType=Jw,t.lanes=n,t.stateNode={isHidden:!1},t}function ah(t,e,n){return t=nn(6,t,null,e),t.lanes=n,t}function lh(t,e,n){return e=nn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bd(0),this.expirationTimes=Bd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ym(t,e,n,r,s,i,o,l,u){return t=new zN(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=nn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jm(i),t}function qN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function z_(t){if(!t)return es;t=t._reactInternals;e:{if(Zs(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Lt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Lt(n))return zx(t,n,e)}return e}function q_(t,e,n,r,s,i,o,l,u){return t=Ym(n,r,!0,t,s,i,o,l,u),t.context=z_(null),n=t.current,r=Et(),s=Gr(n),i=er(r,s),i.callback=e??null,Hr(n,i,s),t.current.lanes=s,Wa(t,s,r),Mt(t,r),t}function Pu(t,e,n,r){var s=e.current,i=Et(),o=Gr(s);return n=z_(n),e.context===null?e.context=n:e.pendingContext=n,e=er(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hr(s,e,o),t!==null&&(yn(t,s,o,i),nc(t,s,o)),o}function Hc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Xm(t,e){N0(t,e),(t=t.alternate)&&N0(t,e)}function HN(){return null}var H_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jm(t){this._internalRoot=t}Ru.prototype.render=Jm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Pu(t,e,null,null)};Ru.prototype.unmount=Jm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zs(function(){Pu(null,t,null,null)}),e[ar]=null}};function Ru(t){this._internalRoot=t}Ru.prototype.unstable_scheduleHydration=function(t){if(t){var e=bx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Rr.length&&e!==0&&e<Rr[n].priority;n++);Rr.splice(n,0,t),n===0&&Tx(t)}};function Zm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function S0(){}function WN(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Hc(o);i.call(d)}}var o=q_(e,r,t,0,null,!1,!1,"",S0);return t._reactRootContainer=o,t[ar]=o.current,wa(t.nodeType===8?t.parentNode:t),zs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Hc(u);l.call(d)}}var u=Ym(t,0,!1,null,null,!1,!1,"",S0);return t._reactRootContainer=u,t[ar]=u.current,wa(t.nodeType===8?t.parentNode:t),zs(function(){Pu(e,u,n,r)}),u}function Du(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=Hc(o);l.call(u)}}Pu(e,o,t,s)}else o=WN(n,e,t,s,r);return Hc(o)}xx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fo(e.pendingLanes);n!==0&&(vm(e,n|1),Mt(e,Be()),!(he&6)&&(Hi=Be()+500,ds()))}break;case 13:zs(function(){var r=lr(t,1);if(r!==null){var s=Et();yn(r,t,1,s)}}),Xm(t,1)}};wm=function(t){if(t.tag===13){var e=lr(t,134217728);if(e!==null){var n=Et();yn(e,t,134217728,n)}Xm(t,134217728)}};_x=function(t){if(t.tag===13){var e=Gr(t),n=lr(t,e);if(n!==null){var r=Et();yn(n,t,e,r)}Xm(t,e)}};bx=function(){return ve};Ex=function(t,e){var n=ve;try{return ve=t,e()}finally{ve=n}};qh=function(t,e,n){switch(e){case"input":if(Oh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Tu(r);if(!s)throw Error(W(90));ex(r),Oh(r,s)}}}break;case"textarea":nx(t,n);break;case"select":e=n.value,e!=null&&Si(t,!!n.multiple,e,!1)}};cx=Wm;ux=zs;var GN={usingClientEntryPoint:!1,Events:[Ka,xi,Tu,ax,lx,Wm]},Do={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KN={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=fx(t),t===null?null:t.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||HN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ul.isDisabled&&Ul.supportsFiber)try{xu=Ul.inject(KN),Ln=Ul}catch{}}Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GN;Xt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zm(e))throw Error(W(200));return qN(t,e,null,n)};Xt.createRoot=function(t,e){if(!Zm(t))throw Error(W(299));var n=!1,r="",s=H_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ym(t,1,!1,null,null,n,!1,r,s),t[ar]=e.current,wa(t.nodeType===8?t.parentNode:t),new Jm(e)};Xt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=fx(e),t=t===null?null:t.stateNode,t};Xt.flushSync=function(t){return zs(t)};Xt.hydrate=function(t,e,n){if(!ju(e))throw Error(W(200));return Du(null,t,e,!0,n)};Xt.hydrateRoot=function(t,e,n){if(!Zm(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=H_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=q_(e,null,t,1,n??null,s,!1,i,o),t[ar]=e.current,wa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ru(e)};Xt.render=function(t,e,n){if(!ju(e))throw Error(W(200));return Du(null,t,e,!1,n)};Xt.unmountComponentAtNode=function(t){if(!ju(t))throw Error(W(40));return t._reactRootContainer?(zs(function(){Du(null,null,t,!1,function(){t._reactRootContainer=null,t[ar]=null})}),!0):!1};Xt.unstable_batchedUpdates=Wm;Xt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ju(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Du(t,e,n,!1,r)};Xt.version="18.3.1-next-f1338f8080-20240426";function W_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(W_)}catch(t){console.error(t)}}W_(),Ww.exports=Xt;var QN=Ww.exports,k0=QN;Ah.createRoot=k0.createRoot,Ah.hydrateRoot=k0.hydrateRoot;/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var C0="popstate";function YN(t={}){function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Tf("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ka(s)}return JN(e,n,null,t)}function Ce(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function XN(){return Math.random().toString(36).substring(2,10)}function A0(t,e){return{usr:t.state,key:t.key,idx:e}}function Tf(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?to(e):e,state:n,key:e&&e.key||r||XN()}}function ka({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function to(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function JN(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function m(){l="POP";let b=h(),x=b==null?null:b-d;d=b,u&&u({action:l,location:N.location,delta:x})}function g(b,x){l="PUSH";let y=Tf(N.location,b,x);d=h()+1;let E=A0(y,d),R=N.createHref(y);try{o.pushState(E,"",R)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(R)}i&&u&&u({action:l,location:N.location,delta:1})}function v(b,x){l="REPLACE";let y=Tf(N.location,b,x);d=h();let E=A0(y,d),R=N.createHref(y);o.replaceState(E,"",R),i&&u&&u({action:l,location:N.location,delta:0})}function S(b){return ZN(b)}let N={get action(){return l},get location(){return t(s,o)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(C0,m),u=b,()=>{s.removeEventListener(C0,m),u=null}},createHref(b){return e(s,b)},createURL:S,encodeLocation(b){let x=S(b);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:v,go(b){return o.go(b)}};return N}function ZN(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ce(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:ka(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function G_(t,e,n="/"){return eS(t,e,n,!1)}function eS(t,e,n,r){let s=typeof e=="string"?to(e):e,i=ur(s.pathname||"/",n);if(i==null)return null;let o=K_(t);tS(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=hS(i);l=uS(o[u],d,r)}return l}function K_(t,e=[],n=[],r="",s=!1){let i=(o,l,u=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;Ce(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let m=tr([r,h.relativePath]),g=n.concat(h);o.children&&o.children.length>0&&(Ce(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),K_(o.children,e,g,m,u)),!(o.path==null&&!o.index)&&e.push({path:m,score:lS(m,o.index),routesMeta:g})};return t.forEach((o,l)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,l);else for(let d of Q_(o.path))i(o,l,!0,d)}),e}function Q_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Q_(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function tS(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:cS(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var nS=/^:[\w-]+$/,rS=3,sS=2,iS=1,oS=10,aS=-2,P0=t=>t==="*";function lS(t,e){let n=t.split("/"),r=n.length;return n.some(P0)&&(r+=aS),e&&(r+=sS),n.filter(s=>!P0(s)).reduce((s,i)=>s+(nS.test(i)?rS:i===""?iS:oS),r)}function cS(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function uS(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",m=Wc({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),g=u.route;if(!m&&d&&n&&!r[r.length-1].route.index&&(m=Wc({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:tr([i,m.pathname]),pathnameBase:gS(tr([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=tr([i,m.pathnameBase]))}return o}function Wc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=dS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:m},g)=>{if(h==="*"){let S=l[g]||"";o=i.slice(0,i.length-S.length).replace(/(.)\/+$/,"$1")}const v=l[g];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function dS(t,e=!1,n=!0){xn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function hS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ur(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function fS(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?to(t):t;return{pathname:n?n.startsWith("/")?n:mS(n,e):e,search:yS(r),hash:vS(s)}}function mS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function ch(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ep(t){let e=pS(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function tp(t,e,n,r=!1){let s;typeof t=="string"?s=to(t):(s={...t},Ce(!s.pathname||!s.pathname.includes("?"),ch("?","pathname","search",s)),Ce(!s.pathname||!s.pathname.includes("#"),ch("#","pathname","hash",s)),Ce(!s.search||!s.search.includes("#"),ch("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let u=fS(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var tr=t=>t.join("/").replace(/\/\/+/g,"/"),gS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),yS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,vS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Y_=["POST","PUT","PATCH","DELETE"];new Set(Y_);var xS=["GET",...Y_];new Set(xS);var no=A.createContext(null);no.displayName="DataRouter";var Lu=A.createContext(null);Lu.displayName="DataRouterState";A.createContext(!1);var X_=A.createContext({isTransitioning:!1});X_.displayName="ViewTransition";var _S=A.createContext(new Map);_S.displayName="Fetchers";var bS=A.createContext(null);bS.displayName="Await";var Tn=A.createContext(null);Tn.displayName="Navigation";var Ya=A.createContext(null);Ya.displayName="Location";var In=A.createContext({outlet:null,matches:[],isDataRoute:!1});In.displayName="Route";var np=A.createContext(null);np.displayName="RouteError";function ES(t,{relative:e}={}){Ce(ro(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(Tn),{hash:s,pathname:i,search:o}=Ja(t,{relative:e}),l=i;return n!=="/"&&(l=i==="/"?n:tr([n,i])),r.createHref({pathname:l,search:o,hash:s})}function ro(){return A.useContext(Ya)!=null}function hs(){return Ce(ro(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(Ya).location}var J_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Z_(t){A.useContext(Tn).static||A.useLayoutEffect(t)}function Xa(){let{isDataRoute:t}=A.useContext(In);return t?VS():TS()}function TS(){Ce(ro(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(no),{basename:e,navigator:n}=A.useContext(Tn),{matches:r}=A.useContext(In),{pathname:s}=hs(),i=JSON.stringify(ep(r)),o=A.useRef(!1);return Z_(()=>{o.current=!0}),A.useCallback((u,d={})=>{if(xn(o.current,J_),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=tp(u,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:tr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}var IS=A.createContext(null);function NS(t){let e=A.useContext(In).outlet;return A.useMemo(()=>e&&A.createElement(IS.Provider,{value:t},e),[e,t])}function Ja(t,{relative:e}={}){let{matches:n}=A.useContext(In),{pathname:r}=hs(),s=JSON.stringify(ep(n));return A.useMemo(()=>tp(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function SS(t,e){return eb(t,e)}function eb(t,e,n,r,s){var y;Ce(ro(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=A.useContext(Tn),{matches:o}=A.useContext(In),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let E=m&&m.path||"";tb(d,!m||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let g=hs(),v;if(e){let E=typeof e=="string"?to(e):e;Ce(h==="/"||((y=E.pathname)==null?void 0:y.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${E.pathname}" was given in the \`location\` prop.`),v=E}else v=g;let S=v.pathname||"/",N=S;if(h!=="/"){let E=h.replace(/^\//,"").split("/");N="/"+S.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=G_(t,{pathname:N});xn(m||b!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),xn(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=RS(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},u,E.params),pathname:tr([h,i.encodeLocation?i.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?h:tr([h,i.encodeLocation?i.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),o,n,r,s);return e&&x?A.createElement(Ya.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function kS(){let t=OS(),e=wS(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:i},"ErrorBoundary")," or"," ",A.createElement("code",{style:i},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,o)}var CS=A.createElement(kS,null),AS=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?A.createElement(In.Provider,{value:this.props.routeContext},A.createElement(np.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function PS({routeContext:t,match:e,children:n}){let r=A.useContext(no);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(In.Provider,{value:t},n)}function RS(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);Ce(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(n)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:m,errors:g}=n,v=h.route.loader&&!m.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||v){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,m)=>{let g,v=!1,S=null,N=null;n&&(g=o&&h.route.id?o[h.route.id]:void 0,S=h.route.errorElement||CS,l&&(u<0&&m===0?(tb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,N=null):u===m&&(v=!0,N=h.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,m+1)),x=()=>{let y;return g?y=S:v?y=N:h.route.Component?y=A.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=d,A.createElement(PS,{match:h,routeContext:{outlet:d,matches:b,isDataRoute:n!=null},children:y})};return n&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?A.createElement(AS,{location:n.location,revalidation:n.revalidation,component:S,error:g,children:x(),routeContext:{outlet:null,matches:b,isDataRoute:!0},unstable_onError:r}):x()},null)}function rp(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jS(t){let e=A.useContext(no);return Ce(e,rp(t)),e}function DS(t){let e=A.useContext(Lu);return Ce(e,rp(t)),e}function LS(t){let e=A.useContext(In);return Ce(e,rp(t)),e}function sp(t){let e=LS(t),n=e.matches[e.matches.length-1];return Ce(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function MS(){return sp("useRouteId")}function OS(){var r;let t=A.useContext(np),e=DS("useRouteError"),n=sp("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function VS(){let{router:t}=jS("useNavigate"),e=sp("useNavigate"),n=A.useRef(!1);return Z_(()=>{n.current=!0}),A.useCallback(async(s,i={})=>{xn(n.current,J_),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var R0={};function tb(t,e,n){!e&&!R0[t]&&(R0[t]=!0,xn(!1,n))}A.memo(FS);function FS({routes:t,future:e,state:n,unstable_onError:r}){return eb(t,void 0,n,r,e)}function ip({to:t,replace:e,state:n,relative:r}){Ce(ro(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=A.useContext(Tn);xn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=A.useContext(In),{pathname:o}=hs(),l=Xa(),u=tp(t,ep(i),o,r==="path"),d=JSON.stringify(u);return A.useEffect(()=>{l(JSON.parse(d),{replace:e,state:n,relative:r})},[l,d,r,e,n]),null}function US(t){return NS(t.context)}function $t(t){Ce(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function $S({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){Ce(!ro(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=A.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=to(n));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:g="default"}=n,v=A.useMemo(()=>{let S=ur(u,o);return S==null?null:{location:{pathname:S,search:d,hash:h,state:m,key:g},navigationType:r}},[o,u,d,h,m,g,r]);return xn(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:A.createElement(Tn.Provider,{value:l},A.createElement(Ya.Provider,{children:e,value:v}))}function nb({children:t,location:e}){return SS(If(t),e)}function If(t,e=[]){let n=[];return A.Children.forEach(t,(r,s)=>{if(!A.isValidElement(r))return;let i=[...e,s];if(r.type===A.Fragment){n.push.apply(n,If(r.props.children,i));return}Ce(r.type===$t,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ce(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=If(r.props.children,i)),n.push(o)}),n}var cc="get",uc="application/x-www-form-urlencoded";function Mu(t){return t!=null&&typeof t.tagName=="string"}function BS(t){return Mu(t)&&t.tagName.toLowerCase()==="button"}function zS(t){return Mu(t)&&t.tagName.toLowerCase()==="form"}function qS(t){return Mu(t)&&t.tagName.toLowerCase()==="input"}function HS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WS(t,e){return t.button===0&&(!e||e==="_self")&&!HS(t)}var $l=null;function GS(){if($l===null)try{new FormData(document.createElement("form"),0),$l=!1}catch{$l=!0}return $l}var KS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function uh(t){return t!=null&&!KS.has(t)?(xn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uc}"`),null):t}function QS(t,e){let n,r,s,i,o;if(zS(t)){let l=t.getAttribute("action");r=l?ur(l,e):null,n=t.getAttribute("method")||cc,s=uh(t.getAttribute("enctype"))||uc,i=new FormData(t)}else if(BS(t)||qS(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(r=u?ur(u,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||cc,s=uh(t.getAttribute("formenctype"))||uh(l.getAttribute("enctype"))||uc,i=new FormData(l,t),!GS()){let{name:d,type:h,value:m}=t;if(h==="image"){let g=d?`${d}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else d&&i.append(d,m)}}else{if(Mu(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=cc,r=null,s=uc,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function op(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function YS(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&ur(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function XS(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function ZS(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await XS(i,n);return o.links?o.links():[]}return[]}));return rk(r.flat(1).filter(JS).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function j0(t,e,n,r,s,i){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,l=(u,d)=>{var h;return n[d].pathname!==u.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==u.params["*"]};return i==="assets"?e.filter((u,d)=>o(u,d)||l(u,d)):i==="data"?e.filter((u,d)=>{var m;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=n[0])==null?void 0:m.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function ek(t,e,{includeHydrateFallback:n}={}){return tk(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function tk(t){return[...new Set(t)]}function nk(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function rk(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(nk(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function rb(){let t=A.useContext(no);return op(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function sk(){let t=A.useContext(Lu);return op(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ap=A.createContext(void 0);ap.displayName="FrameworkContext";function sb(){let t=A.useContext(ap);return op(t,"You must render this element inside a <HydratedRouter> element"),t}function ik(t,e){let n=A.useContext(ap),[r,s]=A.useState(!1),[i,o]=A.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:m}=e,g=A.useRef(null);A.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let N=x=>{x.forEach(y=>{o(y.isIntersecting)})},b=new IntersectionObserver(N,{threshold:.5});return g.current&&b.observe(g.current),()=>{b.disconnect()}}},[t]),A.useEffect(()=>{if(r){let N=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(N)}}},[r]);let v=()=>{s(!0)},S=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,g,{}]:[i,g,{onFocus:Lo(l,v),onBlur:Lo(u,S),onMouseEnter:Lo(d,v),onMouseLeave:Lo(h,S),onTouchStart:Lo(m,v)}]:[!1,g,{}]}function Lo(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function ok({page:t,...e}){let{router:n}=rb(),r=A.useMemo(()=>G_(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?A.createElement(lk,{page:t,matches:r,...e}):null}function ak(t){let{manifest:e,routeModules:n}=sb(),[r,s]=A.useState([]);return A.useEffect(()=>{let i=!1;return ZS(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function lk({page:t,matches:e,...n}){let r=hs(),{manifest:s,routeModules:i}=sb(),{basename:o}=rb(),{loaderData:l,matches:u}=sk(),d=A.useMemo(()=>j0(t,e,u,s,r,"data"),[t,e,u,s,r]),h=A.useMemo(()=>j0(t,e,u,s,r,"assets"),[t,e,u,s,r]),m=A.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let S=new Set,N=!1;if(e.forEach(x=>{var E;let y=s.routes[x.route.id];!y||!y.hasLoader||(!d.some(R=>R.route.id===x.route.id)&&x.route.id in l&&((E=i[x.route.id])!=null&&E.shouldRevalidate)||y.hasClientLoader?N=!0:S.add(x.route.id))}),S.size===0)return[];let b=YS(t,o,"data");return N&&S.size>0&&b.searchParams.set("_routes",e.filter(x=>S.has(x.route.id)).map(x=>x.route.id).join(",")),[b.pathname+b.search]},[o,l,r,s,d,e,t,i]),g=A.useMemo(()=>ek(h,s),[h,s]),v=ak(h);return A.createElement(A.Fragment,null,m.map(S=>A.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),g.map(S=>A.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),v.map(({key:S,link:N})=>A.createElement("link",{key:S,nonce:n.nonce,...N})))}function ck(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var ib=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ib&&(window.__reactRouterVersion="7.9.5")}catch{}function uk({basename:t,children:e,window:n}){let r=A.useRef();r.current==null&&(r.current=YN({window:n,v5Compat:!0}));let s=r.current,[i,o]=A.useState({action:s.action,location:s.location}),l=A.useCallback(u=>{A.startTransition(()=>o(u))},[o]);return A.useLayoutEffect(()=>s.listen(l),[s,l]),A.createElement($S,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var ob=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ab=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:m,...g},v){let{basename:S}=A.useContext(Tn),N=typeof d=="string"&&ob.test(d),b,x=!1;if(typeof d=="string"&&N&&(b=d,ib))try{let I=new URL(window.location.href),C=d.startsWith("//")?new URL(I.protocol+d):new URL(d),j=ur(C.pathname,S);C.origin===I.origin&&j!=null?d=j+C.search+C.hash:x=!0}catch{xn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=ES(d,{relative:s}),[E,R,P]=ik(r,g),O=fk(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:s,viewTransition:m});function T(I){e&&e(I),I.defaultPrevented||O(I)}let w=A.createElement("a",{...g,...P,href:b||y,onClick:x||i?e:T,ref:ck(v,R),target:u,"data-discover":!N&&n==="render"?"true":void 0});return E&&!N?A.createElement(A.Fragment,null,w,A.createElement(ok,{page:y})):w});ab.displayName="Link";var lb=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:l,children:u,...d},h){let m=Ja(o,{relative:d.relative}),g=hs(),v=A.useContext(Lu),{navigator:S,basename:N}=A.useContext(Tn),b=v!=null&&vk(m)&&l===!0,x=S.encodeLocation?S.encodeLocation(m).pathname:m.pathname,y=g.pathname,E=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(y=y.toLowerCase(),E=E?E.toLowerCase():null,x=x.toLowerCase()),E&&N&&(E=ur(E,N)||E);const R=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let P=y===x||!s&&y.startsWith(x)&&y.charAt(R)==="/",O=E!=null&&(E===x||!s&&E.startsWith(x)&&E.charAt(x.length)==="/"),T={isActive:P,isPending:O,isTransitioning:b},w=P?e:void 0,I;typeof r=="function"?I=r(T):I=[r,P?"active":null,O?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(T):i;return A.createElement(ab,{...d,"aria-current":w,className:I,ref:h,style:C,to:o,viewTransition:l},typeof u=="function"?u(T):u)});lb.displayName="NavLink";var dk=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=cc,action:l,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:m,...g},v)=>{let S=gk(),N=yk(l,{relative:d}),b=o.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&ob.test(l),y=E=>{if(u&&u(E),E.defaultPrevented)return;E.preventDefault();let R=E.nativeEvent.submitter,P=(R==null?void 0:R.getAttribute("formmethod"))||o;S(R||E.currentTarget,{fetcherKey:e,method:P,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:m})};return A.createElement("form",{ref:v,method:b,action:N,onSubmit:r?u:y,...g,"data-discover":!x&&t==="render"?"true":void 0})});dk.displayName="Form";function hk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cb(t){let e=A.useContext(no);return Ce(e,hk(t)),e}function fk(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=Xa(),u=hs(),d=Ja(t,{relative:i});return A.useCallback(h=>{if(WS(h,e)){h.preventDefault();let m=n!==void 0?n:ka(u)===ka(d);l(t,{replace:m,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[u,l,d,n,r,e,t,s,i,o])}var mk=0,pk=()=>`__${String(++mk)}__`;function gk(){let{router:t}=cb("useSubmit"),{basename:e}=A.useContext(Tn),n=MS();return A.useCallback(async(r,s={})=>{let{action:i,method:o,encType:l,formData:u,body:d}=QS(r,e);if(s.navigate===!1){let h=s.fetcherKey||pk();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function yk(t,{relative:e}={}){let{basename:n}=A.useContext(Tn),r=A.useContext(In);Ce(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Ja(t||".",{relative:e})},o=hs();if(t==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let h=l.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:tr([n,i.pathname])),ka(i)}function vk(t,{relative:e}={}){let n=A.useContext(X_);Ce(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=cb("useViewTransitionState"),s=Ja(t,{relative:e});if(!n.isTransitioning)return!1;let i=ur(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=ur(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Wc(s.pathname,o)!=null||Wc(s.pathname,i)!=null}const wk="modulepreload",xk=function(t){return"/"+t},D0={},ts=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=xk(u),u in D0)return;D0[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":wk,d||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},_k=()=>{};var L0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},bk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},db={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let g=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(g=64)),r.push(n[h],n[m],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ub(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):bk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new Ek;const g=i<<2|l>>4;if(r.push(g),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const S=d<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Ek extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Tk=function(t){const e=ub(t);return db.encodeByteArray(e,!0)},Gc=function(t){return Tk(t).replace(/\./g,"")},hb=function(t){try{return db.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=()=>Ik().__FIREBASE_DEFAULTS__,Sk=()=>{if(typeof process>"u"||typeof L0>"u")return;const t=L0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&hb(t[1]);return e&&JSON.parse(e)},Ou=()=>{try{return _k()||Nk()||Sk()||kk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},fb=t=>{var e,n;return(n=(e=Ou())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},mb=t=>{const e=fb(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},pb=()=>{var t;return(t=Ou())==null?void 0:t.config},gb=t=>{var e;return(e=Ou())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function lp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Gc(JSON.stringify(n)),Gc(JSON.stringify(o)),""].join(".")}const ra={};function Ak(){const t={prod:[],emulator:[]};for(const e of Object.keys(ra))ra[e]?t.emulator.push(e):t.prod.push(e);return t}function Pk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let M0=!1;function cp(t,e){if(typeof window>"u"||typeof document>"u"||!fs(window.location.host)||ra[t]===e||ra[t]||M0)return;ra[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=Ak().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{M0=!0,o()},g}function h(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=Pk(r),v=n("text"),S=document.getElementById(v)||document.createElement("span"),N=n("learnmore"),b=document.getElementById(N)||document.createElement("a"),x=n("preprendIcon"),y=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const E=g.element;l(E),h(b,N);const R=d();u(y,x),E.append(y,S,b,R),document.body.appendChild(E)}i?(S.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Rk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vt())}function jk(){var e;const t=(e=Ou())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Dk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Lk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Mk(){const t=vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ok(){return!jk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wb(){try{return typeof indexedDB=="object"}catch{return!1}}function xb(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function Vk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk="FirebaseError";class un extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Fk,Object.setPrototypeOf(this,un.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ei.prototype.create)}}class ei{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Uk(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new un(s,l,r)}}function Uk(t,e){return t.replace($k,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const $k=/\{\$([^}]+)}/g;function Bk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ns(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(O0(i)&&O0(o)){if(!ns(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function O0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $o(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Bo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function zk(t,e){const n=new qk(t,e);return n.subscribe.bind(n)}class qk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Hk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=dh),s.error===void 0&&(s.error=dh),s.complete===void 0&&(s.complete=dh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Hk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function dh(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=1e3,Gk=2,Kk=4*60*60*1e3,Qk=.5;function V0(t,e=Wk,n=Gk){const r=e*Math.pow(n,t),s=Math.round(Qk*r*(Math.random()-.5)*2);return Math.min(Kk,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(t){return t&&t._delegate?t._delegate:t}class ln{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ck;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Jk(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Xk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xk(t){return t===Ss?void 0:t}function Jk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Yk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const eC={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},tC=le.INFO,nC={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},rC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=nC[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vu{constructor(e){this.name=e,this._logLevel=tC,this._logHandler=rC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const sC=(t,e)=>e.some(n=>t instanceof n);let F0,U0;function iC(){return F0||(F0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oC(){return U0||(U0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _b=new WeakMap,Nf=new WeakMap,bb=new WeakMap,hh=new WeakMap,up=new WeakMap;function aC(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Qr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&_b.set(n,t)}).catch(()=>{}),up.set(e,t),e}function lC(t){if(Nf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Nf.set(t,e)}let Sf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Nf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bb.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Qr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cC(t){Sf=t(Sf)}function uC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(fh(this),e,...n);return bb.set(r,e.sort?e.sort():[e]),Qr(r)}:oC().includes(t)?function(...e){return t.apply(fh(this),e),Qr(_b.get(this))}:function(...e){return Qr(t.apply(fh(this),e))}}function dC(t){return typeof t=="function"?uC(t):(t instanceof IDBTransaction&&lC(t),sC(t,iC())?new Proxy(t,Sf):t)}function Qr(t){if(t instanceof IDBRequest)return aC(t);if(hh.has(t))return hh.get(t);const e=dC(t);return e!==t&&(hh.set(t,e),up.set(e,t)),e}const fh=t=>up.get(t);function Eb(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Qr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Qr(o.result),u.oldVersion,u.newVersion,Qr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const hC=["get","getKey","getAll","getAllKeys","count"],fC=["put","add","delete","clear"],mh=new Map;function $0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mh.get(e))return mh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=fC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||hC.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return mh.set(e,i),i}cC(t=>({...t,get:(e,n,r)=>$0(e,n)||t.get(e,n,r),has:(e,n)=>!!$0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const kf="@firebase/app",B0="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr=new Vu("@firebase/app"),gC="@firebase/app-compat",yC="@firebase/analytics-compat",vC="@firebase/analytics",wC="@firebase/app-check-compat",xC="@firebase/app-check",_C="@firebase/auth",bC="@firebase/auth-compat",EC="@firebase/database",TC="@firebase/data-connect",IC="@firebase/database-compat",NC="@firebase/functions",SC="@firebase/functions-compat",kC="@firebase/installations",CC="@firebase/installations-compat",AC="@firebase/messaging",PC="@firebase/messaging-compat",RC="@firebase/performance",jC="@firebase/performance-compat",DC="@firebase/remote-config",LC="@firebase/remote-config-compat",MC="@firebase/storage",OC="@firebase/storage-compat",VC="@firebase/firestore",FC="@firebase/ai",UC="@firebase/firestore-compat",$C="firebase",BC="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="[DEFAULT]",zC={[kf]:"fire-core",[gC]:"fire-core-compat",[vC]:"fire-analytics",[yC]:"fire-analytics-compat",[xC]:"fire-app-check",[wC]:"fire-app-check-compat",[_C]:"fire-auth",[bC]:"fire-auth-compat",[EC]:"fire-rtdb",[TC]:"fire-data-connect",[IC]:"fire-rtdb-compat",[NC]:"fire-fn",[SC]:"fire-fn-compat",[kC]:"fire-iid",[CC]:"fire-iid-compat",[AC]:"fire-fcm",[PC]:"fire-fcm-compat",[RC]:"fire-perf",[jC]:"fire-perf-compat",[DC]:"fire-rc",[LC]:"fire-rc-compat",[MC]:"fire-gcs",[OC]:"fire-gcs-compat",[VC]:"fire-fst",[UC]:"fire-fst-compat",[FC]:"fire-vertex","fire-js":"fire-js",[$C]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new Map,qC=new Map,Af=new Map;function z0(t,e){try{t.container.addComponent(e)}catch(n){dr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _n(t){const e=t.name;if(Af.has(e))return dr.debug(`There were multiple attempts to register component ${e}.`),!1;Af.set(e,t);for(const n of Ca.values())z0(n,t);for(const n of qC.values())z0(n,t);return!0}function ms(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Pt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yr=new ei("app","Firebase",HC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ln("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=BC;function Tb(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Cf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Yr.create("bad-app-name",{appName:String(s)});if(n||(n=pb()),!n)throw Yr.create("no-options");const i=Ca.get(s);if(i){if(ns(n,i.options)&&ns(r,i.config))return i;throw Yr.create("duplicate-app",{appName:s})}const o=new Zk(s);for(const u of Af.values())o.addComponent(u);const l=new WC(n,r,o);return Ca.set(s,l),l}function el(t=Cf){const e=Ca.get(t);if(!e&&t===Cf&&pb())return Tb();if(!e)throw Yr.create("no-app",{appName:t});return e}function GC(){return Array.from(Ca.values())}function Ot(t,e,n){let r=zC[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),dr.warn(o.join(" "));return}_n(new ln(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC="firebase-heartbeat-database",QC=1,Aa="firebase-heartbeat-store";let ph=null;function Ib(){return ph||(ph=Eb(KC,QC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Aa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Yr.create("idb-open",{originalErrorMessage:t.message})})),ph}async function YC(t){try{const n=(await Ib()).transaction(Aa),r=await n.objectStore(Aa).get(Nb(t));return await n.done,r}catch(e){if(e instanceof un)dr.warn(e.message);else{const n=Yr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});dr.warn(n.message)}}}async function q0(t,e){try{const r=(await Ib()).transaction(Aa,"readwrite");await r.objectStore(Aa).put(e,Nb(t)),await r.done}catch(n){if(n instanceof un)dr.warn(n.message);else{const r=Yr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});dr.warn(r.message)}}}function Nb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=1024,JC=30;class ZC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tA(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=H0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>JC){const o=nA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){dr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=H0(),{heartbeatsToSend:r,unsentEntries:s}=eA(this._heartbeatsCache.heartbeats),i=Gc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return dr.warn(n),""}}}function H0(){return new Date().toISOString().substring(0,10)}function eA(t,e=XC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),W0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),W0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wb()?xb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return q0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return q0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function W0(t){return Gc(JSON.stringify({version:2,heartbeats:t})).length}function nA(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t){_n(new ln("platform-logger",e=>new mC(e),"PRIVATE")),_n(new ln("heartbeat",e=>new ZC(e),"PRIVATE")),Ot(kf,B0,t),Ot(kf,B0,"esm2020"),Ot("fire-js","")}rA("");function Sb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sA=Sb,kb=new ei("auth","Firebase",Sb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=new Vu("@firebase/auth");function iA(t,...e){Kc.logLevel<=le.WARN&&Kc.warn(`Auth (${ti}): ${t}`,...e)}function dc(t,...e){Kc.logLevel<=le.ERROR&&Kc.error(`Auth (${ti}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(t,...e){throw hp(t,...e)}function vn(t,...e){return hp(t,...e)}function dp(t,e,n){const r={...sA(),[e]:n};return new ei("auth","Firebase",r).create(e,{appName:t.name})}function nr(t){return dp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oA(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&cn(t,"argument-error"),dp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return kb.create(t,...e)}function te(t,e,...n){if(!t)throw hp(e,...n)}function Jn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw dc(e),new Error(e)}function hr(t,e){t||Jn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function aA(){return G0()==="http:"||G0()==="https:"}function G0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aA()||vb()||"connection"in navigator)?navigator.onLine:!0}function cA(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n){this.shortDelay=e,this.longDelay=n,hr(n>e,"Short delay should be less than long delay!"),this.isMobile=Rk()||Lk()}get(){return lA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(t,e){hr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hA=new tl(3e4,6e4);function wr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Nn(t,e,n,r,s={}){return Ab(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Za({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return Dk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&fs(t.emulatorConfig.host)&&(d.credentials="include"),Cb.fetch()(await Pb(t,t.config.apiHost,n,l),d)})}async function Ab(t,e,n){t._canInitEmulator=!1;const r={...uA,...e};try{const s=new mA(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Bl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Bl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Bl(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw dp(t,h,d);cn(t,h)}}catch(s){if(s instanceof un)throw s;cn(t,"network-request-failed",{message:String(s)})}}async function nl(t,e,n,r,s={}){const i=await Nn(t,e,n,r,s);return"mfaPendingCredential"in i&&cn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Pb(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?fp(t.config,s):`${t.config.apiScheme}://${s}`;return dA.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function fA(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(vn(this.auth,"network-request-failed")),hA.get())})}}function Bl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=vn(t,e,r);return s.customData._tokenResponse=n,s}function K0(t){return t!==void 0&&t.enterprise!==void 0}class pA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return fA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function gA(t,e){return Nn(t,"GET","/v2/recaptchaConfig",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yA(t,e){return Nn(t,"POST","/v1/accounts:delete",e)}async function Qc(t,e){return Nn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vA(t,e=!1){const n=fe(t),r=await n.getIdToken(e),s=mp(r);te(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:sa(gh(s.auth_time)),issuedAtTime:sa(gh(s.iat)),expirationTime:sa(gh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function gh(t){return Number(t)*1e3}function mp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return dc("JWT malformed, contained fewer than 3 sections"),null;try{const s=hb(n);return s?JSON.parse(s):(dc("Failed to decode base64 JWT payload"),null)}catch(s){return dc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Q0(t){const e=mp(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qs(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof un&&wA(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function wA({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sa(this.lastLoginAt),this.creationTime=sa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(t){var m;const e=t.auth,n=await t.getIdToken(),r=await qs(t,Qc(e,{idToken:n}));te(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?Rb(s.providerUserInfo):[],o=bA(t.providerData,i),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Rf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function _A(t){const e=fe(t);await Yc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bA(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Rb(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(t,e){const n=await Ab(t,{},async()=>{const r=Za({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Pb(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&fs(t.emulatorConfig.host)&&(u.credentials="include"),Cb.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function TA(t,e){return Nn(t,"POST","/v2/accounts:revokeToken",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=Q0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await EA(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ji;return r&&(te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(te(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(te(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ji,this.toJSON())}_performRefresh(){return Jn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new xA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Rf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await qs(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return vA(this,e)}reload(){return _A(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new pn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Yc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pt(this.auth.app))return Promise.reject(nr(this.auth));const e=await this.getIdToken();return await qs(this,yA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:S,stsTokenManager:N}=n;te(m&&N,e,"internal-error");const b=ji.fromJSON(this.name,N);te(typeof m=="string",e,"internal-error"),Cr(r,e.name),Cr(s,e.name),te(typeof g=="boolean",e,"internal-error"),te(typeof v=="boolean",e,"internal-error"),Cr(i,e.name),Cr(o,e.name),Cr(l,e.name),Cr(u,e.name),Cr(d,e.name),Cr(h,e.name);const x=new pn({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:b,createdAt:d,lastLoginAt:h});return S&&Array.isArray(S)&&(x.providerData=S.map(y=>({...y}))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new ji;s.updateFromServerResponse(n);const i=new pn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Yc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Rb(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new ji;l.updateFromIdToken(r);const u=new pn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Rf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=new Map;function Zn(t){hr(t instanceof Function,"Expected a class definition");let e=Y0.get(t);return e?(hr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Y0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}jb.type="NONE";const X0=jb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t,e,n){return`firebase:${t}:${e}:${n}`}class Di{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=hc(this.userKey,s.apiKey,i),this.fullPersistenceKey=hc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Qc(this.auth,{idToken:e}).catch(()=>{});return n?pn._fromGetAccountInfoResponse(this.auth,n,e):null}return pn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Di(Zn(X0),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Zn(X0);const o=hc(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const g=await Qc(e,{idToken:h}).catch(()=>{});if(!g)break;m=await pn._fromGetAccountInfoResponse(e,g,h)}else m=pn._fromJSON(e,h);d!==i&&(l=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Di(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Di(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ob(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Db(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Fb(e))return"Blackberry";if(Ub(e))return"Webos";if(Lb(e))return"Safari";if((e.includes("chrome/")||Mb(e))&&!e.includes("edge/"))return"Chrome";if(Vb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Db(t=vt()){return/firefox\//i.test(t)}function Lb(t=vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mb(t=vt()){return/crios\//i.test(t)}function Ob(t=vt()){return/iemobile/i.test(t)}function Vb(t=vt()){return/android/i.test(t)}function Fb(t=vt()){return/blackberry/i.test(t)}function Ub(t=vt()){return/webos/i.test(t)}function pp(t=vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function IA(t=vt()){var e;return pp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function NA(){return Mk()&&document.documentMode===10}function $b(t=vt()){return pp(t)||Vb(t)||Ub(t)||Fb(t)||/windows phone/i.test(t)||Ob(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(t,e=[]){let n;switch(t){case"Browser":n=J0(vt());break;case"Worker":n=`${J0(vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ti}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kA(t,e={}){return Nn(t,"GET","/v2/passwordPolicy",wr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=6;class AA{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??CA,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Z0(this),this.idTokenSubscription=new Z0(this),this.beforeStateQueue=new SA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Zn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Di.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qc(this,{idToken:e}),r=await pn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Pt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pt(this.app))return Promise.reject(nr(this));const n=e?fe(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pt(this.app)?Promise.reject(nr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pt(this.app)?Promise.reject(nr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kA(this),n=new AA(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ei("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await TA(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Zn(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await Di.create(this,[Zn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Pt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&iA(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function xr(t){return fe(t)}class Z0{constructor(e){this.auth=e,this.observer=null,this.addObserver=zk(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RA(t){Fu=t}function zb(t){return Fu.loadJS(t)}function jA(){return Fu.recaptchaEnterpriseScript}function DA(){return Fu.gapiScript}function LA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class MA{constructor(){this.enterprise=new OA}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class OA{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const VA="recaptcha-enterprise",qb="NO_RECAPTCHA";class FA{constructor(e){this.type=VA,this.auth=xr(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{gA(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new pA(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;K0(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(qb)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MA().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&K0(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=jA();u.length!==0&&(u+=l),zb(u).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function ev(t,e,n,r=!1,s=!1){const i=new FA(t);let o;if(s)o=qb;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Xc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ev(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await ev(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t,e){const n=ms(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ns(i,e??{}))return s;cn(s,"already-initialized")}return n.initialize({options:e})}function $A(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Zn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function BA(t,e,n){const r=xr(t);te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Hb(e),{host:o,port:l}=zA(e),u=l===null?"":`:${l}`,d={url:`${i}//${o}${u}/`},h=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){te(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),te(ns(d,r.config.emulator)&&ns(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,fs(o)?(lp(`${i}//${o}${u}`),cp("Auth",!0)):qA()}function Hb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function zA(t){const e=Hb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:tv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:tv(o)}}}function tv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function qA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Jn("not implemented")}_getIdTokenResponse(e){return Jn("not implemented")}_linkToIdToken(e,n){return Jn("not implemented")}_getReauthenticationResolver(e){return Jn("not implemented")}}async function HA(t,e){return Nn(t,"POST","/v1/accounts:update",e)}async function WA(t,e){return Nn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GA(t,e){return nl(t,"POST","/v1/accounts:signInWithPassword",wr(t,e))}async function Wb(t,e){return Nn(t,"POST","/v1/accounts:sendOobCode",wr(t,e))}async function KA(t,e){return Wb(t,e)}async function QA(t,e){return Wb(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YA(t,e){return nl(t,"POST","/v1/accounts:signInWithEmailLink",wr(t,e))}async function XA(t,e){return nl(t,"POST","/v1/accounts:signInWithEmailLink",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa extends gp{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Pa(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Pa(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xc(e,n,"signInWithPassword",GA);case"emailLink":return YA(e,{email:this._email,oobCode:this._password});default:cn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xc(e,r,"signUpPassword",WA);case"emailLink":return XA(e,{idToken:n,email:this._email,oobCode:this._password});default:cn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(t,e){return nl(t,"POST","/v1/accounts:signInWithIdp",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA="http://localhost";class Hs extends gp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Hs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):cn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Hs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Li(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Li(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Li(e,n)}buildRequest(){const e={requestUri:JA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Za(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eP(t){const e=$o(Bo(t)).link,n=e?$o(Bo(e)).deep_link_id:null,r=$o(Bo(t)).deep_link_id;return(r?$o(Bo(r)).link:null)||r||n||e||t}class yp{constructor(e){const n=$o(Bo(e)),r=n.apiKey??null,s=n.oobCode??null,i=ZA(n.mode??null);te(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=eP(e);try{return new yp(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(){this.providerId=fr.PROVIDER_ID}static credential(e,n){return Pa._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=yp.parseLink(n);return te(r,"argument-error"),Pa._fromEmailAndCode(e,r.code,r.tenantId)}}fr.PROVIDER_ID="password";fr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";fr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl extends vp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends rl{constructor(){super("facebook.com")}static credential(e){return Hs._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dr.credential(e.oauthAccessToken)}catch{return null}}}Dr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Dr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn extends rl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Hs._fromParams({providerId:Kn.PROVIDER_ID,signInMethod:Kn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Kn.credentialFromTaggedObject(e)}static credentialFromError(e){return Kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Kn.credential(n,r)}catch{return null}}}Kn.GOOGLE_SIGN_IN_METHOD="google.com";Kn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends rl{constructor(){super("github.com")}static credential(e){return Hs._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lr.credential(e.oauthAccessToken)}catch{return null}}}Lr.GITHUB_SIGN_IN_METHOD="github.com";Lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends rl{constructor(){super("twitter.com")}static credential(e,n){return Hs._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Mr.credential(n,r)}catch{return null}}}Mr.TWITTER_SIGN_IN_METHOD="twitter.com";Mr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tP(t,e){return nl(t,"POST","/v1/accounts:signUp",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await pn._fromIdTokenResponse(e,r,s),o=nv(r);return new Ws({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=nv(r);return new Ws({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function nv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc extends un{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Jc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Jc(e,n,r,s)}}function Gb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Jc._fromErrorAndOperation(t,i,e,r):i})}async function nP(t,e,n=!1){const r=await qs(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ws._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kb(t,e,n=!1){const{auth:r}=t;if(Pt(r.app))return Promise.reject(nr(r));const s="reauthenticate";try{const i=await qs(t,Gb(r,s,e,t),n);te(i.idToken,r,"internal-error");const o=mp(i.idToken);te(o,r,"internal-error");const{sub:l}=o;return te(t.uid===l,r,"user-mismatch"),Ws._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&cn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qb(t,e,n=!1){if(Pt(t.app))return Promise.reject(nr(t));const r="signIn",s=await Gb(t,r,e),i=await Ws._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function rP(t,e){return Qb(xr(t),e)}async function jf(t,e){return Kb(fe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yb(t){const e=xr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sP(t,e,n){const r=xr(t);await Xc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",QA)}async function iP(t,e,n){if(Pt(t.app))return Promise.reject(nr(t));const r=xr(t),o=await Xc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tP).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Yb(t),u}),l=await Ws._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function oP(t,e,n){return Pt(t.app)?Promise.reject(nr(t)):rP(fe(t),fr.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yb(t),r})}async function aP(t,e){const n=fe(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:i}=await KA(n.auth,s);i!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(t,e){return Nn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xb(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=fe(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await qs(r,lP(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Jb(t,e){return cP(fe(t),null,e)}async function cP(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await qs(t,HA(r,i));await t._updateTokensIfNecessary(o,!0)}function uP(t,e,n,r){return fe(t).onIdTokenChanged(e,n,r)}function dP(t,e,n){return fe(t).beforeAuthStateChanged(e,n)}function hP(t,e,n,r){return fe(t).onAuthStateChanged(e,n,r)}function fP(t){return fe(t).signOut()}async function mP(t){return fe(t).delete()}const Zc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Zc,"1"),this.storage.removeItem(Zc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP=1e3,gP=10;class e1 extends Zb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$b(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);NA()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,gP):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},pP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}e1.type="LOCAL";const yP=e1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1 extends Zb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}t1.type="SESSION";const n1=t1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Uu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await vP(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=wp("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(){return window}function xP(t){On().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(){return typeof On().WorkerGlobalScope<"u"&&typeof On().importScripts=="function"}async function _P(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bP(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function EP(){return r1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1="firebaseLocalStorageDb",TP=1,eu="firebaseLocalStorage",i1="fbase_key";class sl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $u(t,e){return t.transaction([eu],e?"readwrite":"readonly").objectStore(eu)}function IP(){const t=indexedDB.deleteDatabase(s1);return new sl(t).toPromise()}function Df(){const t=indexedDB.open(s1,TP);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(eu,{keyPath:i1})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(eu)?e(r):(r.close(),await IP(),e(await Df()))})})}async function rv(t,e,n){const r=$u(t,!0).put({[i1]:e,value:n});return new sl(r).toPromise()}async function NP(t,e){const n=$u(t,!1).get(e),r=await new sl(n).toPromise();return r===void 0?null:r.value}function sv(t,e){const n=$u(t,!0).delete(e);return new sl(n).toPromise()}const SP=800,kP=3;class o1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Df(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>kP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return r1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uu._getInstance(EP()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await _P(),!this.activeServiceWorker)return;this.sender=new wP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Df();return await rv(e,Zc,"1"),await sv(e,Zc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>NP(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=$u(s,!1).getAll();return new sl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),SP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}o1.type="LOCAL";const CP=o1;new tl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(t,e){return e?Zn(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp extends gp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Li(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Li(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Li(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function AP(t){return Qb(t.auth,new xp(t),t.bypassAuthState)}function PP(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),Kb(n,new xp(t),t.bypassAuthState)}async function RP(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),nP(n,new xp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AP;case"linkViaPopup":case"linkViaRedirect":return RP;case"reauthViaPopup":case"reauthViaRedirect":return PP;default:cn(this.auth,"internal-error")}}resolve(e){hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=new tl(2e3,1e4);async function DP(t,e,n){if(Pt(t.app))return Promise.reject(vn(t,"operation-not-supported-in-this-environment"));const r=xr(t);oA(t,e,vp);const s=a1(r,n);return new Ps(r,"signInViaPopup",e,s).executeNotNull()}class Ps extends l1{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ps.currentPopupAction&&Ps.currentPopupAction.cancel(),Ps.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){hr(this.filter.length===1,"Popup operations only handle one event");const e=wp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(vn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(vn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ps.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jP.get())};e()}}Ps.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP="pendingRedirect",fc=new Map;class MP extends l1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=fc.get(this.auth._key());if(!e){try{const r=await OP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}fc.set(this.auth._key(),e)}return this.bypassAuthState||fc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OP(t,e){const n=UP(e),r=FP(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function VP(t,e){fc.set(t._key(),e)}function FP(t){return Zn(t._redirectPersistence)}function UP(t){return hc(LP,t.config.apiKey,t.name)}async function $P(t,e,n=!1){if(Pt(t.app))return Promise.reject(nr(t));const r=xr(t),s=a1(r,e),o=await new MP(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=10*60*1e3;class zP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!c1(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(vn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BP&&this.cachedEventUids.clear(),this.cachedEventUids.has(iv(e))}saveEventToCache(e){this.cachedEventUids.add(iv(e)),this.lastProcessedEventTime=Date.now()}}function iv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function c1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HP(t,e={}){return Nn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GP=/^https?/;async function KP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await HP(t);for(const n of e)try{if(QP(n))return}catch{}cn(t,"unauthorized-domain")}function QP(t){const e=Pf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!GP.test(n))return!1;if(WP.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP=new tl(3e4,6e4);function ov(){const t=On().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function XP(t){return new Promise((e,n)=>{var s,i,o;function r(){ov(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ov(),n(vn(t,"network-request-failed"))},timeout:YP.get()})}if((i=(s=On().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=On().gapi)!=null&&o.load)r();else{const l=LA("iframefcb");return On()[l]=()=>{gapi.load?r():n(vn(t,"network-request-failed"))},zb(`${DA()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw mc=null,e})}let mc=null;function JP(t){return mc=mc||XP(t),mc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP=new tl(5e3,15e3),eR="__/auth/iframe",tR="emulator/auth/iframe",nR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sR(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fp(e,tR):`https://${t.config.authDomain}/${eR}`,r={apiKey:e.apiKey,appName:t.name,v:ti},s=rR.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Za(r).slice(1)}`}async function iR(t){const e=await JP(t),n=On().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:sR(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nR,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=vn(t,"network-request-failed"),l=On().setTimeout(()=>{i(o)},ZP.get());function u(){On().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aR=500,lR=600,cR="_blank",uR="http://localhost";class av{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dR(t,e,n,r=aR,s=lR){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...oR,width:r.toString(),height:s.toString(),top:i,left:o},d=vt().toLowerCase();n&&(l=Mb(d)?cR:n),Db(d)&&(e=e||uR,u.scrollbars="yes");const h=Object.entries(u).reduce((g,[v,S])=>`${g}${v}=${S},`,"");if(IA(d)&&l!=="_self")return hR(e||"",l),new av(null);const m=window.open(e||"",l,h);te(m,t,"popup-blocked");try{m.focus()}catch{}return new av(m)}function hR(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR="__/auth/handler",mR="emulator/auth/handler",pR=encodeURIComponent("fac");async function lv(t,e,n,r,s,i){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ti,eventId:s};if(e instanceof vp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Bk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof rl){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${pR}=${encodeURIComponent(u)}`:"";return`${gR(t)}?${Za(l).slice(1)}${d}`}function gR({config:t}){return t.emulator?fp(t,mR):`https://${t.authDomain}/${fR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh="webStorageSupport";class yR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=n1,this._completeRedirectFn=$P,this._overrideRedirectResult=VP}async _openPopup(e,n,r,s){var o;hr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await lv(e,n,r,Pf(),s);return dR(e,i,wp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await lv(e,n,r,Pf(),s);return xP(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(hr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await iR(e),r=new zP(e);return n.register("authEvent",s=>(te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(yh,{type:yh},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[yh];i!==void 0&&n(!!i),cn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=KP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return $b()||Lb()||pp()}}const vR=yR;var cv="@firebase/auth",uv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _R(t){_n(new ln("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bb(t)},d=new PA(r,s,i,u);return $A(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),_n(new ln("auth-internal",e=>{const n=xr(e.getProvider("auth").getImmediate());return(r=>new wR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ot(cv,uv,xR(t)),Ot(cv,uv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=5*60,ER=gb("authIdTokenMaxAge")||bR;let dv=null;const TR=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ER)return;const s=n==null?void 0:n.token;dv!==s&&(dv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function IR(t=el()){const e=ms(t,"auth");if(e.isInitialized())return e.getImmediate();const n=UA(t,{popupRedirectResolver:vR,persistence:[CP,yP,n1]}),r=gb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=TR(i.toString());dP(n,o,()=>o(n.currentUser)),uP(n,l=>o(l))}}const s=fb("auth");return s&&BA(n,`http://${s}`),n}function NR(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}RA({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=vn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",NR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_R("Browser");var hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xr,u1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function I(){}I.prototype=w.prototype,T.F=w.prototype,T.prototype=new I,T.prototype.constructor=T,T.D=function(C,j,D){for(var k=Array(arguments.length-2),H=2;H<arguments.length;H++)k[H-2]=arguments[H];return w.prototype[j].apply(C,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,w,I){I||(I=0);const C=Array(16);if(typeof w=="string")for(var j=0;j<16;++j)C[j]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(j=0;j<16;++j)C[j]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=T.g[0],I=T.g[1],j=T.g[2];let D=T.g[3],k;k=w+(D^I&(j^D))+C[0]+3614090360&4294967295,w=I+(k<<7&4294967295|k>>>25),k=D+(j^w&(I^j))+C[1]+3905402710&4294967295,D=w+(k<<12&4294967295|k>>>20),k=j+(I^D&(w^I))+C[2]+606105819&4294967295,j=D+(k<<17&4294967295|k>>>15),k=I+(w^j&(D^w))+C[3]+3250441966&4294967295,I=j+(k<<22&4294967295|k>>>10),k=w+(D^I&(j^D))+C[4]+4118548399&4294967295,w=I+(k<<7&4294967295|k>>>25),k=D+(j^w&(I^j))+C[5]+1200080426&4294967295,D=w+(k<<12&4294967295|k>>>20),k=j+(I^D&(w^I))+C[6]+2821735955&4294967295,j=D+(k<<17&4294967295|k>>>15),k=I+(w^j&(D^w))+C[7]+4249261313&4294967295,I=j+(k<<22&4294967295|k>>>10),k=w+(D^I&(j^D))+C[8]+1770035416&4294967295,w=I+(k<<7&4294967295|k>>>25),k=D+(j^w&(I^j))+C[9]+2336552879&4294967295,D=w+(k<<12&4294967295|k>>>20),k=j+(I^D&(w^I))+C[10]+4294925233&4294967295,j=D+(k<<17&4294967295|k>>>15),k=I+(w^j&(D^w))+C[11]+2304563134&4294967295,I=j+(k<<22&4294967295|k>>>10),k=w+(D^I&(j^D))+C[12]+1804603682&4294967295,w=I+(k<<7&4294967295|k>>>25),k=D+(j^w&(I^j))+C[13]+4254626195&4294967295,D=w+(k<<12&4294967295|k>>>20),k=j+(I^D&(w^I))+C[14]+2792965006&4294967295,j=D+(k<<17&4294967295|k>>>15),k=I+(w^j&(D^w))+C[15]+1236535329&4294967295,I=j+(k<<22&4294967295|k>>>10),k=w+(j^D&(I^j))+C[1]+4129170786&4294967295,w=I+(k<<5&4294967295|k>>>27),k=D+(I^j&(w^I))+C[6]+3225465664&4294967295,D=w+(k<<9&4294967295|k>>>23),k=j+(w^I&(D^w))+C[11]+643717713&4294967295,j=D+(k<<14&4294967295|k>>>18),k=I+(D^w&(j^D))+C[0]+3921069994&4294967295,I=j+(k<<20&4294967295|k>>>12),k=w+(j^D&(I^j))+C[5]+3593408605&4294967295,w=I+(k<<5&4294967295|k>>>27),k=D+(I^j&(w^I))+C[10]+38016083&4294967295,D=w+(k<<9&4294967295|k>>>23),k=j+(w^I&(D^w))+C[15]+3634488961&4294967295,j=D+(k<<14&4294967295|k>>>18),k=I+(D^w&(j^D))+C[4]+3889429448&4294967295,I=j+(k<<20&4294967295|k>>>12),k=w+(j^D&(I^j))+C[9]+568446438&4294967295,w=I+(k<<5&4294967295|k>>>27),k=D+(I^j&(w^I))+C[14]+3275163606&4294967295,D=w+(k<<9&4294967295|k>>>23),k=j+(w^I&(D^w))+C[3]+4107603335&4294967295,j=D+(k<<14&4294967295|k>>>18),k=I+(D^w&(j^D))+C[8]+1163531501&4294967295,I=j+(k<<20&4294967295|k>>>12),k=w+(j^D&(I^j))+C[13]+2850285829&4294967295,w=I+(k<<5&4294967295|k>>>27),k=D+(I^j&(w^I))+C[2]+4243563512&4294967295,D=w+(k<<9&4294967295|k>>>23),k=j+(w^I&(D^w))+C[7]+1735328473&4294967295,j=D+(k<<14&4294967295|k>>>18),k=I+(D^w&(j^D))+C[12]+2368359562&4294967295,I=j+(k<<20&4294967295|k>>>12),k=w+(I^j^D)+C[5]+4294588738&4294967295,w=I+(k<<4&4294967295|k>>>28),k=D+(w^I^j)+C[8]+2272392833&4294967295,D=w+(k<<11&4294967295|k>>>21),k=j+(D^w^I)+C[11]+1839030562&4294967295,j=D+(k<<16&4294967295|k>>>16),k=I+(j^D^w)+C[14]+4259657740&4294967295,I=j+(k<<23&4294967295|k>>>9),k=w+(I^j^D)+C[1]+2763975236&4294967295,w=I+(k<<4&4294967295|k>>>28),k=D+(w^I^j)+C[4]+1272893353&4294967295,D=w+(k<<11&4294967295|k>>>21),k=j+(D^w^I)+C[7]+4139469664&4294967295,j=D+(k<<16&4294967295|k>>>16),k=I+(j^D^w)+C[10]+3200236656&4294967295,I=j+(k<<23&4294967295|k>>>9),k=w+(I^j^D)+C[13]+681279174&4294967295,w=I+(k<<4&4294967295|k>>>28),k=D+(w^I^j)+C[0]+3936430074&4294967295,D=w+(k<<11&4294967295|k>>>21),k=j+(D^w^I)+C[3]+3572445317&4294967295,j=D+(k<<16&4294967295|k>>>16),k=I+(j^D^w)+C[6]+76029189&4294967295,I=j+(k<<23&4294967295|k>>>9),k=w+(I^j^D)+C[9]+3654602809&4294967295,w=I+(k<<4&4294967295|k>>>28),k=D+(w^I^j)+C[12]+3873151461&4294967295,D=w+(k<<11&4294967295|k>>>21),k=j+(D^w^I)+C[15]+530742520&4294967295,j=D+(k<<16&4294967295|k>>>16),k=I+(j^D^w)+C[2]+3299628645&4294967295,I=j+(k<<23&4294967295|k>>>9),k=w+(j^(I|~D))+C[0]+4096336452&4294967295,w=I+(k<<6&4294967295|k>>>26),k=D+(I^(w|~j))+C[7]+1126891415&4294967295,D=w+(k<<10&4294967295|k>>>22),k=j+(w^(D|~I))+C[14]+2878612391&4294967295,j=D+(k<<15&4294967295|k>>>17),k=I+(D^(j|~w))+C[5]+4237533241&4294967295,I=j+(k<<21&4294967295|k>>>11),k=w+(j^(I|~D))+C[12]+1700485571&4294967295,w=I+(k<<6&4294967295|k>>>26),k=D+(I^(w|~j))+C[3]+2399980690&4294967295,D=w+(k<<10&4294967295|k>>>22),k=j+(w^(D|~I))+C[10]+4293915773&4294967295,j=D+(k<<15&4294967295|k>>>17),k=I+(D^(j|~w))+C[1]+2240044497&4294967295,I=j+(k<<21&4294967295|k>>>11),k=w+(j^(I|~D))+C[8]+1873313359&4294967295,w=I+(k<<6&4294967295|k>>>26),k=D+(I^(w|~j))+C[15]+4264355552&4294967295,D=w+(k<<10&4294967295|k>>>22),k=j+(w^(D|~I))+C[6]+2734768916&4294967295,j=D+(k<<15&4294967295|k>>>17),k=I+(D^(j|~w))+C[13]+1309151649&4294967295,I=j+(k<<21&4294967295|k>>>11),k=w+(j^(I|~D))+C[4]+4149444226&4294967295,w=I+(k<<6&4294967295|k>>>26),k=D+(I^(w|~j))+C[11]+3174756917&4294967295,D=w+(k<<10&4294967295|k>>>22),k=j+(w^(D|~I))+C[2]+718787259&4294967295,j=D+(k<<15&4294967295|k>>>17),k=I+(D^(j|~w))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(j+(k<<21&4294967295|k>>>11))&4294967295,T.g[2]=T.g[2]+j&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.v=function(T,w){w===void 0&&(w=T.length);const I=w-this.blockSize,C=this.C;let j=this.h,D=0;for(;D<w;){if(j==0)for(;D<=I;)s(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<w;)if(C[j++]=T.charCodeAt(D++),j==this.blockSize){s(this,C),j=0;break}}else for(;D<w;)if(C[j++]=T[D++],j==this.blockSize){s(this,C),j=0;break}}this.h=j,this.o+=w},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;w=this.o*8;for(var I=T.length-8;I<T.length;++I)T[I]=w&255,w/=256;for(this.v(T),T=Array(16),w=0,I=0;I<4;++I)for(let C=0;C<32;C+=8)T[w++]=this.g[I]>>>C&255;return T};function i(T,w){var I=l;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=w(T)}function o(T,w){this.h=w;const I=[];let C=!0;for(let j=T.length-1;j>=0;j--){const D=T[j]|0;C&&D==w||(I[j]=D,C=!1)}this.g=I}var l={};function u(T){return-128<=T&&T<128?i(T,function(w){return new o([w|0],w<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return m;if(T<0)return b(d(-T));const w=[];let I=1;for(let C=0;T>=I;C++)w[C]=T/I|0,I*=4294967296;return new o(w,0)}function h(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return b(h(T.substring(1),w));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=d(Math.pow(w,8));let C=m;for(let D=0;D<T.length;D+=8){var j=Math.min(8,T.length-D);const k=parseInt(T.substring(D,D+j),w);j<8?(j=d(Math.pow(w,j)),C=C.j(j).add(d(k))):(C=C.j(I),C=C.add(d(k)))}return C}var m=u(0),g=u(1),v=u(16777216);t=o.prototype,t.m=function(){if(N(this))return-b(this).m();let T=0,w=1;for(let I=0;I<this.g.length;I++){const C=this.i(I);T+=(C>=0?C:4294967296+C)*w,w*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(N(this))return"-"+b(this).toString(T);const w=d(Math.pow(T,6));var I=this;let C="";for(;;){const j=R(I,w).g;I=x(I,j.j(w));let D=((I.g.length>0?I.g[0]:I.h)>>>0).toString(T);if(I=j,S(I))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(let w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function N(T){return T.h==-1}t.l=function(T){return T=x(this,T),N(T)?-1:S(T)?0:1};function b(T){const w=T.g.length,I=[];for(let C=0;C<w;C++)I[C]=~T.g[C];return new o(I,~T.h).add(g)}t.abs=function(){return N(this)?b(this):this},t.add=function(T){const w=Math.max(this.g.length,T.g.length),I=[];let C=0;for(let j=0;j<=w;j++){let D=C+(this.i(j)&65535)+(T.i(j)&65535),k=(D>>>16)+(this.i(j)>>>16)+(T.i(j)>>>16);C=k>>>16,D&=65535,k&=65535,I[j]=k<<16|D}return new o(I,I[I.length-1]&-2147483648?-1:0)};function x(T,w){return T.add(b(w))}t.j=function(T){if(S(this)||S(T))return m;if(N(this))return N(T)?b(this).j(b(T)):b(b(this).j(T));if(N(T))return b(this.j(b(T)));if(this.l(v)<0&&T.l(v)<0)return d(this.m()*T.m());const w=this.g.length+T.g.length,I=[];for(var C=0;C<2*w;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(let j=0;j<T.g.length;j++){const D=this.i(C)>>>16,k=this.i(C)&65535,H=T.i(j)>>>16,J=T.i(j)&65535;I[2*C+2*j]+=k*J,y(I,2*C+2*j),I[2*C+2*j+1]+=D*J,y(I,2*C+2*j+1),I[2*C+2*j+1]+=k*H,y(I,2*C+2*j+1),I[2*C+2*j+2]+=D*H,y(I,2*C+2*j+2)}for(T=0;T<w;T++)I[T]=I[2*T+1]<<16|I[2*T];for(T=w;T<2*w;T++)I[T]=0;return new o(I,0)};function y(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function E(T,w){this.g=T,this.h=w}function R(T,w){if(S(w))throw Error("division by zero");if(S(T))return new E(m,m);if(N(T))return w=R(b(T),w),new E(b(w.g),b(w.h));if(N(w))return w=R(T,b(w)),new E(b(w.g),w.h);if(T.g.length>30){if(N(T)||N(w))throw Error("slowDivide_ only works with positive integers.");for(var I=g,C=w;C.l(T)<=0;)I=P(I),C=P(C);var j=O(I,1),D=O(C,1);for(C=O(C,2),I=O(I,2);!S(C);){var k=D.add(C);k.l(T)<=0&&(j=j.add(I),D=k),C=O(C,1),I=O(I,1)}return w=x(T,j.j(w)),new E(j,w)}for(j=m;T.l(w)>=0;){for(I=Math.max(1,Math.floor(T.m()/w.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=d(I),k=D.j(w);N(k)||k.l(T)>0;)I-=C,D=d(I),k=D.j(w);S(D)&&(D=g),j=j.add(D),T=x(T,k)}return new E(j,T)}t.B=function(T){return R(this,T).h},t.and=function(T){const w=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},t.or=function(T){const w=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},t.xor=function(T){const w=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function P(T){const w=T.g.length+1,I=[];for(let C=0;C<w;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function O(T,w){const I=w>>5;w%=32;const C=T.g.length-I,j=[];for(let D=0;D<C;D++)j[D]=w>0?T.i(D+I)>>>w|T.i(D+I+1)<<32-w:T.i(D+I);return new o(j,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,u1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Xr=o}).apply(typeof hv<"u"?hv:typeof self<"u"?self:typeof window<"u"?window:{});var zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var d1,zo,h1,pc,Lf,f1,m1,p1;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof zl=="object"&&zl];for(var f=0;f<c.length;++f){var p=c[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(c,f){if(f)e:{var p=r;c=c.split(".");for(var _=0;_<c.length-1;_++){var M=c[_];if(!(M in p))break e;p=p[M]}c=c[c.length-1],_=p[c],f=f(_),f!=_&&f!=null&&e(p,c,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function u(c,f,p){return c.call.apply(c.bind,arguments)}function d(c,f,p){return d=u,d.apply(null,arguments)}function h(c,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function m(c,f){function p(){}p.prototype=f.prototype,c.Z=f.prototype,c.prototype=new p,c.prototype.constructor=c,c.Ob=function(_,M,V){for(var K=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)K[oe-2]=arguments[oe];return f.prototype[M].apply(_,K)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const f=c.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=c[_];return p}return[]}function S(c,f){for(let _=1;_<arguments.length;_++){const M=arguments[_];var p=typeof M;if(p=p!="object"?p:M?Array.isArray(M)?"array":p:"null",p=="array"||p=="object"&&typeof M.length=="number"){p=c.length||0;const V=M.length||0;c.length=p+V;for(let K=0;K<V;K++)c[p+K]=M[K]}else c.push(M)}}class N{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(c){o.setTimeout(()=>{throw c},0)}function x(){var c=T;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class y{constructor(){this.h=this.g=null}add(f,p){const _=E.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var E=new N(()=>new R,c=>c.reset());class R{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let P,O=!1,T=new y,w=()=>{const c=Promise.resolve(void 0);P=()=>{c.then(I)}};function I(){for(var c;c=x();){try{c.h.call(c.g)}catch(p){b(p)}var f=E;f.j(c),f.h<100&&(f.h++,c.next=f.g,f.g=c)}O=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function H(c,f){j.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,f)}m(H,j),H.prototype.init=function(c,f){const p=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget,f||(p=="mouseover"?f=c.fromElement:p=="mouseout"&&(f=c.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&H.Z.h.call(this)},H.prototype.h=function(){H.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var J="closure_listenable_"+(Math.random()*1e6|0),G=0;function z(c,f,p,_,M){this.listener=c,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=M,this.key=++G,this.da=this.fa=!1}function B(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function F(c,f,p){for(const _ in c)f.call(p,c[_],_,c)}function L(c,f){for(const p in c)f.call(void 0,c[p],p,c)}function q(c){const f={};for(const p in c)f[p]=c[p];return f}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function we(c,f){let p,_;for(let M=1;M<arguments.length;M++){_=arguments[M];for(p in _)c[p]=_[p];for(let V=0;V<ee.length;V++)p=ee[V],Object.prototype.hasOwnProperty.call(_,p)&&(c[p]=_[p])}}function me(c){this.src=c,this.g={},this.h=0}me.prototype.add=function(c,f,p,_,M){const V=c.toString();c=this.g[V],c||(c=this.g[V]=[],this.h++);const K=Pe(c,f,_,M);return K>-1?(f=c[K],p||(f.fa=!1)):(f=new z(f,this.src,V,!!_,M),f.fa=p,c.push(f)),f};function pe(c,f){const p=f.type;if(p in c.g){var _=c.g[p],M=Array.prototype.indexOf.call(_,f,void 0),V;(V=M>=0)&&Array.prototype.splice.call(_,M,1),V&&(B(f),c.g[p].length==0&&(delete c.g[p],c.h--))}}function Pe(c,f,p,_){for(let M=0;M<c.length;++M){const V=c[M];if(!V.da&&V.listener==f&&V.capture==!!p&&V.ha==_)return M}return-1}var ct="closure_lm_"+(Math.random()*1e6|0),tt={};function Hn(c,f,p,_,M){if(Array.isArray(f)){for(let V=0;V<f.length;V++)Hn(c,f[V],p,_,M);return null}return p=Ig(p),c&&c[J]?c.J(f,p,l(_)?!!_.capture:!1,M):ws(c,f,p,!1,_,M)}function ws(c,f,p,_,M,V){if(!f)throw Error("Invalid event type");const K=l(M)?!!M.capture:!!M;let oe=vd(c);if(oe||(c[ct]=oe=new me(c)),p=oe.add(f,p,_,K,V),p.proxy)return p;if(_=gd(),p.proxy=_,_.src=c,_.listener=p,c.addEventListener)D||(M=K),M===void 0&&(M=!1),c.addEventListener(f.toString(),_,M);else if(c.attachEvent)c.attachEvent(Tg(f.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function gd(){function c(p){return f.call(c.src,c.listener,p)}const f=Y2;return c}function Eg(c,f,p,_,M){if(Array.isArray(f))for(var V=0;V<f.length;V++)Eg(c,f[V],p,_,M);else _=l(_)?!!_.capture:!!_,p=Ig(p),c&&c[J]?(c=c.i,V=String(f).toString(),V in c.g&&(f=c.g[V],p=Pe(f,p,_,M),p>-1&&(B(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete c.g[V],c.h--)))):c&&(c=vd(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Pe(f,p,_,M)),(p=c>-1?f[c]:null)&&yd(p))}function yd(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[J])pe(f.i,c);else{var p=c.type,_=c.proxy;f.removeEventListener?f.removeEventListener(p,_,c.capture):f.detachEvent?f.detachEvent(Tg(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=vd(f))?(pe(p,c),p.h==0&&(p.src=null,f[ct]=null)):B(c)}}}function Tg(c){return c in tt?tt[c]:tt[c]="on"+c}function Y2(c,f){if(c.da)c=!0;else{f=new H(f,this);const p=c.listener,_=c.ha||c.src;c.fa&&yd(c),c=p.call(_,f)}return c}function vd(c){return c=c[ct],c instanceof me?c:null}var wd="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ig(c){return typeof c=="function"?c:(c[wd]||(c[wd]=function(f){return c.handleEvent(f)}),c[wd])}function ut(){C.call(this),this.i=new me(this),this.M=this,this.G=null}m(ut,C),ut.prototype[J]=!0,ut.prototype.removeEventListener=function(c,f,p,_){Eg(this,c,f,p,_)};function wt(c,f){var p,_=c.G;if(_)for(p=[];_;_=_.G)p.push(_);if(c=c.M,_=f.type||f,typeof f=="string")f=new j(f,c);else if(f instanceof j)f.target=f.target||c;else{var M=f;f=new j(_,c),we(f,M)}M=!0;let V,K;if(p)for(K=p.length-1;K>=0;K--)V=f.g=p[K],M=hl(V,_,!0,f)&&M;if(V=f.g=c,M=hl(V,_,!0,f)&&M,M=hl(V,_,!1,f)&&M,p)for(K=0;K<p.length;K++)V=f.g=p[K],M=hl(V,_,!1,f)&&M}ut.prototype.N=function(){if(ut.Z.N.call(this),this.i){var c=this.i;for(const f in c.g){const p=c.g[f];for(let _=0;_<p.length;_++)B(p[_]);delete c.g[f],c.h--}}this.G=null},ut.prototype.J=function(c,f,p,_){return this.i.add(String(c),f,!1,p,_)},ut.prototype.K=function(c,f,p,_){return this.i.add(String(c),f,!0,p,_)};function hl(c,f,p,_){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();let M=!0;for(let V=0;V<f.length;++V){const K=f[V];if(K&&!K.da&&K.capture==p){const oe=K.listener,Ge=K.ha||K.src;K.fa&&pe(c.i,K),M=oe.call(Ge,_)!==!1&&M}}return M&&!_.defaultPrevented}function X2(c,f){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(c,f||0)}function Ng(c){c.g=X2(()=>{c.g=null,c.i&&(c.i=!1,Ng(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class J2 extends C{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ng(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function uo(c){C.call(this),this.h=c,this.g={}}m(uo,C);var Sg=[];function kg(c){F(c.g,function(f,p){this.g.hasOwnProperty(p)&&yd(f)},c),c.g={}}uo.prototype.N=function(){uo.Z.N.call(this),kg(this)},uo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xd=o.JSON.stringify,Z2=o.JSON.parse,eT=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Cg(){}function Ag(){}var ho={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function _d(){j.call(this,"d")}m(_d,j);function bd(){j.call(this,"c")}m(bd,j);var xs={},Pg=null;function fl(){return Pg=Pg||new ut}xs.Ia="serverreachability";function Rg(c){j.call(this,xs.Ia,c)}m(Rg,j);function fo(c){const f=fl();wt(f,new Rg(f))}xs.STAT_EVENT="statevent";function jg(c,f){j.call(this,xs.STAT_EVENT,c),this.stat=f}m(jg,j);function xt(c){const f=fl();wt(f,new jg(f,c))}xs.Ja="timingevent";function Dg(c,f){j.call(this,xs.Ja,c),this.size=f}m(Dg,j);function mo(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},f)}function po(){this.g=!0}po.prototype.ua=function(){this.g=!1};function tT(c,f,p,_,M,V){c.info(function(){if(c.g)if(V){var K="",oe=V.split("&");for(let xe=0;xe<oe.length;xe++){var Ge=oe[xe].split("=");if(Ge.length>1){const Xe=Ge[0];Ge=Ge[1];const kn=Xe.split("_");K=kn.length>=2&&kn[1]=="type"?K+(Xe+"="+Ge+"&"):K+(Xe+"=redacted&")}}}else K=null;else K=V;return"XMLHTTP REQ ("+_+") [attempt "+M+"]: "+f+`
`+p+`
`+K})}function nT(c,f,p,_,M,V,K){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+M+"]: "+f+`
`+p+`
`+V+" "+K})}function oi(c,f,p,_){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+sT(c,p)+(_?" "+_:"")})}function rT(c,f){c.info(function(){return"TIMEOUT: "+f})}po.prototype.info=function(){};function sT(c,f){if(!c.g)return f;if(!f)return null;try{const V=JSON.parse(f);if(V){for(c=0;c<V.length;c++)if(Array.isArray(V[c])){var p=V[c];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var M=_[0];if(M!="noop"&&M!="stop"&&M!="close")for(let K=1;K<_.length;K++)_[K]=""}}}}return xd(V)}catch{return f}}var ml={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Lg={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Mg;function Ed(){}m(Ed,Cg),Ed.prototype.g=function(){return new XMLHttpRequest},Mg=new Ed;function go(c){return encodeURIComponent(String(c))}function iT(c){var f=1;c=c.split(":");const p=[];for(;f>0&&c.length;)p.push(c.shift()),f--;return c.length&&p.push(c.join(":")),p}function br(c,f,p,_){this.j=c,this.i=f,this.l=p,this.S=_||1,this.V=new uo(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Og}function Og(){this.i=null,this.g="",this.h=!1}var Vg={},Td={};function Id(c,f,p){c.M=1,c.A=gl(Sn(f)),c.u=p,c.R=!0,Fg(c,null)}function Fg(c,f){c.F=Date.now(),pl(c),c.B=Sn(c.A);var p=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),Jg(p.i,"t",_),c.C=0,p=c.j.L,c.h=new Og,c.g=gy(c.j,p?f:null,!c.u),c.P>0&&(c.O=new J2(d(c.Y,c,c.g),c.P)),f=c.V,p=c.g,_=c.ba;var M="readystatechange";Array.isArray(M)||(M&&(Sg[0]=M.toString()),M=Sg);for(let V=0;V<M.length;V++){const K=Hn(p,M[V],_||f.handleEvent,!1,f.h||f);if(!K)break;f.g[K.key]=K}f=c.J?q(c.J):{},c.u?(c.v||(c.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,f)):(c.v="GET",c.g.ea(c.B,c.v,null,f)),fo(),tT(c.i,c.v,c.B,c.l,c.S,c.u)}br.prototype.ba=function(c){c=c.target;const f=this.O;f&&Ir(c)==3?f.j():this.Y(c)},br.prototype.Y=function(c){try{if(c==this.g)e:{const oe=Ir(this.g),Ge=this.g.ya(),xe=this.g.ca();if(!(oe<3)&&(oe!=3||this.g&&(this.h.h||this.g.la()||iy(this.g)))){this.K||oe!=4||Ge==7||(Ge==8||xe<=0?fo(3):fo(2)),Nd(this);var f=this.g.ca();this.X=f;var p=oT(this);if(this.o=f==200,nT(this.i,this.v,this.B,this.l,this.S,oe,f),this.o){if(this.U&&!this.L){t:{if(this.g){var _,M=this.g;if((_=M.g?M.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var V=_;break t}}V=null}if(c=V)oi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Sd(this,c);else{this.o=!1,this.m=3,xt(12),_s(this),yo(this);break e}}if(this.R){c=!0;let Xe;for(;!this.K&&this.C<p.length;)if(Xe=aT(this,p),Xe==Td){oe==4&&(this.m=4,xt(14),c=!1),oi(this.i,this.l,null,"[Incomplete Response]");break}else if(Xe==Vg){this.m=4,xt(15),oi(this.i,this.l,p,"[Invalid Chunk]"),c=!1;break}else oi(this.i,this.l,Xe,null),Sd(this,Xe);if(Ug(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),oe!=4||p.length!=0||this.h.h||(this.m=1,xt(16),c=!1),this.o=this.o&&c,!c)oi(this.i,this.l,p,"[Invalid Chunked Response]"),_s(this),yo(this);else if(p.length>0&&!this.W){this.W=!0;var K=this.j;K.g==this&&K.aa&&!K.P&&(K.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Ld(K),K.P=!0,xt(11))}}else oi(this.i,this.l,p,null),Sd(this,p);oe==4&&_s(this),this.o&&!this.K&&(oe==4?hy(this.j,this):(this.o=!1,pl(this)))}else _T(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,xt(12)):(this.m=0,xt(13)),_s(this),yo(this)}}}catch{}finally{}};function oT(c){if(!Ug(c))return c.g.la();const f=iy(c.g);if(f==="")return"";let p="";const _=f.length,M=Ir(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return _s(c),yo(c),"";c.h.i=new o.TextDecoder}for(let V=0;V<_;V++)c.h.h=!0,p+=c.h.i.decode(f[V],{stream:!(M&&V==_-1)});return f.length=0,c.h.g+=p,c.C=0,c.h.g}function Ug(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function aT(c,f){var p=c.C,_=f.indexOf(`
`,p);return _==-1?Td:(p=Number(f.substring(p,_)),isNaN(p)?Vg:(_+=1,_+p>f.length?Td:(f=f.slice(_,_+p),c.C=_+p,f)))}br.prototype.cancel=function(){this.K=!0,_s(this)};function pl(c){c.T=Date.now()+c.H,$g(c,c.H)}function $g(c,f){if(c.D!=null)throw Error("WatchDog timer not null");c.D=mo(d(c.aa,c),f)}function Nd(c){c.D&&(o.clearTimeout(c.D),c.D=null)}br.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(rT(this.i,this.B),this.M!=2&&(fo(),xt(17)),_s(this),this.m=2,yo(this)):$g(this,this.T-c)};function yo(c){c.j.I==0||c.K||hy(c.j,c)}function _s(c){Nd(c);var f=c.O;f&&typeof f.dispose=="function"&&f.dispose(),c.O=null,kg(c.V),c.g&&(f=c.g,c.g=null,f.abort(),f.dispose())}function Sd(c,f){try{var p=c.j;if(p.I!=0&&(p.g==c||kd(p.h,c))){if(!c.L&&kd(p.h,c)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var M=_;if(M[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<c.F)_l(p),wl(p);else break e;Dd(p),xt(18)}}else p.xa=M[1],0<p.xa-p.K&&M[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=mo(d(p.Va,p),6e3));qg(p.h)<=1&&p.ta&&(p.ta=void 0)}else Es(p,11)}else if((c.L||p.g==c)&&_l(p),!k(f))for(M=p.Ba.g.parse(f),f=0;f<M.length;f++){let xe=M[f];const Xe=xe[0];if(!(Xe<=p.K))if(p.K=Xe,xe=xe[1],p.I==2)if(xe[0]=="c"){p.M=xe[1],p.ba=xe[2];const kn=xe[3];kn!=null&&(p.ka=kn,p.j.info("VER="+p.ka));const Ts=xe[4];Ts!=null&&(p.za=Ts,p.j.info("SVER="+p.za));const Nr=xe[5];Nr!=null&&typeof Nr=="number"&&Nr>0&&(_=1.5*Nr,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const Sr=c.g;if(Sr){const El=Sr.g?Sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(El){var V=_.h;V.g||El.indexOf("spdy")==-1&&El.indexOf("quic")==-1&&El.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Cd(V,V.h),V.h=null))}if(_.G){const Md=Sr.g?Sr.g.getResponseHeader("X-HTTP-Session-Id"):null;Md&&(_.wa=Md,Ee(_.J,_.G,Md))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-c.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var K=c;if(_.na=py(_,_.L?_.ba:null,_.W),K.L){Hg(_.h,K);var oe=K,Ge=_.O;Ge&&(oe.H=Ge),oe.D&&(Nd(oe),pl(oe)),_.g=K}else uy(_);p.i.length>0&&xl(p)}else xe[0]!="stop"&&xe[0]!="close"||Es(p,7);else p.I==3&&(xe[0]=="stop"||xe[0]=="close"?xe[0]=="stop"?Es(p,7):jd(p):xe[0]!="noop"&&p.l&&p.l.qa(xe),p.A=0)}}fo(4)}catch{}}var lT=class{constructor(c,f){this.g=c,this.map=f}};function Bg(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zg(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function qg(c){return c.h?1:c.g?c.g.size:0}function kd(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Cd(c,f){c.g?c.g.add(f):c.h=f}function Hg(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}Bg.prototype.cancel=function(){if(this.i=Wg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Wg(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const p of c.g.values())f=f.concat(p.G);return f}return v(c.i)}var Gg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cT(c,f){if(c){c=c.split("&");for(let p=0;p<c.length;p++){const _=c[p].indexOf("=");let M,V=null;_>=0?(M=c[p].substring(0,_),V=c[p].substring(_+1)):M=c[p],f(M,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Er(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;c instanceof Er?(this.l=c.l,vo(this,c.j),this.o=c.o,this.g=c.g,wo(this,c.u),this.h=c.h,Ad(this,Zg(c.i)),this.m=c.m):c&&(f=String(c).match(Gg))?(this.l=!1,vo(this,f[1]||"",!0),this.o=xo(f[2]||""),this.g=xo(f[3]||"",!0),wo(this,f[4]),this.h=xo(f[5]||"",!0),Ad(this,f[6]||"",!0),this.m=xo(f[7]||"")):(this.l=!1,this.i=new bo(null,this.l))}Er.prototype.toString=function(){const c=[];var f=this.j;f&&c.push(_o(f,Kg,!0),":");var p=this.g;return(p||f=="file")&&(c.push("//"),(f=this.o)&&c.push(_o(f,Kg,!0),"@"),c.push(go(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&c.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(_o(p,p.charAt(0)=="/"?hT:dT,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",_o(p,mT)),c.join("")},Er.prototype.resolve=function(c){const f=Sn(this);let p=!!c.j;p?vo(f,c.j):p=!!c.o,p?f.o=c.o:p=!!c.g,p?f.g=c.g:p=c.u!=null;var _=c.h;if(p)wo(f,c.u);else if(p=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var M=f.h.lastIndexOf("/");M!=-1&&(_=f.h.slice(0,M+1)+_)}if(M=_,M==".."||M==".")_="";else if(M.indexOf("./")!=-1||M.indexOf("/.")!=-1){_=M.lastIndexOf("/",0)==0,M=M.split("/");const V=[];for(let K=0;K<M.length;){const oe=M[K++];oe=="."?_&&K==M.length&&V.push(""):oe==".."?((V.length>1||V.length==1&&V[0]!="")&&V.pop(),_&&K==M.length&&V.push("")):(V.push(oe),_=!0)}_=V.join("/")}else _=M}return p?f.h=_:p=c.i.toString()!=="",p?Ad(f,Zg(c.i)):p=!!c.m,p&&(f.m=c.m),f};function Sn(c){return new Er(c)}function vo(c,f,p){c.j=p?xo(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function wo(c,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);c.u=f}else c.u=null}function Ad(c,f,p){f instanceof bo?(c.i=f,pT(c.i,c.l)):(p||(f=_o(f,fT)),c.i=new bo(f,c.l))}function Ee(c,f,p){c.i.set(f,p)}function gl(c){return Ee(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function xo(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function _o(c,f,p){return typeof c=="string"?(c=encodeURI(c).replace(f,uT),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function uT(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Kg=/[#\/\?@]/g,dT=/[#\?:]/g,hT=/[#\?]/g,fT=/[#\?@]/g,mT=/#/g;function bo(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function bs(c){c.g||(c.g=new Map,c.h=0,c.i&&cT(c.i,function(f,p){c.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}t=bo.prototype,t.add=function(c,f){bs(this),this.i=null,c=ai(this,c);let p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(f),this.h+=1,this};function Qg(c,f){bs(c),f=ai(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Yg(c,f){return bs(c),f=ai(c,f),c.g.has(f)}t.forEach=function(c,f){bs(this),this.g.forEach(function(p,_){p.forEach(function(M){c.call(f,M,_,this)},this)},this)};function Xg(c,f){bs(c);let p=[];if(typeof f=="string")Yg(c,f)&&(p=p.concat(c.g.get(ai(c,f))));else for(c=Array.from(c.g.values()),f=0;f<c.length;f++)p=p.concat(c[f]);return p}t.set=function(c,f){return bs(this),this.i=null,c=ai(this,c),Yg(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=Xg(this,c),c.length>0?String(c[0]):f):f};function Jg(c,f,p){Qg(c,f),p.length>0&&(c.i=null,c.g.set(ai(c,f),v(p)),c.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const M=go(p);p=Xg(this,p);for(let V=0;V<p.length;V++){let K=M;p[V]!==""&&(K+="="+go(p[V])),c.push(K)}}return this.i=c.join("&")};function Zg(c){const f=new bo;return f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),f}function ai(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function pT(c,f){f&&!c.j&&(bs(c),c.i=null,c.g.forEach(function(p,_){const M=_.toLowerCase();_!=M&&(Qg(this,_),Jg(this,M,p))},c)),c.j=f}function gT(c,f){const p=new po;if(o.Image){const _=new Image;_.onload=h(Tr,p,"TestLoadImage: loaded",!0,f,_),_.onerror=h(Tr,p,"TestLoadImage: error",!1,f,_),_.onabort=h(Tr,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=h(Tr,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else f(!1)}function yT(c,f){const p=new po,_=new AbortController,M=setTimeout(()=>{_.abort(),Tr(p,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:_.signal}).then(V=>{clearTimeout(M),V.ok?Tr(p,"TestPingServer: ok",!0,f):Tr(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(M),Tr(p,"TestPingServer: error",!1,f)})}function Tr(c,f,p,_,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),_(p)}catch{}}function vT(){this.g=new eT}function Pd(c){this.i=c.Sb||null,this.h=c.ab||!1}m(Pd,Cg),Pd.prototype.g=function(){return new yl(this.i,this.h)};function yl(c,f){ut.call(this),this.H=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(yl,ut),t=yl.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=f,this.readyState=1,To(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(f.body=c),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Eo(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,To(this)),this.g&&(this.readyState=3,To(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ey(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function ey(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Eo(this):To(this),this.readyState==3&&ey(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Eo(this))},t.Na=function(c){this.g&&(this.response=c,Eo(this))},t.ga=function(){this.g&&Eo(this)};function Eo(c){c.readyState=4,c.l=null,c.j=null,c.B=null,To(c)}t.setRequestHeader=function(c,f){this.A.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=f.next();return c.join(`\r
`)};function To(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(yl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ty(c){let f="";return F(c,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function Rd(c,f,p){e:{for(_ in p){var _=!1;break e}_=!0}_||(p=ty(p),typeof c=="string"?p!=null&&go(p):Ee(c,f,p))}function Ve(c){ut.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Ve,ut);var wT=/^https?$/i,xT=["POST","PUT"];t=Ve.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Mg.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(V){ny(this,V);return}if(c=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var M in _)p.set(M,_[M]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const V of _.keys())p.set(V,_.get(V));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(V=>V.toLowerCase()=="content-type"),M=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(xT,f,void 0)>=0)||_||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,K]of p)this.g.setRequestHeader(V,K);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(V){ny(this,V)}};function ny(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.o=5,ry(c),vl(c)}function ry(c){c.A||(c.A=!0,wt(c,"complete"),wt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,wt(this,"complete"),wt(this,"abort"),vl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vl(this,!0)),Ve.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?sy(this):this.Xa())},t.Xa=function(){sy(this)};function sy(c){if(c.h&&typeof i<"u"){if(c.v&&Ir(c)==4)setTimeout(c.Ca.bind(c),0);else if(wt(c,"readystatechange"),Ir(c)==4){c.h=!1;try{const V=c.ca();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var _;if(_=V===0){let K=String(c.D).match(Gg)[1]||null;!K&&o.self&&o.self.location&&(K=o.self.location.protocol.slice(0,-1)),_=!wT.test(K?K.toLowerCase():"")}p=_}if(p)wt(c,"complete"),wt(c,"success");else{c.o=6;try{var M=Ir(c)>2?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.ca()+"]",ry(c)}}finally{vl(c)}}}}function vl(c,f){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const p=c.g;c.g=null,f||wt(c,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ir(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Ir(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Z2(f)}};function iy(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function _T(c){const f={};c=(c.g&&Ir(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var p=iT(c[_]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const V=f[M]||[];f[M]=V,V.push(p)}L(f,function(_){return _.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Io(c,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||f}function oy(c){this.za=0,this.i=[],this.j=new po,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Io("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Io("baseRetryDelayMs",5e3,c),this.Za=Io("retryDelaySeedMs",1e4,c),this.Ta=Io("forwardChannelMaxRetries",2,c),this.va=Io("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Bg(c&&c.concurrentRequestLimit),this.Ba=new vT,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=oy.prototype,t.ka=8,t.I=1,t.connect=function(c,f,p,_){xt(0),this.W=c,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=py(this,null,this.W),xl(this)};function jd(c){if(ay(c),c.I==3){var f=c.V++,p=Sn(c.J);if(Ee(p,"SID",c.M),Ee(p,"RID",f),Ee(p,"TYPE","terminate"),No(c,p),f=new br(c,c.j,f),f.M=2,f.A=gl(Sn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=gy(f.j,null),f.g.ea(f.A)),f.F=Date.now(),pl(f)}my(c)}function wl(c){c.g&&(Ld(c),c.g.cancel(),c.g=null)}function ay(c){wl(c),c.v&&(o.clearTimeout(c.v),c.v=null),_l(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function xl(c){if(!zg(c.h)&&!c.m){c.m=!0;var f=c.Ea;P||w(),O||(P(),O=!0),T.add(f,c),c.D=0}}function bT(c,f){return qg(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=f.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=mo(d(c.Ea,c,f),fy(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const M=new br(this,this.j,c);let V=this.o;if(this.U&&(V?(V=q(V),we(V,this.U)):V=this.U),this.u!==null||this.R||(M.J=V,V=null),this.S)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=cy(this,M,f),p=Sn(this.J),Ee(p,"RID",c),Ee(p,"CVER",22),this.G&&Ee(p,"X-HTTP-Session-Id",this.G),No(this,p),V&&(this.R?f="headers="+go(ty(V))+"&"+f:this.u&&Rd(p,this.u,V)),Cd(this.h,M),this.Ra&&Ee(p,"TYPE","init"),this.S?(Ee(p,"$req",f),Ee(p,"SID","null"),M.U=!0,Id(M,p,null)):Id(M,p,f),this.I=2}}else this.I==3&&(c?ly(this,c):this.i.length==0||zg(this.h)||ly(this))};function ly(c,f){var p;f?p=f.l:p=c.V++;const _=Sn(c.J);Ee(_,"SID",c.M),Ee(_,"RID",p),Ee(_,"AID",c.K),No(c,_),c.u&&c.o&&Rd(_,c.u,c.o),p=new br(c,c.j,p,c.D+1),c.u===null&&(p.J=c.o),f&&(c.i=f.G.concat(c.i)),f=cy(c,p,1e3),p.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Cd(c.h,p),Id(p,_,f)}function No(c,f){c.H&&F(c.H,function(p,_){Ee(f,_,p)}),c.l&&F({},function(p,_){Ee(f,_,p)})}function cy(c,f,p){p=Math.min(c.i.length,p);const _=c.l?d(c.l.Ka,c.l,c):null;e:{var M=c.i;let oe=-1;for(;;){const Ge=["count="+p];oe==-1?p>0?(oe=M[0].g,Ge.push("ofs="+oe)):oe=0:Ge.push("ofs="+oe);let xe=!0;for(let Xe=0;Xe<p;Xe++){var V=M[Xe].g;const kn=M[Xe].map;if(V-=oe,V<0)oe=Math.max(0,M[Xe].g-100),xe=!1;else try{V="req"+V+"_"||"";try{var K=kn instanceof Map?kn:Object.entries(kn);for(const[Ts,Nr]of K){let Sr=Nr;l(Nr)&&(Sr=xd(Nr)),Ge.push(V+Ts+"="+encodeURIComponent(Sr))}}catch(Ts){throw Ge.push(V+"type="+encodeURIComponent("_badmap")),Ts}}catch{_&&_(kn)}}if(xe){K=Ge.join("&");break e}}K=void 0}return c=c.i.splice(0,p),f.G=c,K}function uy(c){if(!c.g&&!c.v){c.Y=1;var f=c.Da;P||w(),O||(P(),O=!0),T.add(f,c),c.A=0}}function Dd(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=mo(d(c.Da,c),fy(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,dy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=mo(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xt(10),wl(this),dy(this))};function Ld(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function dy(c){c.g=new br(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var f=Sn(c.na);Ee(f,"RID","rpc"),Ee(f,"SID",c.M),Ee(f,"AID",c.K),Ee(f,"CI",c.F?"0":"1"),!c.F&&c.ia&&Ee(f,"TO",c.ia),Ee(f,"TYPE","xmlhttp"),No(c,f),c.u&&c.o&&Rd(f,c.u,c.o),c.O&&(c.g.H=c.O);var p=c.g;c=c.ba,p.M=1,p.A=gl(Sn(f)),p.u=null,p.R=!0,Fg(p,c)}t.Va=function(){this.C!=null&&(this.C=null,wl(this),Dd(this),xt(19))};function _l(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function hy(c,f){var p=null;if(c.g==f){_l(c),Ld(c),c.g=null;var _=2}else if(kd(c.h,f))p=f.G,Hg(c.h,f),_=1;else return;if(c.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var M=c.D;_=fl(),wt(_,new Dg(_,p)),xl(c)}else uy(c);else if(M=f.m,M==3||M==0&&f.X>0||!(_==1&&bT(c,f)||_==2&&Dd(c)))switch(p&&p.length>0&&(f=c.h,f.i=f.i.concat(p)),M){case 1:Es(c,5);break;case 4:Es(c,10);break;case 3:Es(c,6);break;default:Es(c,2)}}}function fy(c,f){let p=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(p*=2),p*f}function Es(c,f){if(c.j.info("Error code "+f),f==2){var p=d(c.bb,c),_=c.Ua;const M=!_;_=new Er(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||vo(_,"https"),gl(_),M?gT(_.toString(),p):yT(_.toString(),p)}else xt(2);c.I=0,c.l&&c.l.pa(f),my(c),ay(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function my(c){if(c.I=0,c.ja=[],c.l){const f=Wg(c.h);(f.length!=0||c.i.length!=0)&&(S(c.ja,f),S(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function py(c,f,p){var _=p instanceof Er?Sn(p):new Er(p);if(_.g!="")f&&(_.g=f+"."+_.g),wo(_,_.u);else{var M=o.location;_=M.protocol,f=f?f+"."+M.hostname:M.hostname,M=+M.port;const V=new Er(null);_&&vo(V,_),f&&(V.g=f),M&&wo(V,M),p&&(V.h=p),_=V}return p=c.G,f=c.wa,p&&f&&Ee(_,p,f),Ee(_,"VER",c.ka),No(c,_),_}function gy(c,f,p){if(f&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Aa&&!c.ma?new Ve(new Pd({ab:p})):new Ve(c.ma),f.Fa(c.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yy(){}t=yy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function bl(){}bl.prototype.g=function(c,f){return new Ut(c,f)};function Ut(c,f){ut.call(this),this.g=new oy(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(c?c["X-WebChannel-Client-Profile"]=f.sa:c={"X-WebChannel-Client-Profile":f.sa}),this.g.U=c,(c=f&&f.Qb)&&!k(c)&&(this.g.u=c),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!k(f)&&(this.g.G=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new li(this)}m(Ut,ut),Ut.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ut.prototype.close=function(){jd(this.g)},Ut.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.v&&(p={},p.__data__=xd(c),c=p);f.i.push(new lT(f.Ya++,c)),f.I==3&&xl(f)},Ut.prototype.N=function(){this.g.l=null,delete this.j,jd(this.g),delete this.g,Ut.Z.N.call(this)};function vy(c){_d.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const p in f){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}m(vy,_d);function wy(){bd.call(this),this.status=1}m(wy,bd);function li(c){this.g=c}m(li,yy),li.prototype.ra=function(){wt(this.g,"a")},li.prototype.qa=function(c){wt(this.g,new vy(c))},li.prototype.pa=function(c){wt(this.g,new wy)},li.prototype.oa=function(){wt(this.g,"b")},bl.prototype.createWebChannel=bl.prototype.g,Ut.prototype.send=Ut.prototype.o,Ut.prototype.open=Ut.prototype.m,Ut.prototype.close=Ut.prototype.close,p1=function(){return new bl},m1=function(){return fl()},f1=xs,Lf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ml.NO_ERROR=0,ml.TIMEOUT=8,ml.HTTP_ERROR=6,pc=ml,Lg.COMPLETE="complete",h1=Lg,Ag.EventType=ho,ho.OPEN="a",ho.CLOSE="b",ho.ERROR="c",ho.MESSAGE="d",ut.prototype.listen=ut.prototype.J,zo=Ag,Ve.prototype.listenOnce=Ve.prototype.K,Ve.prototype.getLastError=Ve.prototype.Ha,Ve.prototype.getLastErrorCode=Ve.prototype.ya,Ve.prototype.getStatus=Ve.prototype.ca,Ve.prototype.getResponseJson=Ve.prototype.La,Ve.prototype.getResponseText=Ve.prototype.la,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Fa,d1=Ve}).apply(typeof zl<"u"?zl:typeof self<"u"?self:typeof window<"u"?window:{});const fv="@firebase/firestore",mv="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let so="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new Vu("@firebase/firestore");function di(){return Gs.logLevel}function Y(t,...e){if(Gs.logLevel<=le.DEBUG){const n=e.map(_p);Gs.debug(`Firestore (${so}): ${t}`,...n)}}function mr(t,...e){if(Gs.logLevel<=le.ERROR){const n=e.map(_p);Gs.error(`Firestore (${so}): ${t}`,...n)}}function Wi(t,...e){if(Gs.logLevel<=le.WARN){const n=e.map(_p);Gs.warn(`Firestore (${so}): ${t}`,...n)}}function _p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,g1(t,r,n)}function g1(t,e,n){let r=`FIRESTORE (${so}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw mr(r),new Error(r)}function ge(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||g1(e,s,r)}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends un{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(mt.UNAUTHENTICATED))}shutdown(){}}class kR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class CR{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ge(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new rr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new rr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string",31837,{l:r}),new y1(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string",2055,{h:e}),new mt(e)}}class AR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class PR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new AR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ge(this.o===void 0,3512);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new pv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ge(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new pv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=jR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function ce(t,e){return t<e?-1:t>e?1:0}function Mf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return vh(s)===vh(i)?ce(s,i):vh(s)?1:-1}return ce(t.length,e.length)}const DR=55296,LR=57343;function vh(t){const e=t.charCodeAt(0);return e>=DR&&e<=LR}function Gi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="__name__";class Pn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ne(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ne(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Pn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return ce(e.length,n.length)}static compareSegments(e,n){const r=Pn.isNumericId(e),s=Pn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Pn.extractNumericId(e).compare(Pn.extractNumericId(n)):Mf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xr.fromString(e.substring(4,e.length-2))}}class _e extends Pn{construct(e,n,r){return new _e(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new _e(n)}static emptyPath(){return new _e([])}}const MR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends Pn{construct(e,n,r){return new st(e,n,r)}static isValidIdentifier(e){return MR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gv}static keyField(){return new st([gv])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Q(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Q(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Q(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(n)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(_e.fromString(e))}static fromName(e){return new Z(_e.fromString(e).popFirst(5))}static empty(){return new Z(_e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return _e.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new _e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(t,e,n){if(!n)throw new Q(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function OR(t,e,n,r){if(e===!0&&r===!0)throw new Q(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function yv(t){if(!Z.isDocumentKey(t))throw new Q(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vv(t){if(Z.isDocumentKey(t))throw new Q(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function w1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Bu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ne(12329,{type:typeof t})}function Vt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bu(t);throw new Q(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function VR(t,e){if(e<=0)throw new Q(U.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t,e){const n={typeString:t};return e&&(n.value=e),n}function il(t,e){if(!w1(t))throw new Q(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=-62135596800,xv=1e6;class Ie{static now(){return Ie.fromMillis(Date.now())}static fromDate(e){return Ie.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*xv);return new Ie(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<wv)throw new Q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xv}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ie._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(il(e,Ie._jsonSchema))return new Ie(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ie._jsonSchemaVersion="firestore/timestamp/1.0",Ie._jsonSchema={type:We("string",Ie._jsonSchemaVersion),seconds:We("number"),nanoseconds:We("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{static fromTimestamp(e){return new se(e)}static min(){return new se(new Ie(0,0))}static max(){return new se(new Ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=-1;function FR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=se.fromTimestamp(r===1e9?new Ie(n+1,0):new Ie(n,r));return new rs(s,Z.empty(),e)}function UR(t){return new rs(t.readTime,t.key,Ra)}class rs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new rs(se.min(),Z.empty(),Ra)}static max(){return new rs(se.max(),Z.empty(),Ra)}}function $R(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==BR)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function qR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function oo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep=-1;function qu(t){return t==null}function tu(t){return t===0&&1/t==-1/0}function HR(t){return typeof t=="number"&&Number.isInteger(t)&&!tu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="";function WR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=_v(e)),e=GR(t.get(n),e);return _v(e)}function GR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case x1:n+="";break;default:n+=i}}return n}function _v(t){return t+x1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ps(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e,n){this.comparator=e,this.root=n||rt.EMPTY}insert(e,n){return new Me(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(e){return new Me(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ql(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ql(this.root,e,this.comparator,!1)}getReverseIterator(){return new ql(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ql(this.root,e,this.comparator,!0)}}class ql{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??rt.RED,this.left=s??rt.EMPTY,this.right=i??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ne(27949);return e+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ne(57766)}get value(){throw ne(16141)}get color(){throw ne(16727)}get left(){throw ne(29726)}get right(){throw ne(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.comparator=e,this.data=new Me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ev(this.data.getIterator())}getIteratorFrom(e){return new Ev(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ye)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ye(this.comparator);return n.data=e,n}}class Ev{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new Ht([])}unionWith(e){let n=new Ye(st.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ht(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new b1("Invalid base64 string: "+i):i}}(e);return new at(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new at(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const KR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ss(t){if(ge(!!t,39018),typeof t=="string"){let e=0;const n=KR.exec(t);if(ge(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function is(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="server_timestamp",T1="__type__",I1="__previous_value__",N1="__local_write_time__";function Tp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[T1])==null?void 0:r.stringValue)===E1}function Hu(t){const e=t.mapValue.fields[I1];return Tp(e)?Hu(e):e}function ja(t){const e=ss(t.mapValue.fields[N1].timestampValue);return new Ie(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,n,r,s,i,o,l,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const nu="(default)";class Da{constructor(e,n){this.projectId=e,this.database=n||nu}static empty(){return new Da("","")}get isDefaultDatabase(){return this.database===nu}isEqual(e){return e instanceof Da&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="__type__",YR="__max__",Hl={mapValue:{}},k1="__vector__",ru="value";function os(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tp(t)?4:JR(t)?9007199254740991:XR(t)?10:11:ne(28295,{value:t})}function Bn(t,e){if(t===e)return!0;const n=os(t);if(n!==os(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ja(t).isEqual(ja(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ss(s.timestampValue),l=ss(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return is(s.bytesValue).isEqual(is(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return $e(s.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(s.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $e(s.integerValue)===$e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$e(s.doubleValue),l=$e(i.doubleValue);return o===l?tu(o)===tu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Gi(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(bv(o)!==bv(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Bn(o[u],l[u])))return!1;return!0}(t,e);default:return ne(52216,{left:t})}}function La(t,e){return(t.values||[]).find(n=>Bn(n,e))!==void 0}function Ki(t,e){if(t===e)return 0;const n=os(t),r=os(e);if(n!==r)return ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=$e(i.integerValue||i.doubleValue),u=$e(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Tv(t.timestampValue,e.timestampValue);case 4:return Tv(ja(t),ja(e));case 5:return Mf(t.stringValue,e.stringValue);case 6:return function(i,o){const l=is(i),u=is(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=ce(l[d],u[d]);if(h!==0)return h}return ce(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ce($e(i.latitude),$e(o.latitude));return l!==0?l:ce($e(i.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Iv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,v,S,N;const l=i.fields||{},u=o.fields||{},d=(g=l[ru])==null?void 0:g.arrayValue,h=(v=u[ru])==null?void 0:v.arrayValue,m=ce(((S=d==null?void 0:d.values)==null?void 0:S.length)||0,((N=h==null?void 0:h.values)==null?void 0:N.length)||0);return m!==0?m:Iv(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Hl.mapValue&&o===Hl.mapValue)return 0;if(i===Hl.mapValue)return 1;if(o===Hl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let m=0;m<u.length&&m<h.length;++m){const g=Mf(u[m],h[m]);if(g!==0)return g;const v=Ki(l[u[m]],d[h[m]]);if(v!==0)return v}return ce(u.length,h.length)}(t.mapValue,e.mapValue);default:throw ne(23264,{he:n})}}function Tv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);const n=ss(t),r=ss(e),s=ce(n.seconds,r.seconds);return s!==0?s:ce(n.nanos,r.nanos)}function Iv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ki(n[s],r[s]);if(i)return i}return ce(n.length,r.length)}function Qi(t){return Of(t)}function Of(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ss(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return is(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Of(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Of(n.fields[o])}`;return s+"}"}(t.mapValue):ne(61005,{value:t})}function gc(t){switch(os(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hu(t);return e?16+gc(e):16;case 5:return 2*t.stringValue.length;case 6:return is(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+gc(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ps(r.fields,(i,o)=>{s+=i.length+gc(o)}),s}(t.mapValue);default:throw ne(13486,{value:t})}}function Nv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vf(t){return!!t&&"integerValue"in t}function Ip(t){return!!t&&"arrayValue"in t}function Sv(t){return!!t&&"nullValue"in t}function kv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yc(t){return!!t&&"mapValue"in t}function XR(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[S1])==null?void 0:r.stringValue)===k1}function ia(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ps(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ia(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ia(t.arrayValue.values[n]);return e}return{...t}}function JR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===YR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.value=e}static empty(){return new Rt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!yc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ia(n)}setAll(e){let n=st.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ia(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());yc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];yc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ps(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Rt(ia(this.value))}}function C1(t){const e=[];return ps(t.fields,(n,r)=>{const s=new st([n]);if(yc(r)){const i=C1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ht(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new gt(e,0,se.min(),se.min(),se.min(),Rt.empty(),0)}static newFoundDocument(e,n,r,s){return new gt(e,1,n,se.min(),r,s,0)}static newNoDocument(e,n){return new gt(e,2,n,se.min(),se.min(),Rt.empty(),0)}static newUnknownDocument(e,n){return new gt(e,3,n,se.min(),se.min(),Rt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n){this.position=e,this.inclusive=n}}function Cv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),n.key):r=Ki(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Av(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n="asc"){this.field=e,this.dir=n}}function ZR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{}class He extends A1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new tj(e,n,r):n==="array-contains"?new sj(e,r):n==="in"?new ij(e,r):n==="not-in"?new oj(e,r):n==="array-contains-any"?new aj(e,r):new He(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new nj(e,r):new rj(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ki(n,this.value)):n!==null&&os(this.value)===os(n)&&this.matchesComparison(Ki(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bn extends A1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new bn(e,n)}matches(e){return P1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function P1(t){return t.op==="and"}function R1(t){return ej(t)&&P1(t)}function ej(t){for(const e of t.filters)if(e instanceof bn)return!1;return!0}function Ff(t){if(t instanceof He)return t.field.canonicalString()+t.op.toString()+Qi(t.value);if(R1(t))return t.filters.map(e=>Ff(e)).join(",");{const e=t.filters.map(n=>Ff(n)).join(",");return`${t.op}(${e})`}}function j1(t,e){return t instanceof He?function(r,s){return s instanceof He&&r.op===s.op&&r.field.isEqual(s.field)&&Bn(r.value,s.value)}(t,e):t instanceof bn?function(r,s){return s instanceof bn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&j1(o,s.filters[l]),!0):!1}(t,e):void ne(19439)}function D1(t){return t instanceof He?function(n){return`${n.field.canonicalString()} ${n.op} ${Qi(n.value)}`}(t):t instanceof bn?function(n){return n.op.toString()+" {"+n.getFilters().map(D1).join(" ,")+"}"}(t):"Filter"}class tj extends He{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class nj extends He{constructor(e,n){super(e,"in",n),this.keys=L1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rj extends He{constructor(e,n){super(e,"not-in",n),this.keys=L1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function L1(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class sj extends He{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ip(n)&&La(n.arrayValue,this.value)}}class ij extends He{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&La(this.value.arrayValue,n)}}class oj extends He{constructor(e,n){super(e,"not-in",n)}matches(e){if(La(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!La(this.value.arrayValue,n)}}class aj extends He{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ip(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>La(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function Pv(t,e=null,n=[],r=[],s=null,i=null,o=null){return new lj(t,e,n,r,s,i,o)}function Np(t){const e=ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ff(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),qu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Qi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Qi(r)).join(",")),e.Te=n}return e.Te}function Sp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ZR(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!j1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Av(t.startAt,e.startAt)&&Av(t.endAt,e.endAt)}function Uf(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function cj(t,e,n,r,s,i,o,l){return new ao(t,e,n,r,s,i,o,l)}function Wu(t){return new ao(t)}function Rv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function M1(t){return t.collectionGroup!==null}function oa(t){const e=ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ye(st.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ma(i,r))}),n.has(st.keyField().canonicalString())||e.Ie.push(new Ma(st.keyField(),r))}return e.Ie}function Vn(t){const e=ie(t);return e.Ee||(e.Ee=uj(e,oa(t))),e.Ee}function uj(t,e){if(t.limitType==="F")return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ma(s.field,i)});const n=t.endAt?new su(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new su(t.startAt.position,t.startAt.inclusive):null;return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $f(t,e){const n=t.filters.concat([e]);return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function iu(t,e,n){return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gu(t,e){return Sp(Vn(t),Vn(e))&&t.limitType===e.limitType}function O1(t){return`${Np(Vn(t))}|lt:${t.limitType}`}function hi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>D1(s)).join(", ")}]`),qu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Qi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Qi(s)).join(",")),`Target(${r})`}(Vn(t))}; limitType=${t.limitType})`}function Ku(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of oa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=Cv(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,oa(r),s)||r.endAt&&!function(o,l,u){const d=Cv(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,oa(r),s))}(t,e)}function dj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V1(t){return(e,n)=>{let r=!1;for(const s of oa(t)){const i=hj(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function hj(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?Ki(u,d):ne(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ne(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ps(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return _1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=new Me(Z.comparator);function pr(){return fj}const F1=new Me(Z.comparator);function qo(...t){let e=F1;for(const n of t)e=e.insert(n.key,n);return e}function U1(t){let e=F1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Rs(){return aa()}function $1(){return aa()}function aa(){return new ni(t=>t.toString(),(t,e)=>t.isEqual(e))}const mj=new Me(Z.comparator),pj=new Ye(Z.comparator);function ue(...t){let e=pj;for(const n of t)e=e.add(n);return e}const gj=new Ye(ce);function yj(){return gj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tu(e)?"-0":e}}function B1(t){return{integerValue:""+t}}function vj(t,e){return HR(e)?B1(e):kp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(){this._=void 0}}function wj(t,e,n){return t instanceof Oa?function(s,i){const o={fields:{[T1]:{stringValue:E1},[N1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Tp(i)&&(i=Hu(i)),i&&(o.fields[I1]=i),{mapValue:o}}(n,e):t instanceof Va?q1(t,e):t instanceof Fa?H1(t,e):function(s,i){const o=z1(s,i),l=jv(o)+jv(s.Ae);return Vf(o)&&Vf(s.Ae)?B1(l):kp(s.serializer,l)}(t,e)}function xj(t,e,n){return t instanceof Va?q1(t,e):t instanceof Fa?H1(t,e):n}function z1(t,e){return t instanceof ou?function(r){return Vf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Oa extends Qu{}class Va extends Qu{constructor(e){super(),this.elements=e}}function q1(t,e){const n=W1(e);for(const r of t.elements)n.some(s=>Bn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Fa extends Qu{constructor(e){super(),this.elements=e}}function H1(t,e){let n=W1(e);for(const r of t.elements)n=n.filter(s=>!Bn(s,r));return{arrayValue:{values:n}}}class ou extends Qu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function jv(t){return $e(t.integerValue||t.doubleValue)}function W1(t){return Ip(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n){this.field=e,this.transform=n}}function bj(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Va&&s instanceof Va||r instanceof Fa&&s instanceof Fa?Gi(r.elements,s.elements,Bn):r instanceof ou&&s instanceof ou?Bn(r.Ae,s.Ae):r instanceof Oa&&s instanceof Oa}(t.transform,e.transform)}class Ej{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yu{}function G1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Cp(t.key,sn.none()):new ol(t.key,t.data,sn.none());{const n=t.data,r=Rt.empty();let s=new Ye(st.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new gs(t.key,r,new Ht(s.toArray()),sn.none())}}function Tj(t,e,n){t instanceof ol?function(s,i,o){const l=s.value.clone(),u=Lv(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof gs?function(s,i,o){if(!vc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Lv(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(K1(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function la(t,e,n,r){return t instanceof ol?function(i,o,l,u){if(!vc(i.precondition,o))return l;const d=i.value.clone(),h=Mv(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof gs?function(i,o,l,u){if(!vc(i.precondition,o))return l;const d=Mv(i.fieldTransforms,u,o),h=o.data;return h.setAll(K1(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return vc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function Ij(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=z1(r.transform,s||null);i!=null&&(n===null&&(n=Rt.empty()),n.set(r.field,i))}return n||null}function Dv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Gi(r,s,(i,o)=>bj(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ol extends Yu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class gs extends Yu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function K1(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Lv(t,e,n){const r=new Map;ge(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,xj(o,l,n[s]))}return r}function Mv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,wj(i,o,e))}return r}class Cp extends Yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Nj extends Yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Tj(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=la(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=la(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=$1();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=G1(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(n,r)=>Dv(n,r))&&Gi(this.baseMutations,e.baseMutations,(n,r)=>Dv(n,r))}}class Ap{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ge(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return mj}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ap(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,de;function Aj(t){switch(t){case U.OK:return ne(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ne(15467,{code:t})}}function Q1(t){if(t===void 0)return mr("GRPC error has no .code"),U.UNKNOWN;switch(t){case ze.OK:return U.OK;case ze.CANCELLED:return U.CANCELLED;case ze.UNKNOWN:return U.UNKNOWN;case ze.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ze.INTERNAL:return U.INTERNAL;case ze.UNAVAILABLE:return U.UNAVAILABLE;case ze.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ze.NOT_FOUND:return U.NOT_FOUND;case ze.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ze.ABORTED:return U.ABORTED;case ze.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ze.DATA_LOSS:return U.DATA_LOSS;default:return ne(39323,{code:t})}}(de=ze||(ze={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new Xr([4294967295,4294967295],0);function Ov(t){const e=Pj().encode(t),n=new u1;return n.update(e),new Uint8Array(n.digest())}function Vv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Xr([n,r],0),new Xr([s,i],0)]}class Pp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ho(`Invalid padding: ${n}`);if(r<0)throw new Ho(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ho(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ho(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Xr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Xr.fromNumber(r)));return s.compare(Rj)===1&&(s=new Xr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Ov(e),[r,s]=Vv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Pp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=Ov(e),[r,s]=Vv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ho extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,al.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xu(se.min(),s,new Me(ce),pr(),ue())}}class al{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new al(r,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Y1{constructor(e,n){this.targetId=e,this.Ce=n}}class X1{constructor(e,n,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Fv{constructor(){this.ve=0,this.Fe=Uv(),this.Me=at.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ue(),n=ue(),r=ue();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ne(38017,{changeType:i})}}),new al(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Uv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jj{constructor(e){this.Ge=e,this.ze=new Map,this.je=pr(),this.Je=Wl(),this.He=Wl(),this.Ye=new Me(ce)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ne(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Uf(i))if(r===0){const o=new Z(i.path);this.et(n,o,gt.newNoDocument(o,se.min()))}else ge(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=is(r).toUint8Array()}catch(u){if(u instanceof b1)return Wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Pp(o,s,i)}catch(u){return Wi(u instanceof Ho?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&Uf(l.target)){const u=new Z(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,gt.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ue();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Xu(e,n,this.Ye,this.je,r);return this.je=pr(),this.Je=Wl(),this.He=Wl(),this.Ye=new Me(ce),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Fv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ye(ce),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ye(ce),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Fv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Wl(){return new Me(Z.comparator)}function Uv(){return new Me(Z.comparator)}const Dj={asc:"ASCENDING",desc:"DESCENDING"},Lj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mj={and:"AND",or:"OR"};class Oj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Bf(t,e){return t.useProto3Json||qu(e)?e:{value:e}}function au(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function J1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Vj(t,e){return au(t,e.toTimestamp())}function Fn(t){return ge(!!t,49232),se.fromTimestamp(function(n){const r=ss(n);return new Ie(r.seconds,r.nanos)}(t))}function Rp(t,e){return zf(t,e).canonicalString()}function zf(t,e){const n=function(s){return new _e(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Z1(t){const e=_e.fromString(t);return ge(sE(e),10190,{key:e.toString()}),e}function qf(t,e){return Rp(t.databaseId,e.path)}function wh(t,e){const n=Z1(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(tE(n))}function eE(t,e){return Rp(t.databaseId,e)}function Fj(t){const e=Z1(t);return e.length===4?_e.emptyPath():tE(e)}function Hf(t){return new _e(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function tE(t){return ge(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $v(t,e,n){return{name:qf(t,e),fields:n.value.mapValue.fields}}function Uj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ne(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(ge(h===void 0||typeof h=="string",58123),at.fromBase64String(h||"")):(ge(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),at.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?U.UNKNOWN:Q1(d.code);return new Q(h,d.message||"")}(o);n=new X1(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wh(t,r.document.name),i=Fn(r.document.updateTime),o=r.document.createTime?Fn(r.document.createTime):se.min(),l=new Rt({mapValue:{fields:r.document.fields}}),u=gt.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new wc(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wh(t,r.document),i=r.readTime?Fn(r.readTime):se.min(),o=gt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new wc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wh(t,r.document),i=r.removedTargetIds||[];n=new wc([],i,s,null)}else{if(!("filter"in e))return ne(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Cj(s,i),l=r.targetId;n=new Y1(l,o)}}return n}function $j(t,e){let n;if(e instanceof ol)n={update:$v(t,e.key,e.value)};else if(e instanceof Cp)n={delete:qf(t,e.key)};else if(e instanceof gs)n={update:$v(t,e.key,e.data),updateMask:Yj(e.fieldMask)};else{if(!(e instanceof Nj))return ne(16599,{Vt:e.type});n={verify:qf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Oa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Va)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ou)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw ne(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Vj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ne(27497)}(t,e.precondition)),n}function Bj(t,e){return t&&t.length>0?(ge(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Fn(s.updateTime):Fn(i);return o.isEqual(se.min())&&(o=Fn(i)),new Ej(o,s.transformResults||[])}(n,e))):[]}function zj(t,e){return{documents:[eE(t,e.path)]}}function qj(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=eE(t,s);const i=function(d){if(d.length!==0)return rE(bn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(g){return{field:fi(g.field),direction:Gj(g.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Bf(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function Hj(t){let e=Fj(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ge(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const g=nE(m);return g instanceof bn&&R1(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(S){return new Ma(mi(S.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,qu(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(m){const g=!!m.before,v=m.values||[];return new su(v,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,v=m.values||[];return new su(v,g)}(n.endAt)),cj(e,s,o,i,l,"F",u,d)}function Wj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function nE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=mi(n.unaryFilter.field);return He.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=mi(n.unaryFilter.field);return He.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=mi(n.unaryFilter.field);return He.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=mi(n.unaryFilter.field);return He.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ne(61313);default:return ne(60726)}}(t):t.fieldFilter!==void 0?function(n){return He.create(mi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ne(58110);default:return ne(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return bn.create(n.compositeFilter.filters.map(r=>nE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ne(1026)}}(n.compositeFilter.op))}(t):ne(30097,{filter:t})}function Gj(t){return Dj[t]}function Kj(t){return Lj[t]}function Qj(t){return Mj[t]}function fi(t){return{fieldPath:t.canonicalString()}}function mi(t){return st.fromServerFormat(t.fieldPath)}function rE(t){return t instanceof He?function(n){if(n.op==="=="){if(kv(n.value))return{unaryFilter:{field:fi(n.field),op:"IS_NAN"}};if(Sv(n.value))return{unaryFilter:{field:fi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(kv(n.value))return{unaryFilter:{field:fi(n.field),op:"IS_NOT_NAN"}};if(Sv(n.value))return{unaryFilter:{field:fi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fi(n.field),op:Kj(n.op),value:n.value}}}(t):t instanceof bn?function(n){const r=n.getFilters().map(s=>rE(s));return r.length===1?r[0]:{compositeFilter:{op:Qj(n.op),filters:r}}}(t):ne(54877,{filter:t})}function Yj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n,r,s,i=se.min(),o=se.min(),l=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ur(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this.yt=e}}function Jj(t){const e=Hj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?iu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(){this.Cn=new eD}addToCollectionParentIndex(e,n){return this.Cn.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(rs.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(rs.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class eD{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ye(_e.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ye(_e.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},iE=41943040;class St{static withCacheSize(e){return new St(e,St.DEFAULT_COLLECTION_PERCENTILE,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */St.DEFAULT_COLLECTION_PERCENTILE=10,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,St.DEFAULT=new St(iE,St.DEFAULT_COLLECTION_PERCENTILE,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),St.DISABLED=new St(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yi(0)}static cr(){return new Yi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="LruGarbageCollector",tD=1048576;function qv([t,e],[n,r]){const s=ce(t,n);return s===0?ce(e,r):s}class nD{constructor(e){this.Ir=e,this.buffer=new Ye(qv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();qv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rD{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(zv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){oo(n)?Y(zv,"Ignoring IndexedDB error during garbage collection: ",n):await io(n)}await this.Vr(3e5)})}}class sD{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(zu.ce);const r=new nD(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(Bv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),di()<=le.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function iD(t,e){return new sD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(){this.changes=new ni(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,gt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&la(r.mutation,s,Ht.empty(),Ie.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ue()){const s=Rs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=qo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Rs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=pr();const o=aa(),l=function(){return aa()}();return n.forEach((u,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof gs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),la(h.mutation,d,h.mutation.getFieldMask(),Ie.now())):o.set(d.key,Ht.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>l.set(d,new aD(h,o.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const r=aa();let s=new Me((o,l)=>o-l),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||Ht.empty();h=l.applyToLocalView(d,h),r.set(u,h);const m=(s.get(l.batchId)||ue()).add(u);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,m=$1();h.forEach(g=>{if(!i.has(g)){const v=G1(n.get(g),r.get(g));v!==null&&m.set(g,v),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):M1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(Rs());let l=Ra,u=i;return o.next(d=>$.forEach(d,(h,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(h)?$.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{u=u.insert(h,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ue())).next(h=>({batchId:l,changes:U1(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let s=qo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=qo();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const d=function(m,g){return new ao(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,gt.newInvalidDocument(h)))});let l=qo();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&la(h.mutation,d,Ht.empty(),Ie.now()),Ku(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return $.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Fn(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:Jj(s.bundledQuery),readTime:Fn(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(){this.overlays=new Me(Z.comparator),this.qr=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Rs();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=Rs(),i=n.length+1,o=new Z(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Me((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Rs(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Rs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return $.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new kj(n,r));let i=this.qr.get(n);i===void 0&&(i=ue(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(){this.Qr=new Ye(Je.$r),this.Ur=new Ye(Je.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Je(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Je(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Z(new _e([])),r=new Je(n,e),s=new Je(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Z(new _e([])),r=new Je(n,e),s=new Je(n,e+1);let i=ue();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Je(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Z.comparator(e.key,n.key)||ce(e.Yr,n.Yr)}static Kr(e,n){return ce(e.Yr,n.Yr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ye(Je.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sj(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new Je(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Ep:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Je(n,0),s=new Je(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ye(ce);return n.forEach(s=>{const i=new Je(s,0),o=new Je(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Z.isDocumentKey(i)||(i=i.child(""));const o=new Je(new Z(i),0);let l=new Ye(ce);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ge(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(n.mutations,s=>{const i=new Je(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Je(n,0),s=this.Zr.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.ri=e,this.docs=function(){return new Me(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():gt.newInvalidDocument(n))}getEntries(e,n){let r=pr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():gt.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=pr();const o=n.path,l=new Z(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||$R(UR(h),r)<=0||(s.has(h.key)||Ku(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ne(9500)}ii(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new mD(this)}getSize(e){return $.resolve(this.size)}}class mD extends oD{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.persistence=e,this.si=new ni(n=>Np(n),Sp),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.oi=0,this._i=new jp,this.targetCount=0,this.ai=Yi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),$.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Yi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Pr(n),$.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,n){this.ui={},this.overlays={},this.ci=new zu(0),this.li=!1,this.li=!0,this.hi=new dD,this.referenceDelegate=e(this),this.Pi=new pD(this),this.indexManager=new Zj,this.remoteDocumentCache=function(s){return new fD(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Xj(n),this.Ii=new cD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new hD(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const s=new gD(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return $.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class gD extends zR{constructor(e){super(),this.currentSequenceNumber=e}}class Dp{constructor(e){this.persistence=e,this.Ri=new jp,this.Vi=null}static mi(e){return new Dp(e)}get fi(){if(this.Vi)return this.Vi;throw ne(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),$.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,r=>{const s=Z.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,se.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return $.or([()=>$.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class lu{constructor(e,n){this.persistence=e,this.pi=new ni(r=>WR(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=iD(this,n)}static mi(e,n){return new lu(e,n)}Ei(){}di(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return $.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?$.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,se.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=gc(e.data.value)),n}br(e,n,r){return $.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return $.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ue(),s=ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Lp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Ok()?8:qR(vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new yD;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(di()<=le.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",hi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(di()<=le.DEBUG&&Y("QueryEngine","Query:",hi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(di()<=le.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",hi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(n))):$.resolve())}ys(e,n){if(Rv(n))return $.resolve(null);let r=Vn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=iu(n,null,"F"),r=Vn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ue(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,l);return this.Cs(n,d,o,u.readTime)?this.ys(e,iu(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return Rv(n)||s.isEqual(se.min())?$.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?$.resolve(null):(di()<=le.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),hi(n)),this.vs(e,o,n,FR(s,Ra)).next(l=>l))})}Ds(e,n){let r=new Ye(V1(e));return n.forEach((s,i)=>{Ku(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return di()<=le.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",hi(n)),this.ps.getDocumentsMatchingQuery(e,n,rs.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="LocalStore",wD=3e8;class xD{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Me(ce),this.xs=new ni(i=>Np(i),Sp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function _D(t,e,n,r){return new xD(t,e,n,r)}async function aE(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ue();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:l}))})})}function bD(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const m=d.batch,g=m.keys();let v=$.resolve();return g.forEach(S=>{v=v.next(()=>h.getEntry(u,S)).next(N=>{const b=d.docVersions.get(S);ge(b!==null,48541),N.version.compareTo(b)<0&&(m.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),h.addEntry(N)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ue();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function lE(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function ED(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((h,m)=>{const g=s.get(m);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,m)));let v=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(at.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(m,v),function(N,b,x){return N.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=wD?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,v,h)&&l.push(n.Pi.updateTargetData(i,v))});let u=pr(),d=ue();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(TD(i,o,e.documentUpdates).next(h=>{u=h.ks,d=h.qs})),!r.isEqual(se.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function TD(t,e,n){let r=ue(),s=ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=pr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(se.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Y(Mp,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function ID(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ep),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ND(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Ur(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Wf(t,e,n){const r=ie(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!oo(o))throw o;Y(Mp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Hv(t,e,n){const r=ie(t);let s=se.min(),i=ue();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const m=ie(u),g=m.xs.get(h);return g!==void 0?$.resolve(m.Ms.get(g)):m.Pi.getTargetData(d,h)}(r,o,Vn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:se.min(),n?i:ue())).next(l=>(SD(r,dj(e),l),{documents:l,Qs:i})))}function SD(t,e,n){let r=t.Os.get(e)||se.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class Wv{constructor(){this.activeTargetIds=yj()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kD{constructor(){this.Mo=new Wv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Wv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class Kv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gl=null;function Gf(){return Gl===null?Gl=function(){return 268435456+Math.round(2147483648*Math.random())}():Gl++,"0x"+Gl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh="RestConnection",AD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===nu?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Gf(),l=this.zo(e,n.toUriEncodedString());Y(xh,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(l),h=fs(d);return this.Jo(e,l,u,r,h).then(m=>(Y(xh,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Wi(xh,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+so}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=AD[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ft="WebChannelConnection";class jD extends PD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Gf();return new Promise((l,u)=>{const d=new d1;d.setWithCredentials(!0),d.listenOnce(h1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case pc.NO_ERROR:const m=d.getResponseJson();Y(ft,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case pc.TIMEOUT:Y(ft,`RPC '${e}' ${o} timed out`),u(new Q(U.DEADLINE_EXCEEDED,"Request time out"));break;case pc.HTTP_ERROR:const g=d.getStatus();if(Y(ft,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const S=v==null?void 0:v.error;if(S&&S.status&&S.message){const N=function(x){const y=x.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(y)>=0?y:U.UNKNOWN}(S.status);u(new Q(N,S.message))}else u(new Q(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Q(U.UNAVAILABLE,"Connection failed."));break;default:ne(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Y(ft,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);Y(ft,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=Gf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=p1(),l=m1(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");Y(ft,`Creating RPC '${e}' stream ${s}: ${h}`,u);const m=o.createWebChannel(h,u);this.I_(m);let g=!1,v=!1;const S=new RD({Yo:b=>{v?Y(ft,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(g||(Y(ft,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),Y(ft,`RPC '${e}' stream ${s} sending:`,b),m.send(b))},Zo:()=>m.close()}),N=(b,x,y)=>{b.listen(x,E=>{try{y(E)}catch(R){setTimeout(()=>{throw R},0)}})};return N(m,zo.EventType.OPEN,()=>{v||(Y(ft,`RPC '${e}' stream ${s} transport opened.`),S.o_())}),N(m,zo.EventType.CLOSE,()=>{v||(v=!0,Y(ft,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))}),N(m,zo.EventType.ERROR,b=>{v||(v=!0,Wi(ft,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),S.a_(new Q(U.UNAVAILABLE,"The operation could not be completed")))}),N(m,zo.EventType.MESSAGE,b=>{var x;if(!v){const y=b.data[0];ge(!!y,16349);const E=y,R=(E==null?void 0:E.error)||((x=E[0])==null?void 0:x.error);if(R){Y(ft,`RPC '${e}' stream ${s} received error:`,R);const P=R.status;let O=function(I){const C=ze[I];if(C!==void 0)return Q1(C)}(P),T=R.message;O===void 0&&(O=U.INTERNAL,T="Unknown error status: "+P+" with message "+R.message),v=!0,S.a_(new Q(O,T)),m.close()}else Y(ft,`RPC '${e}' stream ${s} received:`,y),S.u_(y)}}),N(l,f1.STAT_EVENT,b=>{b.stat===Lf.PROXY?Y(ft,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Lf.NOPROXY&&Y(ft,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function _h(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(t){return new Oj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv="PersistentStream";class uE{constructor(e,n,r,s,i,o,l,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new cE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(mr(n.toString()),mr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(Qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Y(Qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DD extends uE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Uj(this.serializer,e),r=function(i){if(!("targetChange"in i))return se.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?Fn(o.readTime):se.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Hf(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=Uf(u)?{documents:zj(i,u)}:{query:qj(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=J1(i,o.resumeToken);const d=Bf(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(se.min())>0){l.readTime=au(i,o.snapshotVersion.toTimestamp());const d=Bf(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=Wj(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Hf(this.serializer),n.removeTarget=e,this.q_(n)}}class LD extends uE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Bj(e.writeResults,e.commitTime),r=Fn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Hf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>$j(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{}class OD extends MD{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,zf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(U.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,zf(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class VD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(mr(n),this.aa=!1):Y("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="RemoteStore";class FD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ri(this)&&(Y(Ks,"Restarting streams for network reachability change."),await async function(u){const d=ie(u);d.Ea.add(4),await ll(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Zu(d)}(this))})}),this.Ra=new VD(r,s)}}async function Zu(t){if(ri(t))for(const e of t.da)await e(!0)}async function ll(t){for(const e of t.da)await e(!1)}function dE(t,e){const n=ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Up(n)?Fp(n):lo(n).O_()&&Vp(n,e))}function Op(t,e){const n=ie(t),r=lo(n);n.Ia.delete(e),r.O_()&&hE(n,e),n.Ia.size===0&&(r.O_()?r.L_():ri(n)&&n.Ra.set("Unknown"))}function Vp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}lo(t).Y_(e)}function hE(t,e){t.Va.Ue(e),lo(t).Z_(e)}function Fp(t){t.Va=new jj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),lo(t).start(),t.Ra.ua()}function Up(t){return ri(t)&&!lo(t).x_()&&t.Ia.size>0}function ri(t){return ie(t).Ea.size===0}function fE(t){t.Va=void 0}async function UD(t){t.Ra.set("Online")}async function $D(t){t.Ia.forEach((e,n)=>{Vp(t,e)})}async function BD(t,e){fE(t),Up(t)?(t.Ra.ha(e),Fp(t)):t.Ra.set("Unknown")}async function zD(t,e,n){if(t.Ra.set("Online"),e instanceof X1&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){Y(Ks,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cu(t,r)}else if(e instanceof wc?t.Va.Ze(e):e instanceof Y1?t.Va.st(e):t.Va.tt(e),!n.isEqual(se.min()))try{const r=await lE(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.Ia.get(u);if(!h)return;i.Ia.set(u,h.withResumeToken(at.EMPTY_BYTE_STRING,h.snapshotVersion)),hE(i,u);const m=new Ur(h.target,u,d,h.sequenceNumber);Vp(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Y(Ks,"Failed to raise snapshot:",r),await cu(t,r)}}async function cu(t,e,n){if(!oo(e))throw e;t.Ea.add(1),await ll(t),t.Ra.set("Offline"),n||(n=()=>lE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(Ks,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Zu(t)})}function mE(t,e){return e().catch(n=>cu(t,n,e))}async function ed(t){const e=ie(t),n=as(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ep;for(;qD(e);)try{const s=await ID(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,HD(e,s)}catch(s){await cu(e,s)}pE(e)&&gE(e)}function qD(t){return ri(t)&&t.Ta.length<10}function HD(t,e){t.Ta.push(e);const n=as(t);n.O_()&&n.X_&&n.ea(e.mutations)}function pE(t){return ri(t)&&!as(t).x_()&&t.Ta.length>0}function gE(t){as(t).start()}async function WD(t){as(t).ra()}async function GD(t){const e=as(t);for(const n of t.Ta)e.ea(n.mutations)}async function KD(t,e,n){const r=t.Ta.shift(),s=Ap.from(r,e,n);await mE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ed(t)}async function QD(t,e){e&&as(t).X_&&await async function(r,s){if(function(o){return Aj(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();as(r).B_(),await mE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ed(r)}}(t,e),pE(t)&&gE(t)}async function Yv(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),Y(Ks,"RemoteStore received new credentials");const r=ri(n);n.Ea.add(3),await ll(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Zu(n)}async function YD(t,e){const n=ie(t);e?(n.Ea.delete(2),await Zu(n)):e||(n.Ea.add(2),await ll(n),n.Ra.set("Unknown"))}function lo(t){return t.ma||(t.ma=function(n,r,s){const i=ie(n);return i.sa(),new DD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:UD.bind(null,t),t_:$D.bind(null,t),r_:BD.bind(null,t),H_:zD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Up(t)?Fp(t):t.Ra.set("Unknown")):(await t.ma.stop(),fE(t))})),t.ma}function as(t){return t.fa||(t.fa=function(n,r,s){const i=ie(n);return i.sa(),new LD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:WD.bind(null,t),r_:QD.bind(null,t),ta:GD.bind(null,t),na:KD.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ed(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(Ks,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new $p(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bp(t,e){if(mr("AsyncQueue",`${e}: ${t}`),oo(t))return new Q(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{static emptySet(e){return new Mi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=qo(),this.sortedSet=new Me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(){this.ga=new Me(Z.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ne(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Xi{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Xi(e,n,Mi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class JD{constructor(){this.queries=Jv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=Jv(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(r)})})(this,new Q(U.ABORTED,"Firestore shutting down"))}}function Jv(){return new ni(t=>O1(t),Gu)}async function zp(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new XD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Bp(o,`Initialization of query '${hi(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Hp(n)}async function qp(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ZD(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&Hp(n)}function e4(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function Hp(t){t.Ca.forEach(e=>{e.next()})}var Kf,Zv;(Zv=Kf||(Kf={})).Ma="default",Zv.Cache="cache";class Wp{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Xi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Xi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Kf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e){this.key=e}}class vE{constructor(e){this.key=e}}class t4{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ue(),this.mutatedKeys=ue(),this.eu=V1(e),this.tu=new Mi(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Xv,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const g=s.get(h),v=Ku(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),N=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let b=!1;g&&v?g.data.isEqual(v.data)?S!==N&&(r.track({type:3,doc:v}),b=!0):this.su(g,v)||(r.track({type:2,doc:v}),b=!0,(u&&this.eu(v,u)>0||d&&this.eu(v,d)<0)&&(l=!0)):!g&&v?(r.track({type:0,doc:v}),b=!0):g&&!v&&(r.track({type:1,doc:g}),b=!0,(u||d)&&(l=!0)),b&&(v?(o=o.add(v),i=N?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,m)=>function(v,S){const N=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne(20277,{Rt:b})}};return N(v)-N(S)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Xi(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Xv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ue(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new vE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new yE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ue();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Xi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Gp="SyncEngine";class n4{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class r4{constructor(e){this.key=e,this.hu=!1}}class s4{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ni(l=>O1(l),Gu),this.Iu=new Map,this.Eu=new Set,this.du=new Me(Z.comparator),this.Au=new Map,this.Ru=new jp,this.Vu={},this.mu=new Map,this.fu=Yi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function i4(t,e,n=!0){const r=TE(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await wE(r,e,n,!0),s}async function o4(t,e){const n=TE(t);await wE(n,e,!0,!1)}async function wE(t,e,n,r){const s=await ND(t.localStore,Vn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await a4(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&dE(t.remoteStore,s),l}async function a4(t,e,n,r,s){t.pu=(m,g,v)=>async function(N,b,x,y){let E=b.view.ru(x);E.Cs&&(E=await Hv(N.localStore,b.query,!1).then(({documents:T})=>b.view.ru(T,E)));const R=y&&y.targetChanges.get(b.targetId),P=y&&y.targetMismatches.get(b.targetId)!=null,O=b.view.applyChanges(E,N.isPrimaryClient,R,P);return tw(N,b.targetId,O.au),O.snapshot}(t,m,g,v);const i=await Hv(t.localStore,e,!0),o=new t4(e,i.Qs),l=o.ru(i.documents),u=al.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);tw(t,n,d.au);const h=new n4(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function l4(t,e,n){const r=ie(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Gu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Wf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Op(r.remoteStore,s.targetId),Qf(r,s.targetId)}).catch(io)):(Qf(r,s.targetId),await Wf(r.localStore,s.targetId,!0))}async function c4(t,e){const n=ie(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Op(n.remoteStore,r.targetId))}async function u4(t,e,n){const r=y4(t);try{const s=await function(o,l){const u=ie(o),d=Ie.now(),h=l.reduce((v,S)=>v.add(S.key),ue());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let S=pr(),N=ue();return u.Ns.getEntries(v,h).next(b=>{S=b,S.forEach((x,y)=>{y.isValidDocument()||(N=N.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,S)).next(b=>{m=b;const x=[];for(const y of l){const E=Ij(y,m.get(y.key).overlayedDocument);E!=null&&x.push(new gs(y.key,E,C1(E.value.mapValue),sn.exists(!0)))}return u.mutationQueue.addMutationBatch(v,d,x,l)}).next(b=>{g=b;const x=b.applyToLocalDocumentSet(m,N);return u.documentOverlayCache.saveOverlays(v,b.batchId,x)})}).then(()=>({batchId:g.batchId,changes:U1(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new Me(ce)),d=d.insert(l,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await cl(r,s.changes),await ed(r.remoteStore)}catch(s){const i=Bp(s,"Failed to persist write");n.reject(i)}}async function xE(t,e){const n=ie(t);try{const r=await ED(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ge(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ge(o.hu,14607):s.removedDocuments.size>0&&(ge(o.hu,42227),o.hu=!1))}),await cl(n,r,e)}catch(r){await io(r)}}function ew(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ie(o);u.onlineState=l;let d=!1;u.queries.forEach((h,m)=>{for(const g of m.Sa)g.va(l)&&(d=!0)}),d&&Hp(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function d4(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Me(Z.comparator);o=o.insert(i,gt.newNoDocument(i,se.min()));const l=ue().add(i),u=new Xu(se.min(),new Map,new Me(ce),o,l);await xE(r,u),r.du=r.du.remove(i),r.Au.delete(e),Kp(r)}else await Wf(r.localStore,e,!1).then(()=>Qf(r,e,n)).catch(io)}async function h4(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await bD(n.localStore,e);bE(n,r,null),_E(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await cl(n,s)}catch(s){await io(s)}}async function f4(t,e,n){const r=ie(t);try{const s=await function(o,l){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(m=>(ge(m!==null,37113),h=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);bE(r,e,n),_E(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await cl(r,s)}catch(s){await io(s)}}function _E(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function bE(t,e,n){const r=ie(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Qf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||EE(t,r)})}function EE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Op(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Kp(t))}function tw(t,e,n){for(const r of n)r instanceof yE?(t.Ru.addReference(r.key,e),m4(t,r)):r instanceof vE?(Y(Gp,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||EE(t,r.key)):ne(19791,{wu:r})}function m4(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Y(Gp,"New document in limbo: "+n),t.Eu.add(r),Kp(t))}function Kp(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Z(_e.fromString(e)),r=t.fu.next();t.Au.set(r,new r4(n)),t.du=t.du.insert(n,r),dE(t.remoteStore,new Ur(Vn(Wu(n.path)),r,"TargetPurposeLimboResolution",zu.ce))}}async function cl(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,u)=>{o.push(r.pu(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Lp.As(u.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const h=ie(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>$.forEach(d,g=>$.forEach(g.Es,v=>h.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>$.forEach(g.ds,v=>h.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!oo(m))throw m;Y(Mp,"Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const v=h.Ms.get(g),S=v.snapshotVersion,N=v.withLastLimboFreeSnapshotVersion(S);h.Ms=h.Ms.insert(g,N)}}}(r.localStore,i))}async function p4(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){Y(Gp,"User change. New user:",e.toKey());const r=await aE(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Q(U.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await cl(n,r.Ls)}}function g4(t,e){const n=ie(t),r=n.Au.get(e);if(r&&r.hu)return ue().add(r.key);{let s=ue();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function TE(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=g4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=d4.bind(null,e),e.Pu.H_=ZD.bind(null,e.eventManager),e.Pu.yu=e4.bind(null,e.eventManager),e}function y4(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=h4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=f4.bind(null,e),e}class uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ju(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return _D(this.persistence,new vD,e.initialUser,this.serializer)}Cu(e){return new oE(Dp.mi,this.serializer)}Du(e){return new kD}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uu.provider={build:()=>new uu};class v4 extends uu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ge(this.persistence.referenceDelegate instanceof lu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new rD(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?St.withCacheSize(this.cacheSizeBytes):St.DEFAULT;return new oE(r=>lu.mi(r,n),this.serializer)}}class Yf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ew(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=p4.bind(null,this.syncEngine),await YD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new JD}()}createDatastore(e){const n=Ju(e.databaseInfo.databaseId),r=function(i){return new jD(i)}(e.databaseInfo);return function(i,o,l,u){return new OD(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new FD(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>ew(this.syncEngine,n,0),function(){return Kv.v()?new Kv:new CD}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,h){const m=new s4(s,i,o,l,u,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);Y(Ks,"RemoteStore shutting down."),i.Ea.add(5),await ll(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Yf.provider={build:()=>new Yf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):mr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="FirestoreClient";class w4{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=mt.UNAUTHENTICATED,this.clientId=bp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y(ls,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y(ls,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Bp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function bh(t,e){t.asyncQueue.verifyOperationInProgress(),Y(ls,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await aE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await x4(t);Y(ls,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Yv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Yv(e.remoteStore,s)),t._onlineComponents=e}async function x4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(ls,"Using user provided OfflineComponentProvider");try{await bh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Wi("Error using user provided cache. Falling back to memory cache: "+n),await bh(t,new uu)}}else Y(ls,"Using default OfflineComponentProvider"),await bh(t,new v4(void 0));return t._offlineComponents}async function IE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(ls,"Using user provided OnlineComponentProvider"),await nw(t,t._uninitializedComponentsProvider._online)):(Y(ls,"Using default OnlineComponentProvider"),await nw(t,new Yf))),t._onlineComponents}function _4(t){return IE(t).then(e=>e.syncEngine)}async function du(t){const e=await IE(t),n=e.eventManager;return n.onListen=i4.bind(null,e.syncEngine),n.onUnlisten=l4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=o4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=c4.bind(null,e.syncEngine),n}function b4(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Qp({next:g=>{h.Nu(),o.enqueueAndForget(()=>qp(i,m));const v=g.docs.has(l);!v&&g.fromCache?d.reject(new Q(U.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&u&&u.source==="server"?d.reject(new Q(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Wp(Wu(l.path),h,{includeMetadataChanges:!0,qa:!0});return zp(i,m)}(await du(t),t.asyncQueue,e,n,r)),r.promise}function E4(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Qp({next:g=>{h.Nu(),o.enqueueAndForget(()=>qp(i,m)),g.fromCache&&u.source==="server"?d.reject(new Q(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Wp(l,h,{includeMetadataChanges:!0,qa:!0});return zp(i,m)}(await du(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="firestore.googleapis.com",sw=!0;class iw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=SE,this.ssl=sw}else this.host=e.host,this.ssl=e.ssl??sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=iE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tD)throw new Q(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=NE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class td{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new SR;switch(r.type){case"firstParty":return new PR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=rw.get(n);r&&(Y("ComponentProvider","Removing Datastore"),rw.delete(n),r.terminate())}(this),Promise.resolve()}}function T4(t,e,n,r={}){var d;t=Vt(t,td);const s=fs(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(lp(`https://${l}`),cp("Firestore",!0)),i.host!==SE&&i.host!==l&&Wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:s,emulatorOptions:r};if(!ns(u,o)&&(t._setSettings(u),r.mockUserToken)){let h,m;if(typeof r.mockUserToken=="string")h=r.mockUserToken,m=mt.MOCK_USER;else{h=yb(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Q(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new mt(g)}t._authCredentials=new kR(new y1(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _r(this.firestore,e,this._query)}}class Ue{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ue(this.firestore,e,this._key)}toJSON(){return{type:Ue._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(il(n,Ue._jsonSchema))return new Ue(e,r||null,new Z(_e.fromString(n.referencePath)))}}Ue._jsonSchemaVersion="firestore/documentReference/1.0",Ue._jsonSchema={type:We("string",Ue._jsonSchemaVersion),referencePath:We("string")};class Jr extends _r{constructor(e,n,r){super(e,n,Wu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ue(this.firestore,null,new Z(e))}withConverter(e){return new Jr(this.firestore,e,this._path)}}function Ae(t,e,...n){if(t=fe(t),v1("collection","path",e),t instanceof td){const r=_e.fromString(e,...n);return vv(r),new Jr(t,null,r)}{if(!(t instanceof Ue||t instanceof Jr))throw new Q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(_e.fromString(e,...n));return vv(r),new Jr(t.firestore,null,r)}}function je(t,e,...n){if(t=fe(t),arguments.length===1&&(e=bp.newId()),v1("doc","path",e),t instanceof td){const r=_e.fromString(e,...n);return yv(r),new Ue(t,null,new Z(r))}{if(!(t instanceof Ue||t instanceof Jr))throw new Q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(_e.fromString(e,...n));return yv(r),new Ue(t.firestore,t instanceof Jr?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="AsyncQueue";class aw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new cE(this,"async_queue_retry"),this._c=()=>{const r=_h();r&&Y(ow,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=_h();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=_h();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new rr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;Y(ow,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,mr("INTERNAL UNHANDLED ERROR: ",lw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=$p.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ne(47125,{Pc:lw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function lw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class gr extends td{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new aw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aw(e),this._firestoreClient=void 0,await e}}}function I4(t,e){const n=typeof t=="object"?t:el(),r=typeof t=="string"?t:nu,s=ms(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=mb("firestore");i&&T4(s,...i)}return s}function nd(t){if(t._terminated)throw new Q(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||N4(t),t._firestoreClient}function N4(t){var r,s,i;const e=t._freezeSettings(),n=function(l,u,d,h){return new QR(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,NE(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new w4(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tn(at.fromBase64String(e))}catch(n){throw new Q(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new tn(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(il(e,tn._jsonSchema))return tn.fromBase64String(e.bytes)}}tn._jsonSchemaVersion="firestore/bytes/1.0",tn._jsonSchema={type:We("string",tn._jsonSchemaVersion),bytes:We("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Un._jsonSchemaVersion}}static fromJSON(e){if(il(e,Un._jsonSchema))return new Un(e.latitude,e.longitude)}}Un._jsonSchemaVersion="firestore/geoPoint/1.0",Un._jsonSchema={type:We("string",Un._jsonSchemaVersion),latitude:We("number"),longitude:We("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:$n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(il(e,$n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new $n(e.vectorValues);throw new Q(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$n._jsonSchemaVersion="firestore/vectorValue/1.0",$n._jsonSchema={type:We("string",$n._jsonSchemaVersion),vectorValues:We("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=/^__.*__$/;class k4{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new gs(e,this.data,this.fieldMask,n,this.fieldTransforms):new ol(e,this.data,n,this.fieldTransforms)}}class kE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new gs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function CE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne(40011,{Ac:t})}}class Yp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return hu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(CE(this.Ac)&&S4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class C4{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ju(e)}Cc(e,n,r,s=!1){return new Yp({Ac:e,methodName:n,Dc:r,path:st.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function id(t){const e=t._freezeSettings(),n=Ju(t._databaseId);return new C4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function AE(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);Jp("Data must be an object, but it was:",o,r);const l=PE(r,o);let u,d;if(i.merge)u=new Ht(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const g=Xf(e,m,n);if(!o.contains(g))throw new Q(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);jE(h,g)||h.push(g)}u=new Ht(h),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new k4(new Rt(l),u,d)}class od extends sd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof od}}class Xp extends sd{_toFieldTransform(e){return new _j(e.path,new Oa)}isEqual(e){return e instanceof Xp}}function A4(t,e,n,r){const s=t.Cc(1,e,n);Jp("Data must be an object, but it was:",s,r);const i=[],o=Rt.empty();ps(r,(u,d)=>{const h=Zp(e,u,n);d=fe(d);const m=s.yc(h);if(d instanceof od)i.push(h);else{const g=ul(d,m);g!=null&&(i.push(h),o.set(h,g))}});const l=new Ht(i);return new kE(o,l,s.fieldTransforms)}function P4(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[Xf(e,r,n)],u=[s];if(i.length%2!=0)throw new Q(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(Xf(e,i[g])),u.push(i[g+1]);const d=[],h=Rt.empty();for(let g=l.length-1;g>=0;--g)if(!jE(d,l[g])){const v=l[g];let S=u[g];S=fe(S);const N=o.yc(v);if(S instanceof od)d.push(v);else{const b=ul(S,N);b!=null&&(d.push(v),h.set(v,b))}}const m=new Ht(d);return new kE(h,m,o.fieldTransforms)}function R4(t,e,n,r=!1){return ul(n,t.Cc(r?4:3,e))}function ul(t,e){if(RE(t=fe(t)))return Jp("Unsupported field value:",e,t),PE(t,e);if(t instanceof sd)return function(r,s){if(!CE(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=ul(l,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ie.fromDate(r);return{timestampValue:au(s.serializer,i)}}if(r instanceof Ie){const i=new Ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:au(s.serializer,i)}}if(r instanceof Un)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tn)return{bytesValue:J1(s.serializer,r._byteString)};if(r instanceof Ue){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Rp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof $n)return function(o,l){return{mapValue:{fields:{[S1]:{stringValue:k1},[ru]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return kp(l.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Bu(r)}`)}(t,e)}function PE(t,e){const n={};return _1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ps(t,(r,s)=>{const i=ul(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function RE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ie||t instanceof Un||t instanceof tn||t instanceof Ue||t instanceof sd||t instanceof $n)}function Jp(t,e,n){if(!RE(n)||!w1(n)){const r=Bu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Xf(t,e,n){if((e=fe(e))instanceof rd)return e._internalPath;if(typeof e=="string")return Zp(t,e);throw hu("Field path arguments must be of type string or ",t,!1,void 0,n)}const j4=new RegExp("[~\\*/\\[\\]]");function Zp(t,e,n){if(e.search(j4)>=0)throw hu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rd(...e.split("."))._internalPath}catch{throw hu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function hu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Q(U.INVALID_ARGUMENT,l+t+u)}function jE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ue(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new D4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ad("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class D4 extends DE{data(){return super.data()}}function ad(t,e){return typeof e=="string"?Zp(t,e):e instanceof rd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eg{}class tg extends eg{}function qn(t,e,...n){let r=[];e instanceof eg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof ng).length,l=i.filter(u=>u instanceof ld).length;if(o>1||o>0&&l>0)throw new Q(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class ld extends tg{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ld(e,n,r)}_apply(e){const n=this._parse(e);return ME(e._query,n),new _r(e.firestore,e.converter,$f(e._query,n))}_parse(e){const n=id(e.firestore);return function(i,o,l,u,d,h,m){let g;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){dw(m,h);const S=[];for(const N of m)S.push(uw(u,i,N));g={arrayValue:{values:S}}}else g=uw(u,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||dw(m,h),g=R4(l,o,m,h==="in"||h==="not-in");return He.create(d,h,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function yr(t,e,n){const r=e,s=ad("where",t);return ld._create(s,r,n)}class ng extends eg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ng(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:bn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)ME(o,u),o=$f(o,u)}(e._query,n),new _r(e.firestore,e.converter,$f(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class rg extends tg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new rg(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ma(i,o)}(e._query,this._field,this._direction);return new _r(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ao(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function si(t,e="asc"){const n=e,r=ad("orderBy",t);return rg._create(r,n)}class sg extends tg{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new sg(e,n,r)}_apply(e){return new _r(e.firestore,e.converter,iu(e._query,this._limit,this._limitType))}}function ig(t){return VR("limit",t),sg._create("limit",t,"F")}function uw(t,e,n){if(typeof(n=fe(n))=="string"){if(n==="")throw new Q(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!M1(e)&&n.indexOf("/")!==-1)throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(_e.fromString(n));if(!Z.isDocumentKey(r))throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Nv(t,new Z(r))}if(n instanceof Ue)return Nv(t,n._key);throw new Q(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bu(n)}.`)}function dw(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ME(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class L4{convertValue(e,n="none"){switch(os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(is(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ne(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ps(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ru].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>$e(o.doubleValue));return new $n(n)}convertGeoPoint(e){return new Un($e(e.latitude),$e(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Hu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ja(e));default:return null}}convertTimestamp(e){const n=ss(e);return new Ie(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=_e.fromString(e);ge(sE(r),9688,{name:e});const s=new Da(r.get(1),r.get(3)),i=new Z(r.popFirst(5));return s.isEqual(n)||mr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Wo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ms extends DE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new xc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ad("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ms._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ms._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ms._jsonSchema={type:We("string",Ms._jsonSchemaVersion),bundleSource:We("string","DocumentSnapshot"),bundleName:We("string"),bundle:We("string")};class xc extends Ms{data(e={}){return super.data(e)}}class Os{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Wo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new xc(this._firestore,this._userDataWriter,r.key,r,new Wo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new xc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Wo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new xc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Wo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:M4(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Os._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function M4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t){t=Vt(t,Ue);const e=Vt(t.firestore,gr);return b4(nd(e),t._key).then(n=>FE(e,t,n))}Os._jsonSchemaVersion="firestore/querySnapshot/1.0",Os._jsonSchema={type:We("string",Os._jsonSchemaVersion),bundleSource:We("string","QuerySnapshot"),bundleName:We("string"),bundle:We("string")};class og extends L4{constructor(e){super(),this.firestore=e}convertBytes(e){return new tn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ue(this.firestore,null,n)}}function ys(t){t=Vt(t,_r);const e=Vt(t.firestore,gr),n=nd(e),r=new og(e);return LE(t._query),E4(n,t._query).then(s=>new Os(e,r,t,s))}function fu(t,e,n){t=Vt(t,Ue);const r=Vt(t.firestore,gr),s=OE(t.converter,e,n);return cd(r,[AE(id(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,sn.none())])}function vs(t,e,n,...r){t=Vt(t,Ue);const s=Vt(t.firestore,gr),i=id(s);let o;return o=typeof(e=fe(e))=="string"||e instanceof rd?P4(i,"updateDoc",t._key,e,n,r):A4(i,"updateDoc",t._key,e),cd(s,[o.toMutation(t._key,sn.exists(!0))])}function O4(t){return cd(Vt(t.firestore,gr),[new Cp(t._key,sn.none())])}function Ft(t,e){const n=Vt(t.firestore,gr),r=je(t),s=OE(t.converter,e);return cd(n,[AE(id(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,sn.exists(!1))]).then(()=>r)}function VE(t,...e){var u,d,h;t=fe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||cw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(cw(e[r])){const m=e[r];e[r]=(u=m.next)==null?void 0:u.bind(m),e[r+1]=(d=m.error)==null?void 0:d.bind(m),e[r+2]=(h=m.complete)==null?void 0:h.bind(m)}let i,o,l;if(t instanceof Ue)o=Vt(t.firestore,gr),l=Wu(t._key.path),i={next:m=>{e[r]&&e[r](FE(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=Vt(t,_r);o=Vt(m.firestore,gr),l=m._query;const g=new og(o);i={next:v=>{e[r]&&e[r](new Os(o,g,m,v))},error:e[r+1],complete:e[r+2]},LE(t._query)}return function(g,v,S,N){const b=new Qp(N),x=new Wp(v,b,S);return g.asyncQueue.enqueueAndForget(async()=>zp(await du(g),x)),()=>{b.Nu(),g.asyncQueue.enqueueAndForget(async()=>qp(await du(g),x))}}(nd(o),l,s,i)}function cd(t,e){return function(r,s){const i=new rr;return r.asyncQueue.enqueueAndForget(async()=>u4(await _4(r),s,i)),i.promise}(nd(t),e)}function FE(t,e,n){const r=n.docs.get(e._key),s=new og(t);return new Ms(t,s,e._key,r,new Wo(n.hasPendingWrites,n.fromCache),e.converter)}function ye(){return new Xp("serverTimestamp")}(function(e,n=!0){(function(s){so=s})(ti),_n(new ln("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new gr(new CR(r.getProvider("auth-internal")),new RR(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Q(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Da(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Ot(fv,mv,e),Ot(fv,mv,"esm2020")})();var V4="firebase",F4="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ot(V4,F4,"app");const UE="@firebase/installations",ag="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=1e4,BE=`w:${ag}`,zE="FIS_v2",U4="https://firebaseinstallations.googleapis.com/v1",$4=60*60*1e3,B4="installations",z4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Qs=new ei(B4,z4,q4);function qE(t){return t instanceof un&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE({projectId:t}){return`${U4}/projects/${t}/installations`}function WE(t){return{token:t.token,requestStatus:2,expiresIn:W4(t.expiresIn),creationTime:Date.now()}}async function GE(t,e){const r=(await e.json()).error;return Qs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function KE({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function H4(t,{refreshToken:e}){const n=KE(t);return n.append("Authorization",G4(e)),n}async function QE(t){const e=await t();return e.status>=500&&e.status<600?t():e}function W4(t){return Number(t.replace("s","000"))}function G4(t){return`${zE} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=HE(t),s=KE(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:zE,appId:t.appId,sdkVersion:BE},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await QE(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:WE(d.authToken)}}else throw await GE("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=/^[cdef][\w-]{21}$/,Jf="";function X4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=J4(t);return Y4.test(n)?n:Jf}catch{return Jf}}function J4(t){return Q4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;function JE(t,e){const n=ud(t);ZE(n,e),Z4(n,e)}function ZE(t,e){const n=XE.get(t);if(n)for(const r of n)r(e)}function Z4(t,e){const n=e3();n&&n.postMessage({key:t,fid:e}),t3()}let js=null;function e3(){return!js&&"BroadcastChannel"in self&&(js=new BroadcastChannel("[Firebase] FID Change"),js.onmessage=t=>{ZE(t.data.key,t.data.fid)}),js}function t3(){XE.size===0&&js&&(js.close(),js=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3="firebase-installations-database",r3=1,Ys="firebase-installations-store";let Eh=null;function lg(){return Eh||(Eh=Eb(n3,r3,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ys)}}})),Eh}async function mu(t,e){const n=ud(t),s=(await lg()).transaction(Ys,"readwrite"),i=s.objectStore(Ys),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&JE(t,e.fid),e}async function e2(t){const e=ud(t),r=(await lg()).transaction(Ys,"readwrite");await r.objectStore(Ys).delete(e),await r.done}async function dd(t,e){const n=ud(t),s=(await lg()).transaction(Ys,"readwrite"),i=s.objectStore(Ys),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&JE(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cg(t){let e;const n=await dd(t.appConfig,r=>{const s=s3(r),i=i3(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Jf?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function s3(t){const e=t||{fid:X4(),registrationStatus:0};return t2(e)}function i3(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Qs.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=o3(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:a3(t)}:{installationEntry:e}}async function o3(t,e){try{const n=await K4(t,e);return mu(t.appConfig,n)}catch(n){throw qE(n)&&n.customData.serverCode===409?await e2(t.appConfig):await mu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function a3(t){let e=await hw(t.appConfig);for(;e.registrationStatus===1;)await YE(100),e=await hw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await cg(t);return r||n}return e}function hw(t){return dd(t,e=>{if(!e)throw Qs.create("installation-not-found");return t2(e)})}function t2(t){return l3(t)?{fid:t.fid,registrationStatus:0}:t}function l3(t){return t.registrationStatus===1&&t.registrationTime+$E<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c3({appConfig:t,heartbeatServiceProvider:e},n){const r=u3(t,n),s=H4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:BE,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await QE(()=>fetch(r,l));if(u.ok){const d=await u.json();return WE(d)}else throw await GE("Generate Auth Token",u)}function u3(t,{fid:e}){return`${HE(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ug(t,e=!1){let n;const r=await dd(t.appConfig,i=>{if(!n2(i))throw Qs.create("not-registered");const o=i.authToken;if(!e&&f3(o))return i;if(o.requestStatus===1)return n=d3(t,e),i;{if(!navigator.onLine)throw Qs.create("app-offline");const l=p3(i);return n=h3(t,l),l}});return n?await n:r.authToken}async function d3(t,e){let n=await fw(t.appConfig);for(;n.authToken.requestStatus===1;)await YE(100),n=await fw(t.appConfig);const r=n.authToken;return r.requestStatus===0?ug(t,e):r}function fw(t){return dd(t,e=>{if(!n2(e))throw Qs.create("not-registered");const n=e.authToken;return g3(n)?{...e,authToken:{requestStatus:0}}:e})}async function h3(t,e){try{const n=await c3(t,e),r={...e,authToken:n};return await mu(t.appConfig,r),n}catch(n){if(qE(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await e2(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await mu(t.appConfig,r)}throw n}}function n2(t){return t!==void 0&&t.registrationStatus===2}function f3(t){return t.requestStatus===2&&!m3(t)}function m3(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+$4}function p3(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function g3(t){return t.requestStatus===1&&t.requestTime+$E<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y3(t){const e=t,{installationEntry:n,registrationPromise:r}=await cg(e);return r?r.catch(console.error):ug(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v3(t,e=!1){const n=t;return await w3(n),(await ug(n,e)).token}async function w3(t){const{registrationPromise:e}=await cg(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x3(t){if(!t||!t.options)throw Th("App Configuration");if(!t.name)throw Th("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Th(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Th(t){return Qs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2="installations",_3="installations-internal",b3=t=>{const e=t.getProvider("app").getImmediate(),n=x3(e),r=ms(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},E3=t=>{const e=t.getProvider("app").getImmediate(),n=ms(e,r2).getImmediate();return{getId:()=>y3(n),getToken:s=>v3(n,s)}};function T3(){_n(new ln(r2,b3,"PUBLIC")),_n(new ln(_3,E3,"PRIVATE"))}T3();Ot(UE,ag);Ot(UE,ag,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu="analytics",I3="firebase_id",N3="origin",S3=60*1e3,k3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",dg="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tt=new Vu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Qt=new ei("analytics","Analytics",C3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(t){if(!t.startsWith(dg)){const e=Qt.create("invalid-gtag-resource",{gtagURL:t});return Tt.warn(e.message),""}return t}function s2(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function P3(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function R3(t,e){const n=P3("firebase-js-sdk-policy",{createScriptURL:A3}),r=document.createElement("script"),s=`${dg}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function j3(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function D3(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const u=(await s2(n)).find(d=>d.measurementId===s);u&&await e[u.appId]}}catch(l){Tt.error(l)}t("config",s,i)}async function L3(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const l=await s2(n);for(const u of o){const d=l.find(m=>m.measurementId===u),h=d&&e[d.appId];if(h)i.push(h);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){Tt.error(i)}}function M3(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[l,u]=o;await L3(t,e,n,l,u)}else if(i==="config"){const[l,u]=o;await D3(t,e,n,r,l,u)}else if(i==="consent"){const[l,u]=o;t("consent",l,u)}else if(i==="get"){const[l,u,d]=o;t("get",l,u,d)}else if(i==="set"){const[l]=o;t("set",l)}else t(i,...o)}catch(l){Tt.error(l)}}return s}function O3(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=M3(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function V3(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(dg)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3=30,U3=1e3;class $3{constructor(e={},n=U3){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const i2=new $3;function B3(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function z3(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:B3(n)},s=k3.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let l="";try{const u=await i.json();(o=u.error)!=null&&o.message&&(l=u.error.message)}catch{}throw Qt.create("config-fetch-failed",{httpStatus:i.status,responseMessage:l})}return i.json()}async function q3(t,e=i2,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Qt.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Qt.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new G3;return setTimeout(async()=>{l.abort()},S3),o2({appId:r,apiKey:s,measurementId:i},o,l,e)}async function o2(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=i2){var l;const{appId:i,measurementId:o}=t;try{await H3(r,e)}catch(u){if(o)return Tt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:i,measurementId:o};throw u}try{const u=await z3(t);return s.deleteThrottleMetadata(i),u}catch(u){const d=u;if(!W3(d)){if(s.deleteThrottleMetadata(i),o)return Tt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw u}const h=Number((l=d==null?void 0:d.customData)==null?void 0:l.httpStatus)===503?V0(n,s.intervalMillis,F3):V0(n,s.intervalMillis),m={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(i,m),Tt.debug(`Calling attemptFetch again in ${h} millis`),o2(t,m,r,s)}}function H3(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Qt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function W3(t){if(!(t instanceof un)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class G3{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function K3(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}async function Q3(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y3(){if(wb())try{await xb()}catch(t){return Tt.warn(Qt.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Tt.warn(Qt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function X3(t,e,n,r,s,i,o){const l=q3(t);l.then(g=>{n[g.measurementId]=g.appId,t.options.measurementId&&g.measurementId!==t.options.measurementId&&Tt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>Tt.error(g)),e.push(l);const u=Y3().then(g=>{if(g)return r.getId()}),[d,h]=await Promise.all([l,u]);V3(i)||R3(i,d.measurementId),s("js",new Date);const m=(o==null?void 0:o.config)??{};return m[N3]="firebase",m.update=!0,h!=null&&(m[I3]=h),s("config",d.measurementId,m),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e){this.app=e}_delete(){return delete Oi[this.app.options.appId],Promise.resolve()}}let Oi={},mw=[];const pw={};let Ih="dataLayer",Z3="gtag",gw,hg,yw=!1;function eL(){const t=[];if(vb()&&t.push("This is a browser extension environment."),Vk()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Qt.create("invalid-analytics-context",{errorInfo:e});Tt.warn(n.message)}}function tL(t,e,n){eL();const r=t.options.appId;if(!r)throw Qt.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Tt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Qt.create("no-api-key");if(Oi[r]!=null)throw Qt.create("already-exists",{id:r});if(!yw){j3(Ih);const{wrappedGtag:i,gtagCore:o}=O3(Oi,mw,pw,Ih,Z3);hg=i,gw=o,yw=!0}return Oi[r]=X3(t,mw,pw,e,gw,Ih,n),new J3(t)}function nL(t=el()){t=fe(t);const e=ms(t,pu);return e.isInitialized()?e.getImmediate():rL(t)}function rL(t,e={}){const n=ms(t,pu);if(n.isInitialized()){const s=n.getImmediate();if(ns(e,n.getOptions()))return s;throw Qt.create("already-initialized")}return n.initialize({options:e})}function sL(t,e,n){t=fe(t),Q3(hg,Oi[t.app.options.appId],e,n).catch(r=>Tt.error(r))}function iL(t,e,n,r){t=fe(t),K3(hg,Oi[t.app.options.appId],e,n,r).catch(s=>Tt.error(s))}const vw="@firebase/analytics",ww="0.10.19";function oL(){_n(new ln(pu,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return tL(r,s,n)},"PUBLIC")),_n(new ln("analytics-internal",t,"PRIVATE")),Ot(vw,ww),Ot(vw,ww,"esm2020");function t(e){try{const n=e.getProvider(pu).getImmediate();return{logEvent:(r,s,i)=>iL(n,r,s,i),setUserProperties:(r,s)=>sL(n,r,s)}}catch(n){throw Qt.create("interop-component-reg-failed",{reason:n})}}}oL();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="firebasestorage.googleapis.com",l2="storageBucket",aL=2*60*1e3,lL=10*60*1e3,cL=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe extends un{constructor(e,n,r=0){super(Nh(e),`Firebase Storage: ${n} (${Nh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Oe.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Nh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Se;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Se||(Se={}));function Nh(t){return"storage/"+t}function fg(){const t="An unknown error occurred, please check the error payload for server response.";return new Oe(Se.UNKNOWN,t)}function uL(t){return new Oe(Se.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function dL(t){return new Oe(Se.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function hL(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Oe(Se.UNAUTHENTICATED,t)}function fL(){return new Oe(Se.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function mL(t){return new Oe(Se.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function c2(){return new Oe(Se.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function u2(){return new Oe(Se.CANCELED,"User canceled the upload/download.")}function pL(t){return new Oe(Se.INVALID_URL,"Invalid URL '"+t+"'.")}function gL(t){return new Oe(Se.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function yL(){return new Oe(Se.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+l2+"' property when initializing the app?")}function d2(){return new Oe(Se.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function vL(){return new Oe(Se.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function wL(){return new Oe(Se.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function xL(t){return new Oe(Se.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Zf(t){return new Oe(Se.INVALID_ARGUMENT,t)}function h2(){return new Oe(Se.APP_DELETED,"The Firebase app was deleted.")}function _L(t){return new Oe(Se.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ca(t,e){return new Oe(Se.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Mo(t){throw new Oe(Se.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Wt.makeFromUrl(e,n)}catch{return new Wt(e,"")}if(r.path==="")return r;throw gL(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function d(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${h}/b/${s}/o${g}`,"i"),S={bucket:1,path:3},N=n===a2?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",x=new RegExp(`^https?://${N}/${s}/${b}`,"i"),E=[{regex:l,indices:u,postModify:i},{regex:v,indices:S,postModify:d},{regex:x,indices:{bucket:1,path:2},postModify:d}];for(let R=0;R<E.length;R++){const P=E[R],O=P.regex.exec(e);if(O){const T=O[P.indices.bucket];let w=O[P.indices.path];w||(w=""),r=new Wt(T,w),P.postModify(r);break}}if(r==null)throw pL(e);return r}}class bL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function u(){return l===2}let d=!1;function h(...b){d||(d=!0,e.apply(null,b))}function m(b){s=setTimeout(()=>{s=null,t(v,u())},b)}function g(){i&&clearTimeout(i)}function v(b,...x){if(d){g();return}if(b){g(),h.call(null,b,...x);return}if(u()||o){g(),h.call(null,b,...x);return}r<64&&(r*=2);let E;l===1?(l=2,E=0):E=(r+Math.random())*1e3,m(E)}let S=!1;function N(b){S||(S=!0,g(),!d&&(s!==null?(b||(l=2),clearTimeout(s),m(0)):b||(l=1)))}return m(0),i=setTimeout(()=>{o=!0,N(!0)},n),N}function TL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){return t!==void 0}function NL(t){return typeof t=="function"}function SL(t){return typeof t=="object"&&!Array.isArray(t)}function hd(t){return typeof t=="string"||t instanceof String}function xw(t){return mg()&&t instanceof Blob}function mg(){return typeof Blob<"u"}function _w(t,e,n,r){if(r<e)throw Zf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Zf(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function co(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function f2(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Vs;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Vs||(Vs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m2(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,n,r,s,i,o,l,u,d,h,m,g=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=g,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,N)=>{this.resolve_=S,this.reject_=N,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Kl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Vs.NO_ERROR,u=i.getStatus();if(!l||m2(u,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Vs.ABORT;r(!1,new Kl(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new Kl(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());IL(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=fg();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(s.canceled){const u=this.appDelete_?h2():u2();o(u)}else{const u=c2();o(u)}};this.canceled_?n(!1,new Kl(!1,null,!0)):this.backoffId_=EL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Kl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function CL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function AL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function PL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function jL(t,e,n,r,s,i,o=!0,l=!1){const u=f2(t.urlParams),d=t.url+u,h=Object.assign({},t.headers);return PL(h,e),CL(h,n),AL(h,i),RL(h,r),new kL(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function LL(...t){const e=DL();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(mg())return new Blob(t);throw new Oe(Se.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ML(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(t){if(typeof atob>"u")throw xL("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Sh{constructor(e,n){this.data=e,this.contentType=n||null}}function VL(t,e){switch(t){case jn.RAW:return new Sh(p2(e));case jn.BASE64:case jn.BASE64URL:return new Sh(g2(t,e));case jn.DATA_URL:return new Sh(UL(e),$L(e))}throw fg()}function p2(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function FL(t){let e;try{e=decodeURIComponent(t)}catch{throw ca(jn.DATA_URL,"Malformed data URL.")}return p2(e)}function g2(t,e){switch(t){case jn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw ca(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case jn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw ca(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=OL(e)}catch(s){throw s.message.includes("polyfill")?s:ca(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class y2{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ca(jn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=BL(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function UL(t){const e=new y2(t);return e.base64?g2(jn.BASE64,e.rest):FL(e.rest)}function $L(t){return new y2(t).contentType}function BL(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,n){let r=0,s="";xw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(xw(this.data_)){const r=this.data_,s=ML(r,e,n);return s===null?null:new Qn(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Qn(r,!0)}}static getBlob(...e){if(mg()){const n=e.map(r=>r instanceof Qn?r.data_:r);return new Qn(LL.apply(null,n))}else{const n=e.map(o=>hd(o)?VL(jn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Qn(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(t){let e;try{e=JSON.parse(t)}catch{return null}return SL(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function qL(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function w2(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(t,e){return e}class _t{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||HL}}let Ql=null;function WL(t){return!hd(t)||t.length<2?t:w2(t)}function pg(){if(Ql)return Ql;const t=[];t.push(new _t("bucket")),t.push(new _t("generation")),t.push(new _t("metageneration")),t.push(new _t("name","fullPath",!0));function e(i,o){return WL(o)}const n=new _t("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new _t("size");return s.xform=r,t.push(s),t.push(new _t("timeCreated")),t.push(new _t("updated")),t.push(new _t("md5Hash",null,!0)),t.push(new _t("cacheControl",null,!0)),t.push(new _t("contentDisposition",null,!0)),t.push(new _t("contentEncoding",null,!0)),t.push(new _t("contentLanguage",null,!0)),t.push(new _t("contentType",null,!0)),t.push(new _t("metadata","customMetadata",!0)),Ql=t,Ql}function GL(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Wt(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function KL(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return GL(r,t),r}function x2(t,e,n){const r=v2(e);return r===null?null:KL(t,r,n)}function QL(t,e,n,r){const s=v2(e);if(s===null||!hd(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,g="/b/"+o(h)+"/o/"+o(m),v=co(g,n,r),S=f2({alt:"media",token:d});return v+S})[0]}function _2(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class ii{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(t){if(!t)throw fg()}function gg(t,e){function n(r,s){const i=x2(t,s,e);return sr(i!==null),i}return n}function YL(t,e){function n(r,s){const i=x2(t,s,e);return sr(i!==null),QL(i,s,t.host,t._protocol)}return n}function dl(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=fL():s=hL():n.getStatus()===402?s=dL(t.bucket):n.getStatus()===403?s=mL(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function yg(t){const e=dl(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=uL(t.path)),i.serverResponse=s.serverResponse,i}return n}function XL(t,e,n){const r=e.fullServerUrl(),s=co(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new ii(s,i,gg(t,n),o);return l.errorHandler=yg(e),l}function JL(t,e,n){const r=e.fullServerUrl(),s=co(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new ii(s,i,YL(t,n),o);return l.errorHandler=yg(e),l}function ZL(t,e){const n=e.fullServerUrl(),r=co(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(u,d){}const l=new ii(r,s,o,i);return l.successCodes=[200,204],l.errorHandler=yg(e),l}function e6(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function b2(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=e6(null,e)),r}function E2(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let E="";for(let R=0;R<2;R++)E=E+Math.random().toString().slice(2);return E}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const d=b2(e,r,s),h=_2(d,n),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,g=`\r
--`+u+"--",v=Qn.getBlob(m,r,g);if(v===null)throw d2();const S={name:d.fullPath},N=co(i,t.host,t._protocol),b="POST",x=t.maxUploadRetryTime,y=new ii(N,b,gg(t,n),x);return y.urlParams=S,y.headers=o,y.body=v.uploadData(),y.errorHandler=dl(e),y}class gu{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function vg(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{sr(!1)}return sr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function t6(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=b2(e,r,s),l={name:o.fullPath},u=co(i,t.host,t._protocol),d="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},m=_2(o,n),g=t.maxUploadRetryTime;function v(N){vg(N);let b;try{b=N.getResponseHeader("X-Goog-Upload-URL")}catch{sr(!1)}return sr(hd(b)),b}const S=new ii(u,d,v,g);return S.urlParams=l,S.headers=h,S.body=m,S.errorHandler=dl(e),S}function n6(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(d){const h=vg(d,["active","final"]);let m=null;try{m=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{sr(!1)}m||sr(!1);const g=Number(m);return sr(!isNaN(g)),new gu(g,r.size(),h==="final")}const o="POST",l=t.maxUploadRetryTime,u=new ii(n,o,i,l);return u.headers=s,u.errorHandler=dl(e),u}const bw=256*1024;function r6(t,e,n,r,s,i,o,l){const u=new gu(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw vL();const d=u.total-u.current;let h=d;s>0&&(h=Math.min(h,s));const m=u.current,g=m+h;let v="";h===0?v="finalize":d===h?v="upload, finalize":v="upload";const S={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":`${u.current}`},N=r.slice(m,g);if(N===null)throw d2();function b(R,P){const O=vg(R,["active","final"]),T=u.current+h,w=r.size();let I;return O==="final"?I=gg(e,i)(R,P):I=null,new gu(T,w,O==="final",I)}const x="POST",y=e.maxUploadRetryTime,E=new ii(n,x,b,y);return E.headers=S,E.body=N.uploadData(),E.progressCallback=l||null,E.errorHandler=dl(t),E}const kt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kh(t){switch(t){case"running":case"pausing":case"canceling":return kt.RUNNING;case"paused":return kt.PAUSED;case"success":return kt.SUCCESS;case"canceled":return kt.CANCELED;case"error":return kt.ERROR;default:return kt.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e,n,r){if(NL(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class i6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Mo("cannot .send() more than once");if(fs(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Mo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Mo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Mo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Mo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class o6 extends i6{initXhr(){this.xhr_.responseType="text"}}function Or(){return new o6}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=pg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Se.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(m2(s.status,[]))if(i)s=c2();else{this.sleepTime=Math.max(this.sleepTime*2,cL),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Se.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=t6(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Or,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=n6(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Or,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=bw*this._chunkMultiplier,n=new gu(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=r6(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}const l=this._ref.storage._makeRequest(o,Or,s,i,!1);this._request=l,l.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){bw*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=XL(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Or,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=E2(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Or,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=u2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=kh(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new s6(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(kh(this._state)){case kt.SUCCESS:ui(this._resolve.bind(null,this.snapshot))();break;case kt.CANCELED:case kt.ERROR:const n=this._reject;ui(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(kh(this._state)){case kt.RUNNING:case kt.PAUSED:e.next&&ui(e.next.bind(e,this.snapshot))();break;case kt.SUCCESS:e.complete&&ui(e.complete.bind(e))();break;case kt.CANCELED:case kt.ERROR:e.error&&ui(e.error.bind(e,this._error))();break;default:e.error&&ui(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,n){this._service=e,n instanceof Wt?this._location=n:this._location=Wt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Xs(e,n)}get root(){const e=new Wt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return w2(this._location.path)}get storage(){return this._service}get parent(){const e=zL(this._location.path);if(e===null)return null;const n=new Wt(this._location.bucket,e);return new Xs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw _L(e)}}function l6(t,e,n){t._throwIfRoot("uploadBytes");const r=E2(t.storage,t._location,pg(),new Qn(e,!0),n);return t.storage.makeRequestWithTokens(r,Or).then(s=>({metadata:s,ref:t}))}function c6(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new a6(t,new Qn(e),n)}function u6(t){t._throwIfRoot("getDownloadURL");const e=JL(t.storage,t._location,pg());return t.storage.makeRequestWithTokens(e,Or).then(n=>{if(n===null)throw wL();return n})}function d6(t){t._throwIfRoot("deleteObject");const e=ZL(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Or)}function h6(t,e){const n=qL(t._location.path,e),r=new Wt(t._location.bucket,n);return new Xs(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(t){return/^[A-Za-z]+:\/\//.test(t)}function m6(t,e){return new Xs(t,e)}function T2(t,e){if(t instanceof wg){const n=t;if(n._bucket==null)throw yL();const r=new Xs(n,n._bucket);return e!=null?T2(r,e):r}else return e!==void 0?h6(t,e):t}function p6(t,e){if(e&&f6(e)){if(t instanceof wg)return m6(t,e);throw Zf("To use ref(service, url), the first argument must be a Storage instance.")}else return T2(t,e)}function Ew(t,e){const n=e==null?void 0:e[l2];return n==null?null:Wt.makeFromBucketSpec(n,t)}function g6(t,e,n,r={}){t.host=`${e}:${n}`;const s=fs(e);s&&(lp(`https://${t.host}/b`),cp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:yb(i,t.app.options.projectId))}class wg{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=a2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=aL,this._maxUploadRetryTime=lL,this._requests=new Set,s!=null?this._bucket=Wt.makeFromBucketSpec(s,this._host):this._bucket=Ew(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wt.makeFromBucketSpec(this._url,e):this._bucket=Ew(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){_w("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){_w("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Pt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xs(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new bL(h2());{const o=jL(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Tw="@firebase/storage",Iw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2="storage";function y6(t,e,n){return t=fe(t),l6(t,e,n)}function v6(t,e,n){return t=fe(t),c6(t,e,n)}function N2(t){return t=fe(t),u6(t)}function w6(t){return t=fe(t),d6(t)}function xg(t,e){return t=fe(t),p6(t,e)}function x6(t=el(),e){t=fe(t);const r=ms(t,I2).getImmediate({identifier:e}),s=mb("storage");return s&&_6(r,...s),r}function _6(t,e,n,r={}){g6(t,e,n,r)}function b6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new wg(n,r,s,e,ti)}function E6(){_n(new ln(I2,b6,"PUBLIC").setMultipleInstances(!0)),Ot(Tw,Iw,""),Ot(Tw,Iw,"esm2020")}E6();const T6={apiKey:"AIzaSyBHyhsDtZABqCEgmPdVHsA8r4vqTQIBJSs",authDomain:"dermaglareapp.firebaseapp.com",projectId:"dermaglareapp",storageBucket:"dermaglareapp.firebasestorage.app",messagingSenderId:"462818904186",appId:"1:462818904186:web:2040dcd437664d563bd3c3",measurementId:"G-3XLGD4G27R"},fd=GC().length?el():Tb(T6),zn=IR(fd),re=I4(fd),_g=x6(fd);nL(fd);const S2=new Kn;S2.setCustomParameters({prompt:"select_account"});const Ua=t=>{if(!t||t.trim()==="")return{isValid:!1,error:"Email is required."};if(!t.includes("@"))return{isValid:!1,error:"Email must contain @ symbol."};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return{isValid:!1,error:"Please enter a valid email address."};if(!/\.(com|net|org|edu|gov|co\.za|za|io|me|info|biz)$/i.test(t))return{isValid:!1,error:"Email must have a valid domain (.com, .net, .org, .co.za, etc.)."};const r=t.split("@")[1].toLowerCase(),s={"gmial.com":"gmail.com","gmai.com":"gmail.com","yahooo.com":"yahoo.com","yaho.com":"yahoo.com","outlok.com":"outlook.com","hotmial.com":"hotmail.com"};return s[r]?{isValid:!1,error:`Did you mean ${s[r]}?`}:{isValid:!0}},k2=t=>t.length<8?{isValid:!1,error:"Password must be at least 8 characters long."}:/[A-Z]/.test(t)?/[a-z]/.test(t)?/[0-9]/.test(t)?{isValid:!0}:{isValid:!1,error:"Password must contain at least one number."}:{isValid:!1,error:"Password must contain at least one lowercase letter."}:{isValid:!1,error:"Password must contain at least one uppercase letter."},I6=(t,e)=>t!==e?{isValid:!1,error:"Passwords do not match."}:{isValid:!0},N6=async(t,e)=>{try{const n=Ua(t);if(!n.isValid)throw new Error(n.error);const r=await oP(zn,t,e),s=await En(je(re,"patients",r.user.uid));if(!s.exists())throw new Error("Patient record not found. Please contact support.");return{user:r.user,patientData:s.data()}}catch(n){throw console.error("Login error:",n),new Error(md(n.code))}},S6=async(t,e,n,r)=>{try{console.log("Starting signup process for:",t);const s=Ua(t);if(!s.isValid)throw new Error(s.error);const i=k2(e);if(!i.isValid)throw new Error(i.error);console.log("Creating user account...");const o=await iP(zn,t,e);console.log("User account created with UID:",o.user.uid),console.log("Sending verification/welcome email..."),await aP(o.user),console.log(" Welcome/verification email sent successfully to:",t),console.log("Updating user profile..."),await Xb(o.user,{displayName:n}),console.log("Profile updated successfully");const l=(r==null?void 0:r.firstName)||n.split(" ")[0]||n,u=(r==null?void 0:r.lastName)||n.split(" ").slice(1).join(" ")||"";console.log("Creating patient record in Firestore...");const d={name:n,firstName:l,lastName:u,email:t,createdAt:ye(),lastVisit:ye(),role:"patient",status:"active",emailVerified:!1,...r};await fu(je(re,"patients",o.user.uid),d),console.log("Patient record created successfully"),console.log("Creating user record in users collection...");const h={id:o.user.uid,uid:o.user.uid,email:t,firstName:l,lastName:u,displayName:n,role:"patient",isActive:!0,authMethod:"email",createdAt:ye()};if(await fu(je(re,"users",o.user.uid),h),console.log(" User record created in users collection for Admin App"),!(await En(je(re,"patients",o.user.uid))).exists())throw console.error("CRITICAL: Patient document not found after creation!"),new Error("Failed to create patient record. Please try again.");console.log("Patient record verified in database");try{const{sendWelcomeEmail:g}=await ts(async()=>{const{sendWelcomeEmail:v}=await Promise.resolve().then(()=>pd);return{sendWelcomeEmail:v}},[]);await g(t,n,o.user.uid),console.log("Welcome email sent successfully")}catch(g){console.error("Failed to send welcome email:",g)}return o.user}catch(s){throw console.error("Signup error:",s),console.error("Error code:",s.code),console.error("Error message:",s.message),s.code==="permission-denied"?new Error("Database permission error. Please contact support. Your account may have been created but needs verification."):new Error(md(s.code))}},k6=async()=>{try{console.log("Starting Google sign-in...");const t=await DP(zn,S2);console.log("Google sign-in successful, UID:",t.user.uid);const e=await En(je(re,"patients",t.user.uid));if(console.log("Patient document exists:",e.exists()),e.exists())return console.log("Updating last visit for existing user..."),await fu(je(re,"patients",t.user.uid),{lastVisit:ye()},{merge:!0}),console.log("Last visit updated"),{user:t.user,patientData:e.data()};{console.log("Creating new patient record for Google user...");const n={name:t.user.displayName||"Google User",email:t.user.email,photoURL:t.user.photoURL,createdAt:ye(),lastVisit:ye(),role:"patient",status:"active"};if(await fu(je(re,"patients",t.user.uid),n),console.log("New patient record created"),!(await En(je(re,"patients",t.user.uid))).exists())throw console.error("CRITICAL: Patient document not found after creation!"),new Error("Failed to create patient record. Please try again.");return console.log("Patient record verified in database"),{user:t.user,patientData:n}}}catch(t){throw console.error("Google login error:",t),console.error("Error code:",t.code),console.error("Error message:",t.message),t.code==="permission-denied"?new Error("Database permission error. Please contact support. Your account may have been created but needs verification."):new Error(md(t.code))}},Nw=async()=>{try{await fP(zn)}catch(t){throw console.error("Logout error:",t),new Error("Failed to logout. Please try again.")}},C6=async t=>{try{const e=Ua(t);if(!e.isValid)throw new Error(e.error);console.log(" Attempting to send password reset email to:",t),await sP(zn,t),console.log(" Firebase password reset email sent successfully to:",t);try{const{sendPasswordResetNotification:n}=await ts(async()=>{const{sendPasswordResetNotification:o}=await Promise.resolve().then(()=>pd);return{sendPasswordResetNotification:o}},void 0),r=Ae(re,"patients"),s=qn(r,yr("email","==",t),ig(1)),i=await ys(s);if(i.empty)console.log(" No patient record found for email:",t);else{const o=i.docs[0].data(),l=i.docs[0].id,u=o.name||"Patient";await n(t,u,l),console.log(" Password reset notification logged to Firestore")}}catch(n){console.error(" Failed to log password reset notification to Firestore:",n)}return{success:!0,message:`Password reset email sent to ${t}. Please check your inbox and spam folder.`}}catch(e){throw console.error(" Password reset error:",e),new Error(md(e.code))}},A6=t=>hP(zn,t),md=t=>({"auth/user-not-found":"No account found with this email.","auth/wrong-password":"Incorrect password. Please try again.","auth/email-already-in-use":"An account with this email already exists.","auth/weak-password":"Password should be at least 6 characters.","auth/invalid-email":"Invalid email address.","auth/user-disabled":"This account has been disabled.","auth/too-many-requests":"Too many attempts. Please try again later.","auth/network-request-failed":"Network error. Please check your connection.","auth/popup-closed-by-user":"Sign-in popup was closed.","auth/cancelled-popup-request":"Only one popup request is allowed at a time.","auth/operation-not-allowed":"This sign-in method is not enabled. Please contact support.","permission-denied":"Database permission error. Please contact support."})[t]||"An error occurred. Please try again.",yu=async t=>{try{const e=qn(Ae(re,"appointments"),yr("patientId","==",t),si("date","desc"));return(await ys(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){throw console.error("Error fetching appointments:",e),e}},P6=async t=>{try{console.log("bookAppointment called with:",t),console.log("Firebase db instance:",re);const{getServicePrice:e}=await ts(async()=>{const{getServicePrice:l}=await Promise.resolve().then(()=>bg);return{getServicePrice:l}},void 0),n=e(t.type)||{basePrice:500,name:t.type},r=await Ft(Ae(re,"appointments"),{...t,amount:n.basePrice,paymentStatus:"pending",paymentMethod:"",paymentTransactionId:"",paidAt:null,createdAt:ye(),updatedAt:ye()});console.log("Document created with ID:",r.id);const s={patientId:t.patientId,patientName:t.patientName,patientEmail:t.patientEmail||"",appointmentId:r.id,amount:n.basePrice,description:`${t.type} - ${t.doctorName}`,service:t.type,status:"Pending",date:new Date().toISOString(),dueDate:t.date,invoiceNumber:`INV-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,createdAt:ye()},i=await Ft(Ae(re,"invoices"),s);console.log("Invoice created with ID:",i.id);const{sendInvoiceCreatedEmail:o}=await ts(async()=>{const{sendInvoiceCreatedEmail:l}=await Promise.resolve().then(()=>pd);return{sendInvoiceCreatedEmail:l}},void 0);return await o(t.patientEmail||"",t.patientName,t.patientId,s.invoiceNumber,n.basePrice,t.date,[t.type]),r.id}catch(e){throw console.error("Error booking appointment:",e),console.error("Error details:",JSON.stringify(e,null,2)),e}},R6=async(t,e=!0)=>{var n;try{const r=je(re,"appointments",t),s=await En(r);if(!s.exists())throw new Error("Appointment not found");const i=s.data();if(await vs(r,{status:"Cancelled",cancelledAt:ye()}),e&&i.patientId){const{createCancellationFeeInvoice:o,getServicePrice:l}=await ts(async()=>{const{createCancellationFeeInvoice:m,getServicePrice:g}=await Promise.resolve().then(()=>bg);return{createCancellationFeeInvoice:m,getServicePrice:g}},void 0),{sendCancellationFeeEmail:u}=await ts(async()=>{const{sendCancellationFeeEmail:m}=await Promise.resolve().then(()=>pd);return{sendCancellationFeeEmail:m}},void 0),d=i.type||i.serviceType,h=l(d);if(h){const m=h.basePrice*.1,g=await o(t,i.patientId);return i.patientEmail&&await u(i.patientEmail,i.patientName||"Patient",i.patientId,i.date,i.time,h.basePrice,m,`INV-${(n=g.id)==null?void 0:n.slice(-8).toUpperCase()}`),{success:!0,invoiceId:g.id,cancellationFee:m}}}return{success:!0}}catch(r){throw console.error("Error cancelling appointment:",r),r}},em=async t=>{try{const e=qn(Ae(re,"documents"),yr("patientId","==",t),si("date","desc"));return(await ys(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){throw console.error("Error fetching documents:",e),e}},j6=async(t,e,n)=>{try{const r=Date.now(),s=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),i=`${r}_${s}`,o=xg(_g,`documents/${t}/${i}`),l=v6(o,e);return new Promise((u,d)=>{l.on("state_changed",h=>{const m=h.bytesTransferred/h.totalBytes*100;n&&n(Math.round(m))},h=>{console.error("Upload error:",h),d(new Error("Upload failed: "+h.message))},async()=>{var h;try{const m=await N2(l.snapshot.ref),g=((h=e.name.split(".").pop())==null?void 0:h.toLowerCase())||"";let v="PDF";["jpg","jpeg","png","gif","webp"].includes(g)?v="Image":["doc","docx"].includes(g)&&(v="Document");const S=Math.round(e.size/1024),N=S<1024?`${S} KB`:`${(S/1024).toFixed(2)} MB`,b=L6(e.name),x=await Ft(Ae(re,"documents"),{patientId:t,name:e.name,type:v,size:N,sizeBytes:e.size,fileUrl:m,url:m,storagePath:`documents/${t}/${i}`,date:new Date().toISOString().split("T")[0],uploadedAt:ye(),category:b});console.log("Document uploaded successfully:",x.id),u(x.id)}catch(m){console.error("Error saving document metadata:",m),d(new Error("Failed to save document: "+m.message))}})})}catch(r){throw console.error("Upload initialization error:",r),new Error("Failed to initialize upload: "+r.message)}},D6=async(t,e)=>{try{const n=xg(_g,e);await w6(n),await O4(je(re,"documents",t)),console.log("Document deleted successfully")}catch(n){throw console.error("Error deleting document:",n),new Error("Failed to delete document: "+n.message)}},L6=t=>{const e=t.toLowerCase();return e.includes("report")?"Report":e.includes("lab")||e.includes("test")?"Lab Result":e.includes("prescription")||e.includes("rx")?"Prescription":e.includes("imaging")||e.includes("scan")||e.includes("xray")?"Imaging":"General"},M6=async(t,e)=>{try{const n=qn(Ae(re,"chats"),yr("patientId","==",t),ig(1)),r=await ys(n);if(!r.empty)return r.docs[0].id;let s=e;try{const o=await En(je(re,"users",t));if(o.exists()){const l=o.data();l.firstName&&l.lastName?s=`${l.firstName} ${l.lastName}`:l.firstName?s=l.firstName:l.displayName&&(s=l.displayName),console.log(" Fetched real patient name:",s)}else{const l=await En(je(re,"patients",t));if(l.exists()){const u=l.data();u.firstName&&u.lastName?s=`${u.firstName} ${u.lastName}`:u.name&&(s=u.name)}}}catch(o){console.warn("Could not fetch patient name, using fallback:",o)}const i=await Ft(Ae(re,"chats"),{patientId:t,patientName:s,lastMessageText:"",lastMessageTimestamp:ye(),unreadByPatient:0,unreadByAdmin:!1});return console.log(" Chat created with patient name:",s),i.id}catch(n){throw console.error("Error getting/creating chat:",n),n}},O6=async t=>{try{const e=qn(Ae(re,`chats/${t}/messages`),si("timestamp","asc"));return(await ys(e)).docs.map(r=>({id:r.id,chatId:t,...r.data()}))}catch(e){throw console.error("Error fetching messages:",e),e}},V6=async(t,e,n,r)=>{try{const s=await Ft(Ae(re,`chats/${t}/messages`),{senderId:e,text:n,timestamp:ye(),read:!1});await vs(je(re,"chats",t),{lastMessageText:n,lastMessageTimestamp:ye(),unreadByAdmin:e!=="admin"});try{const{notifyMessageRecipient:i}=await ts(async()=>{const{notifyMessageRecipient:o}=await import("./message-notification-service-B2DyKk6c.js");return{notifyMessageRecipient:o}},[]);await i(t,e,r||"Patient","patient",n)}catch(i){console.warn(" Failed to send message notification:",i)}return s.id}catch(s){throw console.error("Error sending message:",s),s}},F6=async t=>{try{await vs(je(re,"chats",t),{unreadByPatient:0})}catch(e){throw console.error("Error marking messages as read:",e),e}},U6=(t,e)=>{const n=qn(Ae(re,`chats/${t}/messages`),si("timestamp","asc"));return VE(n,r=>{const s=r.docs.map(i=>({id:i.id,chatId:t,...i.data()}));e(s)})},$a=async t=>{try{const e=await En(je(re,"patients",t));return e.exists()?{id:e.id,...e.data()}:null}catch(e){throw console.error("Error fetching patient profile:",e),e}},Vi=async(t,e)=>{try{await vs(je(re,"patients",t),e)}catch(n){throw console.error("Error updating patient profile:",n),n}},C2=A.createContext(void 0),lt=()=>{const t=A.useContext(C2);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},$6=({children:t})=>{const[e,n]=A.useState(null),[r,s]=A.useState(!0),[i,o]=A.useState([]);A.useEffect(()=>A6(async N=>{if(N)try{const b=await $a(N.uid);n({...N,displayName:(b==null?void 0:b.name)||N.displayName||"Patient",photoURL:(b==null?void 0:b.photoURL)||N.photoURL||`https://ui-avatars.com/api/?name=${(b==null?void 0:b.name)||"P"}&background=F4E48E&color=3A565B`})}catch(b){console.error("Failed to fetch patient profile",b),n({...N,displayName:N.displayName||"Patient",photoURL:N.photoURL||`https://ui-avatars.com/api/?name=${N.displayName||"P"}&background=F4E48E&color=3A565B`})}else n(null);s(!1)}),[]),A.useEffect(()=>{const S=()=>{e&&Nw()};return window.addEventListener("beforeunload",S),()=>{window.removeEventListener("beforeunload",S)}},[e]);const l=async(S,N)=>{await N6(S,N)},u=async(S,N,b,x)=>{await S6(S,N,b,x)},d=async()=>{await Nw()},h=async()=>{if(e)try{const S=await $a(e.uid);S&&n({...e,displayName:S.name||e.displayName||"Patient",photoURL:S.photoURL||e.photoURL||`https://ui-avatars.com/api/?name=${S.name||"P"}&background=F4E48E&color=3A565B`})}catch(S){console.error("Failed to refresh user data:",S)}},m=A.useCallback((S,N="info")=>{const b=Math.random().toString(36).substr(2,9);o(x=>[...x,{id:b,message:S,type:N}]),setTimeout(()=>g(b),5e3)},[]),g=S=>{o(N=>N.filter(b=>b.id!==S))},v={user:e,loading:r,login:l,signup:u,logout:d,refreshUser:h,showToast:m,toasts:i,removeToast:g};return a.jsx(C2.Provider,{value:v,children:t})},Sw=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),zt=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),a.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),a.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),Ct=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",x2:"8",y1:"13",y2:"13"}),a.jsx("line",{x1:"16",x2:"8",y1:"17",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),tm=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),B6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),z6=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("polyline",{points:"9 18 15 12 9 6"})}),q6=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("polyline",{points:"15 18 9 12 15 6"})}),ir=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),A2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("rect",{width:"20",height:"14",x:"2",y:"5",rx:"2"}),a.jsx("line",{x1:"2",x2:"22",y1:"10",y2:"10"})]}),Dn=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),P2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",x2:"12",y1:"15",y2:"3"})]}),Ba=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),R2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),a.jsx("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"})]}),_c=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),a.jsx("polyline",{points:"22 6 12 13 2 6"})]}),Gt=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("polyline",{points:"20 6 9 17 4 12"})}),vu=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]}),H6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),za=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),W6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),j2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),G6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("line",{x1:"3",x2:"21",y1:"12",y2:"12"}),a.jsx("line",{x1:"3",x2:"21",y1:"6",y2:"6"}),a.jsx("line",{x1:"3",x2:"21",y1:"18",y2:"18"})]}),kw=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),D2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),a.jsx("polyline",{points:"17 6 23 6 23 12"})]}),L2=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})}),M2=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),O2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),a.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),V2=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),F2=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),qa=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Cw=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),a.jsx("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),a.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),a.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),nm=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),a.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),K6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",x2:"12",y1:"3",y2:"15"})]}),Q6=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"})}),Aw=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),a.jsx("path",{d:"M22 2 11 13"})]}),Y6=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"})}),X6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"m22 8-6 4 6 4V8Z"}),a.jsx("rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2"})]}),J6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("circle",{cx:"12",cy:"12",r:"1"}),a.jsx("circle",{cx:"12",cy:"5",r:"1"}),a.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),Z6=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),a.jsx("line",{x1:"9",x2:"9.01",y1:"9",y2:"9"}),a.jsx("line",{x1:"15",x2:"15.01",y1:"9",y2:"9"})]}),eM=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("line",{x1:"12",x2:"12",y1:"2",y2:"22"}),a.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Ch=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),a.jsx("path",{d:"m15 5 4 4"})]}),tM=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),a.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),Pw=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),Rw=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"})}),jw=({className:t})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:a.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),ua=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),nM=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}),a.jsx("path",{d:"M9 22v-4h6v4"}),a.jsx("path",{d:"M8 6h.01"}),a.jsx("path",{d:"M16 6h.01"}),a.jsx("path",{d:"M12 6h.01"}),a.jsx("path",{d:"M12 10h.01"}),a.jsx("path",{d:"M12 14h.01"}),a.jsx("path",{d:"M16 10h.01"}),a.jsx("path",{d:"M16 14h.01"}),a.jsx("path",{d:"M8 10h.01"}),a.jsx("path",{d:"M8 14h.01"})]}),rM=({className:t})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[a.jsx("rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("path",{d:"M6 12h.01M18 12h.01"})]}),U2=async(t,e,n,r,s,i,o)=>{try{const l="Payment Successful - Dermaglare Skin & Laser Clinic",u=`
Dear ${e},

Thank you for your payment!

Payment Details:

Invoice Number: ${r}
Amount Paid: R${s.toFixed(2)}
Payment Method: ${o}
Transaction ID: ${i}
Date: ${new Date().toLocaleString("en-ZA",{timeZone:"Africa/Johannesburg"})}

Your payment has been successfully processed and your invoice has been marked as paid.

You can view your invoice and payment history in your patient portal at any time.

If you have any questions about this payment, please don't hesitate to contact us at:
 info@dermaglareskin.co.za
 +27 11 234 5678

Thank you for choosing Dermaglare Skin & Laser Clinic!

Best regards,
Dermaglare Team


This is an automated email. Please do not reply.
    `.trim(),d={to:t,subject:l,body:u,type:"payment_success",patientId:n,relatedId:i,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),d),console.log(" Payment success email sent to:",t),console.log("Subject:",l),console.log(`
Email body:
`,u),!0}catch(l){return console.error("Error sending payment success email:",l),!1}},$2=async(t,e,n,r,s,i)=>{try{const o="Payment Failed - Dermaglare Skin & Laser Clinic",l=`
Dear ${e},

We were unable to process your payment.

Payment Details:

Invoice Number: ${r}
Amount: R${s.toFixed(2)}
Reason: ${i}
Date: ${new Date().toLocaleString("en-ZA",{timeZone:"Africa/Johannesburg"})}

Please try again or use a different payment method. Your invoice remains unpaid and can be accessed in your patient portal.

If you continue to experience issues, please contact us:
 info@dermaglareskin.co.za
 +27 11 234 5678

Thank you for your understanding.

Best regards,
Dermaglare Team


This is an automated email. Please do not reply.
    `.trim(),u={to:t,subject:o,body:l,type:"payment_failed",patientId:n,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),u),console.log(" Payment failed email sent to:",t),!0}catch(o){return console.error("Error sending payment failed email:",o),!1}},sM=async(t,e,n,r,s,i,o)=>{try{const l="New Invoice - Dermaglare Skin & Laser Clinic",u=`
Dear ${e},

A new invoice has been generated for your recent visit.

Invoice Details:

Invoice Number: ${r}
Amount Due: R${s.toFixed(2)}
Due Date: ${new Date(i).toLocaleDateString("en-ZA")}

Services:
${o.map((h,m)=>`${m+1}. ${h}`).join(`
`)}

You can view and pay your invoice online through your patient portal.

Payment Options:
 Credit/Debit Card (Instant)
 EFT (1-3 business days)
 Cash (In-person)

Please ensure payment is made by the due date to avoid any additional charges.

Questions? Contact us:
 info@dermaglareskin.co.za
 +27 11 234 5678

Thank you for choosing Dermaglare!

Best regards,
Dermaglare Team


This is an automated email. Please do not reply.
    `.trim(),d={to:t,subject:l,body:u,type:"invoice_created",patientId:n,relatedId:r,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),d),console.log(" Invoice created email sent to:",t),!0}catch(l){return console.error("Error sending invoice created email:",l),!1}},iM=async(t,e,n,r,s,i,o,l)=>{try{const u="Appointment Cancellation Fee - Dermaglare Skin & Laser Clinic",d=`
Dear ${e},

Your appointment has been cancelled and a cancellation fee has been applied.

Cancellation Details:

Original Appointment: ${new Date(r).toLocaleDateString("en-ZA")} at ${s}
Consultation Fee: R${i.toFixed(2)}
Cancellation Fee (10%): R${o.toFixed(2)}
Invoice Number: ${l}

As per our cancellation policy, a 10% cancellation fee of the consultation fee has been applied.

This fee helps cover administrative costs and the reserved appointment slot. An invoice has been generated and can be viewed in your patient portal.

To avoid cancellation fees in the future, please:
 Cancel at least 24 hours in advance when possible
 Contact us if you need to reschedule

Payment can be made through:
 Credit/Debit Card (Instant)
 EFT (1-3 business days)
 Cash (In-person)

Questions about our cancellation policy? Contact us:
 info@dermaglareskin.co.za
 +27 11 234 5678

We look forward to serving you in the future.

Best regards,
Dermaglare Team


This is an automated email. Please do not reply.
    `.trim(),h={to:t,subject:u,body:d,type:"cancellation_fee",patientId:n,relatedId:l,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),h),console.log(" Cancellation fee email sent to:",t),!0}catch(u){return console.error("Error sending cancellation fee email:",u),!1}},oM=async(t,e,n)=>{try{const r="Welcome to Dermaglare Skin & Laser Clinic!",s=`
Dear ${e},

Welcome to Dermaglare Skin & Laser Clinic! 

Thank you for registering with us. We're excited to have you as part of our community dedicated to exceptional skin health and beauty care.

Your Patient Portal Account

Email: ${t}
Portal: ${window.location.origin}

With your patient portal, you can:
 Book and manage appointments 24/7
 View and pay invoices online
 Access your medical documents
 Message our support team
 Update your profile information
 Track your health records

Getting Started:
1. Verify your email address (check your inbox)
2. Complete your profile with medical information
3. Book your first appointment
4. Explore the dashboard features

Our Services:
 Medical Dermatology
 Cosmetic Dermatology
 Laser Treatments
 Skin Surgery
 Anti-Aging Treatments
 Acne & Scar Treatment

Need Help?
Our team is here to assist you with any questions or concerns.
 info@dermaglareskin.co.za
 +27 11 234 5678
 www.dermaglareskin.co.za

Office Hours:
Monday - Friday: 8:00 AM - 5:00 PM
Saturday: 9:00 AM - 1:00 PM
Sunday: Closed

We look forward to serving you and helping you achieve your skin health goals!

Best regards,
Dr. Jabu Nkehli & The Dermaglare Team


This is an automated email. Please do not reply.
    `.trim(),i={to:t,subject:r,body:s,type:"welcome",patientId:n,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),i),console.log(" Welcome email sent to:",t),!0}catch(r){return console.error("Error sending welcome email:",r),!1}},aM=async(t,e,n)=>{try{const r="Password Reset Request - Dermaglare Patient Portal",s=`
Dear ${e},

We received a request to reset your password for your Dermaglare Patient Portal account.

Account Information:

Email: ${t}
Request Time: ${new Date().toLocaleString("en-ZA",{timeZone:"Africa/Johannesburg"})}

A password reset email has been sent to your email address from Firebase Authentication. Please check your inbox and follow the instructions to reset your password.

If you didn't request this password reset:
 Your account is still secure
 No changes have been made
 You can safely ignore this email
 Consider changing your password if you're concerned

Security Tips:
 Use a strong, unique password
 Never share your password
 Enable two-factor authentication
 Log out from shared devices
 Keep your email secure

If you have any concerns about your account security, please contact us immediately:
 info@dermaglareskin.co.za
 +27 11 234 5678

Best regards,
Dermaglare Security Team


This is an automated email. Please do not reply.
    `.trim(),i={to:t,subject:r,body:s,type:"password_reset",patientId:n,sentAt:ye(),status:"sent"};return await Ft(Ae(re,"email_notifications"),i),console.log(" Password reset notification email sent to:",t),!0}catch(r){return console.error("Error sending password reset notification email:",r),!1}},pd=Object.freeze(Object.defineProperty({__proto__:null,sendCancellationFeeEmail:iM,sendInvoiceCreatedEmail:sM,sendPasswordResetNotification:aM,sendPaymentFailedEmail:$2,sendPaymentSuccessEmail:U2,sendWelcomeEmail:oM},Symbol.toStringTag,{value:"Module"})),B2=[{id:"consultation",name:"Standard Consultation",basePrice:1300,duration:"30 min",description:"Comprehensive skin assessment and treatment plan",category:"medical"},{id:"medical_dermatology",name:"Medical Dermatology",basePrice:1500,duration:"30 min",description:"Treatment of skin conditions",category:"medical"},{id:"cosmetic_dermatology",name:"Cosmetic Dermatology",basePrice:1600,duration:"30-60 min",description:"Aesthetic treatments and procedures",category:"cosmetic"},{id:"laser_treatment",name:"Laser Treatment",basePrice:3500,duration:"45-60 min",description:"Advanced laser procedures",category:"cosmetic"},{id:"chemical_peel",name:"Chemical Peel",basePrice:1800,duration:"30-45 min",description:"Chemical peels for skin renewal",category:"cosmetic"},{id:"microneedling",name:"Microneedling",basePrice:1900,duration:"45 min",description:"Collagen induction therapy",category:"cosmetic"},{id:"botox",name:"Botox Injections",basePrice:4500,duration:"20-30 min",description:"Anti-aging wrinkle treatment",category:"cosmetic"},{id:"prp_therapy",name:"Platelet-Rich Plasma (PRP)",basePrice:3200,duration:"45-60 min",description:"PRP therapy for skin rejuvenation",category:"specialty"},{id:"skin_tightening",name:"Skin Tightening",basePrice:2200,duration:"45-60 min",description:"Non-surgical skin firming",category:"cosmetic"},{id:"mole_removal",name:"Mole Removal",basePrice:1800,duration:"30 min",description:"Surgical removal of moles",category:"surgical"},{id:"skin_cancer_screening",name:"Skin Cancer Screening",basePrice:1750,duration:"30 min",description:"Comprehensive skin cancer examination",category:"medical"},{id:"acne_treatment",name:"Acne Treatment",basePrice:1650,duration:"30 min",description:"Specialized acne management",category:"medical"},{id:"paediatric_dermatology",name:"Paediatric Dermatology",basePrice:1450,duration:"30-45 min",description:"Specialized skin care for children",category:"specialty"}],z2=t=>B2.find(e=>e.id===t.toLowerCase().replace(/\s+/g,"_")||e.name.toLowerCase()===t.toLowerCase()),rm=()=>{const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`INV-${e}${n}-${r}`},q2=async t=>{try{const e=Ae(re,"invoices"),n=qn(e,yr("patientId","==",t),si("createdAt","desc"));return(await ys(n)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){return console.error("Error fetching patient invoices:",e),[]}},sm=async t=>{try{const e=je(re,"invoices",t),n=await En(e);return n.exists()?{id:n.id,...n.data()}:null}catch(e){return console.error("Error fetching invoice:",e),null}},lM=(t=2e3)=>new Promise(e=>setTimeout(e,t)),cM=()=>{const t=Date.now(),e=Math.floor(Math.random()*1e5);return`TXN-${t}-${e}`},uM=t=>{const e=t.replace(/\s+/g,"");if(!/^\d{13,19}$/.test(e))return!1;let n=0,r=!1;for(let s=e.length-1;s>=0;s--){let i=parseInt(e[s]);r&&(i*=2,i>9&&(i-=9)),n+=i,r=!r}return n%10===0},H2=async(t,e,n)=>{try{if(!uM(e.cardNumber))return{success:!1,message:"Invalid card number"};const r=new Date;if(new Date(parseInt(`20${e.expiryYear}`),parseInt(e.expiryMonth)-1)<r)return{success:!1,message:"Card has expired"};if(!/^\d{3,4}$/.test(e.cvv))return{success:!1,message:"Invalid CVV"};const i=await sm(t);if(!i)return{success:!1,message:"Invoice not found"};if(i.status==="paid")return{success:!1,message:"Invoice already paid"};if(await lM(2e3),Math.random()<.1){const m={invoiceId:t,amount:i.amount,currency:"ZAR",status:"failed",paymentMethod:"card",createdAt:ye(),updatedAt:ye()};return await Ft(Ae(re,"payment_intents"),m),await $2(n,i.patientName,i.patientId,rm(),i.amount,"Payment declined by bank"),{success:!1,message:"Payment declined by bank. Please try again or use a different card."}}const l=cM(),u={invoiceId:t,amount:i.amount,currency:"ZAR",status:"succeeded",paymentMethod:"card",createdAt:ye(),updatedAt:ye()};await Ft(Ae(re,"payment_intents"),u);const d=je(re,"invoices",t);await vs(d,{status:"paid",paymentMethod:"card",transactionId:l,paidAt:new Date().toISOString(),updatedAt:ye()});const h=await sm(t);return await U2(n,i.patientName,i.patientId,rm(),i.amount,l,"Credit/Debit Card"),{success:!0,transactionId:l,message:"Payment processed successfully",invoice:h}}catch(r){return console.error("Error processing card payment:",r),{success:!1,message:"Payment processing failed. Please try again."}}},dM=async(t,e)=>{try{const n=je(re,"appointments",t),r=await En(n);if(!r.exists())throw new Error("Appointment not found");const s=r.data(),i=s.type||s.serviceType,o=z2(i);if(!o)throw new Error(`Service pricing not found for: ${i}`);const l=o.basePrice*.1,u={serviceId:"cancellation_fee",serviceName:`Cancellation Fee (10% of ${o.name})`,price:l,quantity:1,total:l},d=je(re,"patients",e),h=await En(d),m=h.exists()?h.data().name:s.patientName||"Unknown Patient",g=new Date,v=new Date;v.setDate(v.getDate()+7);const S={patientId:e,patientName:m,amount:l,status:"pending",date:g.toISOString().split("T")[0],dueDate:v.toISOString().split("T")[0],services:[u],description:`Cancellation Fee - Appointment on ${s.date} at ${s.time}`,appointmentId:t,createdAt:ye(),updatedAt:ye()},N=Ae(re,"invoices"),b=await Ft(N,S);return await vs(n,{cancellationFeeInvoiceId:b.id,cancellationFeeApplied:!0,cancellationFeeAmount:l}),{id:b.id,...S}}catch(n){throw console.error("Error creating cancellation fee invoice:",n),n}},bg=Object.freeze(Object.defineProperty({__proto__:null,SERVICE_PRICES:B2,createCancellationFeeInvoice:dM,generateInvoiceNumber:rm,getInvoice:sm,getPatientInvoices:q2,getServicePrice:z2,processCardPayment:H2},Symbol.toStringTag,{value:"Module"})),hM=({invoice:t,onClose:e,onSuccess:n})=>{var B;const{user:r,showToast:s}=lt(),[i,o]=A.useState("card"),[l,u]=A.useState(!1),[d,h]=A.useState(0),[m,g]=A.useState(""),[v,S]=A.useState(""),[N,b]=A.useState(""),[x,y]=A.useState(""),[E,R]=A.useState(""),[P,O]=A.useState(""),[T,w]=A.useState(""),[I,C]=A.useState(""),[j,D]=A.useState(""),[k,H]=A.useState("");if(!t)return null;const J=F=>(F.replace(/\s+/g,"").match(/.{1,4}/g)||[]).join(" "),G=F=>{const L=F.target.value.replace(/\s+/g,"");L.length<=16&&/^\d*$/.test(L)&&g(L)},z=async()=>{if(!t.id||!(r!=null&&r.email)){s("Missing payment information","error");return}u(!0),h(0);try{const F=setInterval(()=>{h(L=>L>=90?(clearInterval(F),90):L+10)},200);if(i==="card"){if(!m||!v||!N||!x||!E){s("Please fill in all card details","error"),u(!1),clearInterval(F);return}const L=await H2(t.id,{cardNumber:m,expiryMonth:N,expiryYear:x,cvv:E,cardholderName:v},r.email);clearInterval(F),h(100),L.success?(s(` Payment successful! Confirmation email sent to ${r.email}`,"success"),setTimeout(()=>{n(),e()},1e3)):(s(L.message,"error"),u(!1),h(0))}else if(i==="eft"){if(!P||!T||!I||!j){s("Please fill in all EFT details","error"),u(!1),clearInterval(F);return}clearInterval(F),h(100),s("EFT payment initiated. Please allow 1-3 business days for processing.","success"),setTimeout(()=>{e()},2e3)}else if(i==="cash"){if(!k||parseFloat(k)<t.amount){s("Insufficient cash amount","error"),u(!1),clearInterval(F);return}clearInterval(F),h(100),s("Cash payment recorded successfully","success"),setTimeout(()=>{n(),e()},1e3)}}catch(F){console.error("Payment error:",F),s("Payment processing failed. Please try again.","error"),u(!1),h(0)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-brand-teal to-brand-dark text-white p-6 flex items-center justify-between rounded-t-2xl",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Payment Gateway"}),a.jsxs("p",{className:"text-white/80 mt-1",children:["Secure payment processing for Invoice #",(B=t.id)==null?void 0:B.slice(-8)]})]}),a.jsx("button",{onClick:e,disabled:l,className:"p-2 hover:bg-white/20 rounded-lg transition-colors disabled:opacity-50",children:a.jsx(ir,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-brand-light to-white border border-brand-teal/20 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Amount Due:"}),a.jsxs("span",{className:"text-3xl font-bold text-brand-dark",children:["R",t.amount.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Service:"})," ",t.description||t.service||"Medical Services"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleDateString()]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Payment Method"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{id:"card",icon:A2,label:"Card"},{id:"eft",icon:nM,label:"EFT"},{id:"cash",icon:rM,label:"Cash"}].map(F=>a.jsxs("button",{onClick:()=>o(F.id),disabled:l,className:`p-4 rounded-xl border-2 transition-all duration-300 ${i===F.id?"border-brand-teal bg-brand-light text-brand-teal shadow-lg":"border-gray-200 hover:border-brand-teal/50"} disabled:opacity-50`,children:[a.jsx(F.icon,{className:"w-8 h-8 mx-auto mb-2"}),a.jsx("span",{className:"text-sm font-semibold",children:F.label})]},F.id))})]}),i==="card"&&a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Card Number"}),a.jsx("input",{type:"text",value:J(m),onChange:G,placeholder:"1234 5678 9012 3456",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 font-mono"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cardholder Name"}),a.jsx("input",{type:"text",value:v,onChange:F=>S(F.target.value),placeholder:"John Doe",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Month"}),a.jsx("input",{type:"text",value:N,onChange:F=>{const L=F.target.value;/^\d{0,2}$/.test(L)&&parseInt(L||"0")<=12&&b(L)},placeholder:"MM",disabled:l,maxLength:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 text-center font-mono"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Year"}),a.jsx("input",{type:"text",value:x,onChange:F=>{const L=F.target.value;/^\d{0,2}$/.test(L)&&y(L)},placeholder:"YY",disabled:l,maxLength:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 text-center font-mono"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"CVV"}),a.jsx("input",{type:"text",value:E,onChange:F=>{const L=F.target.value;/^\d{0,4}$/.test(L)&&R(L)},placeholder:"123",disabled:l,maxLength:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 text-center font-mono"})]})]})]}),i==="eft"&&a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Account Holder Name"}),a.jsx("input",{type:"text",value:P,onChange:F=>O(F.target.value),placeholder:"John Doe",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Account Number"}),a.jsx("input",{type:"text",value:T,onChange:F=>w(F.target.value),placeholder:"1234567890",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 font-mono"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Bank Name"}),a.jsx("input",{type:"text",value:I,onChange:F=>C(F.target.value),placeholder:"Standard Bank",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Branch Code"}),a.jsx("input",{type:"text",value:j,onChange:F=>D(F.target.value),placeholder:"051001",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 font-mono"})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Note:"})," EFT payments typically take 1-3 business days to process. You will receive a confirmation email once the payment is verified."]})})]}),i==="cash"&&a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cash Amount (R)"}),a.jsx("input",{type:"number",value:k,onChange:F=>H(F.target.value),placeholder:t.amount.toFixed(2),disabled:l,min:t.amount,step:"0.01",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-teal focus:border-transparent disabled:bg-gray-100 font-mono text-lg"})]}),k&&parseFloat(k)>t.amount&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-sm text-green-800",children:[a.jsx("strong",{children:"Change Due:"})," R",(parseFloat(k)-t.amount).toFixed(2)]})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Note:"})," Cash payments must be made in person at our clinic. This form records the payment for our records."]})})]}),l&&a.jsxs("div",{className:"space-y-2 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Processing payment..."}),a.jsxs("span",{className:"font-semibold text-brand-teal",children:[d,"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-brand-teal to-brand-dark transition-all duration-300 ease-out",style:{width:`${d}%`}})})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:e,disabled:l,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:z,disabled:l,type:"button",className:"flex-1 px-6 py-3 bg-gradient-to-r from-brand-teal to-brand-dark text-white rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50 disabled:transform-none flex items-center justify-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-5 h-5"}),"Pay R",t.amount.toFixed(2)]})})]}),a.jsx("div",{className:"text-center text-xs text-gray-500 pt-2",children:" Secure payment processing powered by Dermaglare Payment Gateway"})]})]})})},fM=()=>{const{user:t,showToast:e}=lt(),[n,r]=A.useState("invoices"),[s,i]=A.useState([]),[o,l]=A.useState(!0),[u,d]=A.useState(null),[h,m]=A.useState(!1),g=async()=>{if(t!=null&&t.uid)try{l(!0);const O=(await q2(t.uid)).map(T=>{var w,I,C;return{...T,invoiceNumber:`INV-${(w=T.id)==null?void 0:w.slice(-8).toUpperCase()}`,service:T.description||((C=(I=T.services)==null?void 0:I[0])==null?void 0:C.serviceName)||"Medical Service"}});i(O),l(!1)}catch(P){console.error("Error fetching invoices:",P),e("Failed to load invoices","error"),l(!1)}};A.useEffect(()=>{g()},[t]);const v=P=>{switch(P.toLowerCase()){case"paid":return"from-green-500 to-emerald-600";case"pending":return"from-yellow-500 to-orange-600";case"overdue":return"from-red-500 to-rose-600";case"cancelled":return"from-gray-500 to-slate-600";default:return"from-gray-500 to-slate-600"}},S=P=>{switch(P.toLowerCase()){case"paid":return a.jsx(Gt,{className:"w-5 h-5"});case"pending":return a.jsx(Ba,{className:"w-5 h-5"});case"overdue":return a.jsx(R2,{className:"w-5 h-5"});case"cancelled":return a.jsx(ir,{className:"w-5 h-5"});default:return null}},N=s.filter(P=>P.status.toLowerCase()==="paid").reduce((P,O)=>P+O.amount,0),b=s.filter(P=>P.status.toLowerCase()==="pending"||P.status.toLowerCase()==="overdue").reduce((P,O)=>P+O.amount,0),x=s.filter(P=>{const O=new Date(P.date),T=new Date;return O.getMonth()===T.getMonth()&&O.getFullYear()===T.getFullYear()}).reduce((P,O)=>P+O.amount,0),y=P=>{d(P),m(!0)},E=async()=>{g()},R=P=>{const O=`
DERMAGLARE SKIN & LASER CLINIC
Invoice: ${P.invoiceNumber}
Date: ${new Date(P.date).toLocaleDateString()}
Due Date: ${P.dueDate?new Date(P.dueDate).toLocaleDateString():"N/A"}

Patient: ${P.patientName}
Service: ${P.service}
Amount: R${P.amount.toFixed(2)}
Status: ${P.status}

Thank you for choosing Dermaglare!
    `.trim(),T=new Blob([O],{type:"text/plain"}),w=URL.createObjectURL(T),I=document.createElement("a");I.href=w,I.download=`${P.invoiceNumber}.txt`,I.click(),URL.revokeObjectURL(w),e("Invoice downloaded successfully","success")};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8",children:[a.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"Billing & Payments"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Manage your invoices and make secure payments"})]})}),a.jsxs("div",{className:"flex gap-4 animate-slide-in-up",style:{animationDelay:"0.1s"},children:[a.jsx("button",{onClick:()=>r("invoices"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 ${n==="invoices"?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"bg-white text-gray-700 hover:bg-gray-50 shadow"}`,children:"Invoices"}),a.jsx("button",{onClick:()=>r("history"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 ${n==="history"?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"bg-white text-gray-700 hover:bg-gray-50 shadow"}`,children:"Payment History"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[{label:"Total Paid",amount:N,icon:Gt,color:"from-green-500 to-emerald-600",delay:"0.2s"},{label:"Total Pending",amount:b,icon:Ba,color:"from-yellow-500 to-orange-600",delay:"0.3s"},{label:"Total Invoices",amount:s.length,icon:Ct,color:"from-blue-500 to-cyan-600",delay:"0.4s",isCount:!0},{label:"This Month",amount:x,icon:D2,color:"from-purple-500 to-violet-600",delay:"0.5s"}].map(P=>a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 animate-fade-in-up",style:{animationDelay:P.delay},children:[a.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${P.color} flex items-center justify-center mb-4 animate-pulse-glow`,children:a.jsx(P.icon,{className:"w-6 h-6 text-white"})}),a.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:P.isCount?P.amount:`R${P.amount.toFixed(2)}`}),a.jsx("div",{className:"text-gray-600 font-medium",children:P.label})]},P.label))}),n==="invoices"?a.jsx("div",{className:"space-y-6",children:o?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-b-2 border-brand-teal mb-4"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Loading invoices..."})]})}):s.length===0?a.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center shadow-lg",children:[a.jsx(Ct,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Invoices Found"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any invoices yet."})]}):a.jsx(a.Fragment,{children:a.jsx("div",{className:"grid grid-cols-1 gap-6",children:s.map((P,O)=>a.jsxs("div",{className:"group bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:scale-[1.01] animate-slide-in-up",style:{animationDelay:`${.6+O*.1}s`},children:[a.jsx("div",{className:`h-2 bg-gradient-to-r ${v(P.status)} animate-shimmer`}),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-brand-teal to-brand-dark flex items-center justify-center",children:a.jsx(Ct,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-brand-teal transition-colors duration-300",children:P.invoiceNumber}),a.jsx("p",{className:"text-gray-600",children:P.service})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 mb-1",children:"Invoice Date"}),a.jsx("p",{className:"font-semibold text-gray-800",children:new Date(P.date).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 mb-1",children:"Due Date"}),a.jsx("p",{className:"font-semibold text-gray-800",children:P.dueDate?new Date(P.dueDate).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 mb-1",children:"Amount"}),a.jsxs("p",{className:"font-bold text-2xl text-gray-800",children:["R",P.amount.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-4",children:[a.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r ${v(P.status)} text-white font-semibold`,children:[S(P.status),P.status.charAt(0).toUpperCase()+P.status.slice(1)]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>R(P),className:"px-4 py-2 bg-brand-light text-brand-teal rounded-lg hover:bg-brand-teal hover:text-white font-semibold transform hover:scale-105 transition-all duration-300 flex items-center gap-2",children:[a.jsx(P2,{className:"w-4 h-4"}),"Download"]}),P.status.toLowerCase()!=="paid"&&P.status.toLowerCase()!=="cancelled"&&P.id&&a.jsx("button",{onClick:()=>y(P),className:"px-4 py-2 bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark rounded-lg font-semibold transform hover:scale-105 transition-all duration-300",children:"Pay Now"})]})]})]})})]},P.id))})})}):a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Payment History"}),s.filter(P=>P.status.toLowerCase()==="paid").length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(eM,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No payment history yet."})]}):a.jsx("div",{className:"space-y-4",children:s.filter(P=>P.status.toLowerCase()==="paid").map(P=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-xl hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500 flex items-center justify-center",children:a.jsx(Gt,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:P.invoiceNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:P.service}),a.jsx("p",{className:"text-xs text-gray-500",children:new Date(P.date).toLocaleDateString("en-ZA")})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-xl text-green-600",children:["R",P.amount.toFixed(2)]}),a.jsx("p",{className:"text-xs text-gray-500",children:P.paymentMethod||"Card"})]})]},P.id))})]})}),h&&a.jsx(hM,{invoice:u,onClose:()=>{m(!1),d(null)},onSuccess:E})]})},Go=({children:t,variant:e="primary",size:n="md",className:r="",onClick:s,disabled:i,type:o="button"})=>{const l="relative overflow-hidden font-medium rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 active:scale-95",u={primary:"bg-brand-teal text-white hover:bg-brand-dark shadow-lg hover:shadow-xl hover:shadow-brand-teal/30",secondary:"bg-brand-yellow text-brand-dark hover:bg-yellow-400 shadow-lg hover:shadow-xl hover:shadow-brand-yellow/30",ghost:"bg-transparent text-brand-dark hover:bg-brand-teal/10 hover:text-brand-teal",danger:"bg-red-600 text-white hover:bg-red-700 shadow-lg hover:shadow-xl hover:shadow-red-600/30"},d={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg"},h=m=>{const g=m.currentTarget,v=document.createElement("span"),S=g.getBoundingClientRect(),N=Math.max(S.width,S.height),b=m.clientX-S.left-N/2,x=m.clientY-S.top-N/2;v.style.width=v.style.height=`${N}px`,v.style.left=`${b}px`,v.style.top=`${x}px`,v.classList.add("absolute","bg-white/30","rounded-full","pointer-events-none","animate-ping"),g.appendChild(v),setTimeout(()=>{v.remove()},600),s&&s(m)};return a.jsx("button",{type:o,disabled:i,onClick:h,className:`${l} ${u[e]} ${d[n]} ${r}`,children:a.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2",children:t})})},Yl=({id:t,label:e,type:n="text",placeholder:r,value:s,onChange:i,icon:o,disabled:l,defaultValue:u,error:d,required:h=!1})=>{const[m,g]=A.useState(!1);return a.jsxs("div",{className:"relative group",children:[a.jsx("label",{htmlFor:t,className:`
          block text-sm font-medium mb-2 transition-all duration-300
          ${m?"text-brand-teal":"text-gray-700"}
        `,children:e}),a.jsxs("div",{className:"relative",children:[o&&a.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 transition-all duration-300 group-focus-within:text-brand-teal",children:qw.cloneElement(o,{className:"w-5 h-5"})}),a.jsx("input",{id:t,type:n,placeholder:r,value:s,defaultValue:u,onChange:i,disabled:l,required:h,"aria-invalid":!!d,onFocus:()=>g(!0),onBlur:()=>g(!1),className:`
            w-full px-4 py-3 border-2 rounded-lg
            ${o?"pl-11":""}
            transition-all duration-300
            focus:outline-none focus:border-brand-teal focus:ring-4 focus:ring-brand-teal/20
            disabled:bg-gray-100 disabled:cursor-not-allowed
            hover:border-brand-teal/50
            ${m?"shadow-lg scale-[1.02]":""}
            ${d?"border-red-400 focus:ring-red-200":""}
          `})]}),d&&a.jsx("p",{className:"mt-2 text-sm text-red-600",role:"alert",children:d})]})},mM=()=>{const t=Array.from({length:20});return a.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:t.map((e,n)=>a.jsx("div",{className:"absolute w-2 h-2 bg-brand-teal/30 rounded-full animate-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`,animationDuration:`${5+Math.random()*10}s`}},n))})},pM=({className:t="w-5 h-5"})=>a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),gM=()=>{const{login:t,signup:e,showToast:n}=lt(),[r,s]=A.useState(!0),[i,o]=A.useState(""),[l,u]=A.useState(""),[d,h]=A.useState(""),[m,g]=A.useState(""),[v,S]=A.useState(""),[N,b]=A.useState(""),[x,y]=A.useState(!1),[E,R]=A.useState(!1),[P,O]=A.useState(!1),[T,w]=A.useState(""),[I,C]=A.useState(!1),[j,D]=A.useState(!1),[k,H]=A.useState(!1),[J,G]=A.useState({}),z=async q=>{q.preventDefault(),G({}),y(!0);try{const ee=Ua(i);if(!ee.isValid){G({email:ee.error}),y(!1),n(ee.error||"Invalid email","error");return}if(r)await t(i,l),n("Welcome back! ","success");else{const we=k2(l);if(!we.isValid){G({password:we.error}),y(!1);return}const me=I6(l,d);if(!me.isValid){G({confirmPassword:me.error}),y(!1);return}const pe=v||m.split(" ")[0]||m,Pe=N||m.split(" ").slice(1).join(" ")||"";await e(i,l,m,{firstName:pe,lastName:Pe}),n("Account created successfully!  Please check your email to verify your account.","success")}}catch(ee){console.error("Login/Signup Error:",ee),G({general:ee.message||"Authentication failed"}),n(ee.message||"Authentication failed","error")}finally{y(!1)}},B=async()=>{try{n("Connecting to Google... ","info"),await k6(),n("Google login successful! ","success")}catch(q){console.error("Google Login Error:",q),n(q.message||"Google login failed","error")}},F=async()=>{if(!T){n("Please enter your email address","error");return}const q=Ua(T);if(!q.isValid){n(q.error||"Invalid email","error");return}try{C(!0);const ee=await C6(T);n(ee.message||"Password reset email sent! ","success"),O(!1),w("")}catch(ee){n(ee.message||"Failed to send reset email","error")}finally{C(!1)}},L=()=>{R(!E),G({}),setTimeout(()=>{s(!r)},300)};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-yellow/20 flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx(mM,{}),a.jsx("div",{className:"absolute top-20 left-20 w-64 h-64 bg-brand-teal/10 rounded-full blur-3xl animate-float"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-brand-yellow/20 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-gradient-to-r from-brand-teal/5 to-brand-yellow/5 rounded-full blur-3xl animate-pulse-glow"}),a.jsx("div",{className:"w-full max-w-md relative z-10",style:{perspective:"1000px"},children:a.jsx("div",{className:`relative w-full transition-transform duration-700 transform-style-3d ${E?"rotate-y-180":""}`,style:{transformStyle:"preserve-3d"},children:a.jsxs("div",{className:"relative backdrop-blur-xl bg-white/70 rounded-3xl shadow-2xl p-8 border border-white/50 animate-scale-in",children:[a.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-r from-brand-teal/20 via-brand-yellow/20 to-brand-teal/20 animate-shimmer",style:{backgroundSize:"200% 100%",filter:"blur(20px)",zIndex:-1}}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsxs("div",{className:"relative inline-block mb-6 animate-slide-up",children:[a.jsx("div",{className:"relative p-4 bg-white rounded-3xl shadow-2xl animate-pulse-glow",children:a.jsx("img",{src:"https://dermaglareskin.co.za/wp-content/uploads/2023/07/Dermaglare-Skin.png",alt:"Dermaglare Skin",className:"h-16 w-auto object-contain"})}),a.jsx("div",{className:"absolute inset-0 border-4 border-brand-yellow/30 rounded-3xl animate-ping"}),a.jsx("div",{className:"absolute inset-0 border-2 border-brand-teal/20 rounded-3xl animate-pulse",style:{animationDelay:"0.5s"}})]}),a.jsx("h1",{className:"text-4xl font-bold text-brand-dark mb-2 animate-slide-up",style:{animationDelay:"100ms"},children:r?"Welcome Back!":"Join Dermaglare"}),a.jsx("p",{className:"text-gray-600 animate-slide-up",style:{animationDelay:"200ms"},children:r?"Continue your skincare journey":"Begin your transformation today"})]}),J.general&&a.jsx("div",{className:"mb-4 p-4 bg-red-50 border-2 border-red-200 rounded-lg animate-slide-up",children:a.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[a.jsx(R2,{className:"w-5 h-5 flex-shrink-0"}),a.jsx("p",{className:"text-sm font-medium",children:J.general})]})}),a.jsxs("form",{onSubmit:z,className:"space-y-5",children:[!r&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"animate-slide-up grid grid-cols-2 gap-3",children:[a.jsx(Yl,{id:"firstName",label:"First Name",placeholder:"Jane",value:v,onChange:q=>{S(q.target.value),g(`${q.target.value} ${N}`.trim())},icon:a.jsx(za,{}),required:!0}),a.jsx(Yl,{id:"lastName",label:"Last Name",placeholder:"Doe",value:N,onChange:q=>{b(q.target.value),g(`${v} ${q.target.value}`.trim())},icon:a.jsx(za,{}),required:!0})]})}),a.jsx("div",{className:"animate-slide-up",style:{animationDelay:"100ms"},children:a.jsx(Yl,{id:"email",label:"Email Address",type:"email",placeholder:"jane@example.com",value:i,onChange:q=>o(q.target.value),icon:a.jsx(_c,{}),error:J.email})}),a.jsxs("div",{className:"animate-slide-up",style:{animationDelay:"200ms"},children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2 text-gray-700",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:a.jsx(Dn,{className:"w-5 h-5"})}),a.jsx("input",{id:"password",type:j?"text":"password",placeholder:"",value:l,onChange:q=>u(q.target.value),required:!0,className:`
                      w-full pl-10 pr-10 py-3 border-2 rounded-lg
                      focus:outline-none focus:ring-2 focus:ring-brand-teal focus:border-transparent
                      transition-all duration-300
                      ${J.password?"border-red-500":"border-gray-300"}
                    `}),a.jsx("button",{type:"button",onClick:()=>D(!j),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-brand-teal transition-colors",children:j?a.jsx(Cw,{className:"w-5 h-5"}):a.jsx(qa,{className:"w-5 h-5"})})]}),J.password&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.password})]}),!r&&a.jsxs("div",{className:"animate-slide-up",style:{animationDelay:"250ms"},children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium mb-2 text-gray-700",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:a.jsx(Dn,{className:"w-5 h-5"})}),a.jsx("input",{id:"confirmPassword",type:k?"text":"password",placeholder:"",value:d,onChange:q=>h(q.target.value),required:!0,className:`
                        w-full pl-10 pr-10 py-3 border-2 rounded-lg
                        focus:outline-none focus:ring-2 focus:ring-brand-teal focus:border-transparent
                        transition-all duration-300
                        ${J.confirmPassword?"border-red-500":"border-gray-300"}
                      `}),a.jsx("button",{type:"button",onClick:()=>H(!k),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-brand-teal transition-colors",children:k?a.jsx(Cw,{className:"w-5 h-5"}):a.jsx(qa,{className:"w-5 h-5"})})]}),J.confirmPassword&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.confirmPassword})]}),!r&&a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 animate-slide-up",style:{animationDelay:"300ms"},children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Password must contain:"}),a.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Gt,{className:"w-3 h-3"}),"At least 8 characters"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Gt,{className:"w-3 h-3"}),"One uppercase letter"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Gt,{className:"w-3 h-3"}),"One lowercase letter"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Gt,{className:"w-3 h-3"}),"One number"]})]})]}),r&&a.jsxs("div",{className:"flex items-center justify-between text-sm animate-slide-up",style:{animationDelay:"250ms"},children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-2 border-brand-teal text-brand-teal focus:ring-2 focus:ring-brand-teal/20 transition-all group-hover:scale-110"}),a.jsx("span",{className:"text-gray-600 group-hover:text-brand-teal transition-colors",children:"Remember me"})]}),a.jsx("button",{type:"button",className:"text-brand-teal hover:text-brand-dark font-medium hover:underline transition-all hover:scale-105",onClick:()=>O(!0),children:"Forgot Password?"})]}),a.jsx("div",{className:"animate-slide-up",style:{animationDelay:"300ms"},children:a.jsxs(Go,{type:"submit",size:"lg",className:"w-full relative overflow-hidden group",disabled:x,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-dark via-brand-teal to-brand-dark opacity-0 group-hover:opacity-100 transition-opacity duration-500 animate-shimmer",style:{backgroundSize:"200% 100%"}}),a.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2",children:x?a.jsx(Sw,{className:"w-5 h-5 animate-spin"}):a.jsxs(a.Fragment,{children:[r?"Log In":"Create Account",a.jsx(vu,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})]})})]}),a.jsxs("div",{className:"relative my-6 animate-slide-up",style:{animationDelay:"350ms"},children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white/70 text-gray-500 font-medium",children:"Or continue with"})})]}),a.jsx("div",{className:"animate-slide-up",style:{animationDelay:"400ms"},children:a.jsxs("button",{type:"button",onClick:B,className:"w-full flex items-center justify-center gap-3 px-6 py-3 bg-white border-2 border-gray-300 rounded-lg hover:border-brand-teal hover:shadow-lg transition-all duration-300 group hover:scale-105 active:scale-95",children:[a.jsx(pM,{className:"w-6 h-6 group-hover:scale-110 transition-transform"}),a.jsx("span",{className:"font-medium text-gray-700 group-hover:text-brand-teal transition-colors",children:"Continue with Google"})]})}),a.jsx("div",{className:"mt-6 text-center animate-slide-up",style:{animationDelay:"450ms"},children:a.jsxs("p",{className:"text-gray-600",children:[r?"Don't have an account?":"Already have an account?",a.jsxs("button",{onClick:L,className:"ml-2 text-brand-teal font-semibold hover:text-brand-dark transition-all hover:scale-105 inline-block relative group",children:[r?"Sign Up":"Log In",a.jsx("span",{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-brand-teal group-hover:w-full transition-all duration-300"})]})]})}),a.jsxs("div",{className:"mt-8 flex items-center justify-center gap-6 text-xs text-gray-500 animate-slide-up",style:{animationDelay:"500ms"},children:[a.jsxs("div",{className:"flex items-center gap-1 hover:text-brand-teal transition-colors cursor-pointer",children:[a.jsx(Dn,{className:"w-3 h-3"}),a.jsx("span",{children:"Secure"})]}),a.jsxs("div",{className:"flex items-center gap-1 hover:text-brand-teal transition-colors cursor-pointer",children:[a.jsx(ua,{className:"w-3 h-3"}),a.jsx("span",{children:"HIPAA Compliant"})]}),a.jsxs("div",{className:"flex items-center gap-1 hover:text-brand-teal transition-colors cursor-pointer",children:[a.jsx(ua,{className:"w-3 h-3"}),a.jsx("span",{children:"Encrypted"})]})]})]})})}),a.jsx("div",{className:"absolute bottom-10 left-10 animate-bounce-subtle opacity-50",children:a.jsx(ua,{className:"w-12 h-12 text-brand-teal"})}),a.jsx("div",{className:"absolute top-10 right-10 animate-float opacity-50",style:{animationDelay:"1s"},children:a.jsx(Dn,{className:"w-10 h-10 text-brand-yellow"})}),P&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-brand-teal to-brand-dark rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(_c,{className:"w-8 h-8 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-brand-dark mb-2",children:"Reset Password"}),a.jsx("p",{className:"text-gray-600",children:"Enter your email address and we'll send you a link to reset your password."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(Yl,{id:"resetEmail",label:"Email Address",type:"email",placeholder:"jane@example.com",value:T,onChange:q=>w(q.target.value),icon:a.jsx(_c,{})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{type:"button",onClick:()=>{O(!1),w("")},className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-300",disabled:I,children:"Cancel"}),a.jsx("button",{type:"button",onClick:F,disabled:I||!T,className:"flex-1 px-4 py-3 bg-gradient-to-r from-brand-teal to-brand-dark text-white rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:I?a.jsxs(a.Fragment,{children:[a.jsx(Sw,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Sending..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(vu,{className:"w-5 h-5"}),a.jsx("span",{children:"Send Reset Link"})]})})]})]})]})})]})},yM=(t,e,n=20)=>{try{console.log(" Subscribing to notifications for user:",t);const r=qn(Ae(re,"notifications"),yr("userId","==",t),si("createdAt","desc"),ig(n)),s=VE(r,i=>{console.log(" Notification snapshot received:",{size:i.size,empty:i.empty,docs:i.docs.length});const o=i.docs.map(l=>({id:l.id,...l.data()}));o.length>0?(console.log(" Notifications found:",o.length),console.log("First notification:",o[0])):console.log(" No notifications found for this user"),e(o)},i=>{console.error(" Error listening to notifications:",i)});return console.log(" Notification listener setup complete"),s}catch(r){return console.error(" Error setting up notifications listener:",r),()=>{}}},vM=async t=>{try{const e=qn(Ae(re,"notifications"),yr("userId","==",t),si("createdAt","desc"));return(await ys(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){throw console.error("Error fetching notifications:",e),e}},W2=async t=>{try{const e=je(re,"notifications",t);await vs(e,{read:!0,readAt:ye()})}catch(e){throw console.error("Error marking notification as read:",e),e}},wM=async t=>{try{const e=qn(Ae(re,"notifications"),yr("userId","==",t),yr("read","==",!1)),r=(await ys(e)).docs.map(s=>vs(je(re,"notifications",s.id),{read:!0,readAt:ye()}));await Promise.all(r),console.log(` Marked ${r.length} notifications as read`)}catch(e){throw console.error("Error marking all notifications as read:",e),e}},G2=t=>{switch(t){case"appointment_approved":return"";case"appointment_declined":return"";case"appointment_cancelled":return"";case"payment_received":return"";case"new_message":return"";case"general_message":return"";default:return""}},K2=t=>{try{const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/6e4),i=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Just now":s<60?`${s} minute${s>1?"s":""} ago`:i<24?`${i} hour${i>1?"s":""} ago`:o<7?`${o} day${o>1?"s":""} ago`:e.toLocaleDateString()}catch{return"Recently"}},xM=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(0),[s,i]=A.useState(!1),[o,l]=A.useState(!0),u=A.useRef(null),d=Xa(),{user:h}=lt();A.useEffect(()=>{if(!(h!=null&&h.uid)){l(!1);return}const v=yM(h.uid,S=>{e(S),r(S.filter(N=>!N.read).length),l(!1)},20);return()=>v()},[h]),A.useEffect(()=>{const v=S=>{u.current&&!u.current.contains(S.target)&&i(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const m=async v=>{var S;try{v.read||await W2(v.id),i(!1),v.actionUrl?d(v.actionUrl):(S=v.relatedTo)!=null&&S.appointmentId&&d("/appointments")}catch(N){console.error("Error handling notification click:",N)}},g=()=>{i(!1),d("/notifications")};return h?a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>i(!s),className:"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Notifications",children:[a.jsx("svg",{className:"w-6 h-6 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),n>0&&a.jsx("span",{className:"absolute top-0 right-0 flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 rounded-full",children:n>9?"9+":n})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-50",children:[a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"Notifications"}),a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n," unread"]})]})}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:o?a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto"}),a.jsx("p",{className:"mt-2 text-sm",children:"Loading notifications..."})]}):t.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),a.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):t.map(v=>a.jsx("div",{onClick:()=>m(v),className:`p-4 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors ${v.read?"bg-white dark:bg-gray-800":"bg-blue-50 dark:bg-blue-900/20"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-2xl flex-shrink-0",children:G2(v.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900 dark:text-white line-clamp-1",children:v.title}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1 line-clamp-2",children:v.message}),a.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:K2(v.createdAt)})]}),!v.read&&a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1"})]})},v.id))}),a.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 text-center",children:a.jsx("button",{onClick:g,className:"text-sm text-teal-600 dark:text-teal-400 hover:underline font-medium",children:"View All Notifications"})})]})]}):null},_M=({children:t})=>{const[e,n]=A.useState(!0),{logout:r,user:s}=lt(),i=[{to:"/dashboard",icon:a.jsx(H6,{className:"w-6 h-6"}),label:"Dashboard",color:"from-brand-teal to-brand-dark"},{to:"/appointments",icon:a.jsx(zt,{className:"w-6 h-6"}),label:"Appointments",color:"from-brand-yellow to-brand-teal"},{to:"/documents",icon:a.jsx(Ct,{className:"w-6 h-6"}),label:"Documents",color:"from-brand-teal to-brand-yellow"},{to:"/chat",icon:a.jsx(tm,{className:"w-6 h-6"}),label:"Chat",color:"from-brand-dark to-brand-teal"},{to:"/billing",icon:a.jsx(A2,{className:"w-6 h-6"}),label:"Billing",color:"from-brand-yellow to-brand-dark"},{to:"/profile",icon:a.jsx(za,{className:"w-6 h-6"}),label:"Profile",color:"from-brand-teal to-brand-yellow"},{to:"/settings",icon:a.jsx(W6,{className:"w-6 h-6"}),label:"Settings",color:"from-brand-dark to-brand-teal"}],o=()=>{var u;return a.jsxs("div",{className:`fixed top-0 left-0 h-full bg-gradient-to-b from-brand-dark via-brand-teal to-brand-dark text-white transition-all duration-500 ease-in-out shadow-2xl z-50 ${e?"w-72":"w-20"}`,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 h-28 border-b border-white/10 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-yellow/10 to-transparent animate-gradient-x"}),a.jsx("div",{className:`flex items-center justify-center overflow-hidden transition-all duration-500 relative z-10 ${e?"w-full":"w-0"}`,children:a.jsx("div",{className:"bg-white/95 px-4 py-2 rounded-xl shadow-lg",children:a.jsx("img",{src:"https://dermaglareskin.co.za/wp-content/uploads/2023/07/Dermaglare-Skin.png",alt:"Dermaglare Skin",className:"h-16 w-auto object-contain",onError:d=>{const h=d.target;h.style.display="none";const m=h.parentElement;m&&(m.innerHTML='<span class="text-2xl font-bold text-brand-teal">DERMAGLARE</span>')}})})}),a.jsx("button",{onClick:()=>n(!e),className:"p-2.5 text-brand-yellow hover:text-white focus:outline-none rounded-xl hover:bg-white/10 transition-all duration-300 relative z-10 group",children:a.jsx(G6,{className:"w-6 h-6 transform group-hover:rotate-180 transition-transform duration-300"})})]}),a.jsx("nav",{className:"mt-6 px-3",children:a.jsx("ul",{className:"space-y-2",children:i.map((d,h)=>a.jsx("li",{className:"animate-slide-in-left",style:{animationDelay:`${h*.05}s`},children:a.jsx(lb,{to:d.to,className:({isActive:m})=>`flex items-center p-3.5 rounded-xl transition-all duration-300 group relative overflow-hidden ${m?"bg-gradient-to-r "+d.color+" text-white shadow-2xl shadow-brand-yellow/20 scale-105":"text-white/70 hover:bg-white/10 hover:text-white hover:scale-105"}`,children:({isActive:m})=>a.jsxs(a.Fragment,{children:[m&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 animate-shimmer"}),a.jsx("div",{className:`relative transition-transform duration-300 ${m?"animate-bounce-subtle":"group-hover:scale-110"}`,children:d.icon}),a.jsx("span",{className:`ml-4 font-semibold whitespace-nowrap transition-all duration-500 relative ${e?"opacity-100 translate-x-0":"opacity-0 -translate-x-4"}`,children:d.label}),m&&a.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1.5 h-8 bg-brand-yellow rounded-l-full animate-pulse"})]})})},d.to))})}),a.jsxs("div",{className:"absolute bottom-0 w-full p-4 border-t border-white/10 bg-gradient-to-t from-black/20 to-transparent",children:[e&&s&&a.jsx("div",{className:"mb-3 p-2.5 rounded-xl bg-white/5 backdrop-blur-sm animate-fade-in-up",children:a.jsxs("div",{className:"flex items-center space-x-2.5",children:[a.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-brand-yellow to-brand-teal flex items-center justify-center text-brand-dark font-bold shadow-lg flex-shrink-0",children:((u=s.email)==null?void 0:u.charAt(0).toUpperCase())||"U"}),a.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[a.jsx("p",{className:"text-xs font-semibold text-white truncate leading-tight",children:s.displayName||"Patient"}),a.jsx("p",{className:"text-[10px] text-white/60 truncate leading-tight",children:s.email})]})]})}),a.jsxs("button",{onClick:r,className:"flex items-center p-2.5 w-full text-white/70 hover:bg-red-500/20 hover:text-red-300 rounded-xl transition-all duration-300 group relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/0 via-red-500/10 to-red-500/0 opacity-0 group-hover:opacity-100 animate-shimmer"}),a.jsx(j2,{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300"}),a.jsx("span",{className:`ml-3 font-semibold text-sm whitespace-nowrap transition-all duration-500 relative z-10 ${e?"opacity-100 translate-x-0":"opacity-0 -translate-x-4"}`,children:"Logout"})]})]})]})},l=()=>{var u;return a.jsx("header",{className:`fixed top-0 right-0 h-20 bg-white/80 backdrop-blur-xl border-b border-gray-200/50 z-40 transition-all duration-500 ease-in-out shadow-lg ${e?"left-72":"left-20"}`,children:a.jsxs("div",{className:"flex items-center justify-between h-full px-8",children:[a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-brand-teal to-brand-dark bg-clip-text text-transparent",children:"Welcome Back!"})}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx(xM,{}),a.jsxs("div",{className:"flex items-center space-x-3 p-2 pr-4 rounded-full bg-gradient-to-r from-brand-teal/10 to-brand-yellow/10 hover:from-brand-teal/20 hover:to-brand-yellow/20 transition-all duration-300 cursor-pointer",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-brand-yellow to-brand-teal flex items-center justify-center text-brand-dark font-bold shadow-lg",children:s!=null&&s.email?s.email.charAt(0).toUpperCase():"G"}),a.jsx("span",{className:"text-sm font-semibold text-brand-dark",children:((u=s==null?void 0:s.email)==null?void 0:u.split("@")[0])||"Guest"})]})]})]})})};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-yellow/10",children:[a.jsx(o,{}),a.jsx(l,{}),a.jsx("main",{className:`transition-all duration-500 ease-in-out pt-20 ${e?"ml-72":"ml-20"}`,children:a.jsx("div",{className:"p-8 animate-fade-in-up",children:t})})]})},im=({children:t,className:e="",hover:n=!0,style:r})=>a.jsx("div",{className:`
        bg-white rounded-xl shadow-md p-6 
        transition-all duration-300
        ${n?"hover:shadow-2xl hover:-translate-y-1 hover:scale-[1.02]":""}
        ${e}
        animate-scale-in
      `,style:r,children:t}),bM=({icon:t,label:e,value:n,trend:r,color:s,delay:i,onClick:o})=>{const[l,u]=A.useState(0),d=typeof n=="number"?n:0;return A.useEffect(()=>{if(typeof n=="number"){const g=d/60;let v=0;const S=setInterval(()=>{v+=g,v>=d?(u(d),clearInterval(S)):u(Math.floor(v))},2e3/60);return()=>clearInterval(S)}},[d]),a.jsx("div",{className:"group animate-scale-in",style:{animationDelay:`${i}ms`},onClick:o,children:a.jsxs(im,{className:"relative overflow-hidden hover:shadow-2xl transition-all duration-500 hover:-translate-y-2 cursor-pointer border-2 border-transparent hover:border-brand-yellow/50",children:[a.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s} opacity-5 group-hover:opacity-10 transition-opacity duration-500`}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:`p-4 rounded-2xl bg-gradient-to-br ${s} group-hover:scale-110 transition-transform duration-300 shadow-lg`,children:a.jsx("div",{className:"text-white",children:t})}),r&&a.jsxs("div",{className:"flex items-center space-x-1 text-green-600 text-sm font-semibold",children:[a.jsx(D2,{className:"w-4 h-4"}),a.jsx("span",{children:r})]})]}),a.jsx("h3",{className:"text-4xl font-bold text-brand-dark mb-2 group-hover:scale-105 transition-transform duration-300",children:typeof n=="number"?l:n}),a.jsx("p",{className:"text-gray-600 font-medium",children:e})]})]})})},EM=()=>{var E;const{user:t}=lt(),e=Xa(),[n,r]=A.useState(""),[s,i]=A.useState([]),[o,l]=A.useState([]),[u,d]=A.useState(0),[h,m]=A.useState(!0),[g,v]=A.useState([]);A.useEffect(()=>{const R=new Date().getHours();R<12?r("Good Morning"):R<18?r("Good Afternoon"):r("Good Evening")},[]),A.useEffect(()=>{(async()=>{if(t)try{m(!0);const P=await yu(t.uid);i(P);const O=await em(t.uid);l(O),d(O.length);const T=[];O.slice(0,2).forEach(w=>{const I=w.uploadedAt?new Date(w.uploadedAt):new Date;T.push({id:w.id||"",action:"New document uploaded",detail:w.name,time:S(I),icon:a.jsx(Ct,{className:"w-5 h-5"}),color:"bg-brand-yellow",onClick:()=>e("/documents"),timestamp:I})}),P.filter(w=>{var I,C;return w.status==="Confirmed"||w.status==="confirmed"||w.status==="upcoming"||((I=w.status)==null?void 0:I.toLowerCase())==="confirmed"||((C=w.status)==null?void 0:C.toLowerCase())==="upcoming"}).slice(0,2).forEach(w=>{const I=w.createdAt?new Date(w.createdAt):new Date;T.push({id:w.id||"",action:"Appointment confirmed",detail:`${w.type} - ${new Date(w.date).toLocaleDateString()}`,time:S(I),icon:a.jsx(ua,{className:"w-5 h-5"}),color:"bg-green-500",onClick:()=>e("/appointments"),timestamp:I})}),T.sort((w,I)=>I.timestamp.getTime()-w.timestamp.getTime()),v(T.slice(0,3))}catch(P){console.error("Error fetching dashboard data:",P)}finally{m(!1)}})()},[t,e]);const S=R=>{const P=Math.floor((new Date().getTime()-R.getTime())/1e3);if(P<60)return"Just now";const O=Math.floor(P/60);if(O<60)return`${O} ${O===1?"minute":"minutes"} ago`;const T=Math.floor(O/60);if(T<24)return`${T} ${T===1?"hour":"hours"} ago`;const w=Math.floor(T/24);if(w<7)return`${w} ${w===1?"day":"days"} ago`;const I=Math.floor(w/7);if(I<4)return`${I} ${I===1?"week":"weeks"} ago`;const C=Math.floor(w/30);return`${C} ${C===1?"month":"months"} ago`},N=s.filter(R=>{var P,O;return R.status==="Pending"||R.status==="Confirmed"||R.status==="upcoming"||((P=R.status)==null?void 0:P.toLowerCase())==="pending"||((O=R.status)==null?void 0:O.toLowerCase())==="confirmed"}),b=s.filter(R=>{var P;return R.status==="Completed"||R.status==="completed"||((P=R.status)==null?void 0:P.toLowerCase())==="completed"}).length,x=[{icon:a.jsx(zt,{className:"w-8 h-8"}),label:"Upcoming Appointments",value:N.length,trend:N.length>0?`+${N.length}`:void 0,color:"from-brand-teal to-brand-dark",onClick:()=>e("/appointments")},{icon:a.jsx(Ct,{className:"w-8 h-8"}),label:"Documents",value:u,color:"from-brand-yellow to-orange-400",onClick:()=>e("/documents")},{icon:a.jsx(tm,{className:"w-8 h-8"}),label:"Unread Messages",value:0,color:"from-purple-500 to-brand-teal",onClick:()=>e("/chat")},{icon:a.jsx(ua,{className:"w-8 h-8"}),label:"Completed Visits",value:b,color:"from-green-500 to-brand-teal",onClick:()=>e("/appointments")}],y=N.slice(0,3).map(R=>{const P=new Date(R.date),O=new Date,T=new Date(O);T.setDate(T.getDate()+1);let w="";return P.toDateString()===O.toDateString()?w="Today":P.toDateString()===T.toDateString()?w="Tomorrow":w=P.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),{id:R.id||"",title:R.type,doctor:R.doctorName||"Dr. Jabu Nkehli",date:w,time:R.time,type:"In-Person",color:"from-brand-teal to-brand-dark"}});return a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-brand-teal via-brand-dark to-brand-teal p-8 md:p-12 shadow-2xl animate-fade-in-down",children:[a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-brand-yellow/20 rounded-full filter blur-3xl animate-float"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-brand-teal/30 rounded-full filter blur-3xl animate-float",style:{animationDelay:"1s"}}),a.jsx("div",{className:"relative z-10",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"bg-white/95 p-4 rounded-2xl shadow-2xl backdrop-blur-sm",children:a.jsx("img",{src:"https://dermaglareskin.co.za/wp-content/uploads/2023/07/Dermaglare-Skin.png",alt:"Dermaglare Logo",className:"h-20 w-auto object-contain",onError:R=>{const P=R.target;P.style.display="none";const O=P.parentElement;O&&(O.innerHTML='<span class="text-4xl font-bold text-brand-teal px-4">DERMAGLARE</span>')}})}),a.jsxs("div",{className:"border-l-2 border-brand-yellow/50 pl-6",children:[a.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-3 animate-slide-in-left flex items-center gap-3",children:[n,","," ",(t==null?void 0:t.displayName)||((E=t==null?void 0:t.email)==null?void 0:E.split("@")[0])||"there","!",a.jsx("span",{className:"text-brand-yellow",children:""})]}),a.jsxs("p",{className:"text-brand-yellow text-lg animate-slide-in-left",style:{animationDelay:"0.1s"},children:["Your skin health journey continues."," ",N.length>0?`You have ${N.length} upcoming ${N.length===1?"appointment":"appointments"}.`:"Book your next appointment today."]})]})]}),a.jsx("div",{className:"animate-scale-in",style:{animationDelay:"0.2s"},children:a.jsxs(Go,{onClick:()=>e("/appointments"),className:"bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark font-bold shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300",children:[a.jsx(zt,{className:"w-5 h-5 mr-2"}),"Book Appointment"]})})]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((R,P)=>a.jsx(bM,{...R,delay:P*100},R.label))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-brand-teal to-brand-dark bg-clip-text text-transparent animate-slide-in-right",children:"Upcoming Appointments"}),a.jsxs(Go,{onClick:()=>e("/appointments"),variant:"ghost",className:"text-brand-teal hover:text-brand-dark",children:["View All ",a.jsx(vu,{className:"w-4 h-4 ml-2"})]})]}),a.jsx("div",{className:"space-y-4",children:y.length>0?y.map((R,P)=>a.jsx("div",{className:"group animate-slide-in-up",style:{animationDelay:`${P*100}ms`},children:a.jsx(im,{className:"hover:shadow-2xl transition-all duration-500 hover:-translate-y-1 cursor-pointer border-2 border-transparent hover:border-brand-yellow/30",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`w-16 h-16 rounded-2xl bg-gradient-to-br ${R.color} flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300`,children:a.jsx(zt,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-brand-dark group-hover:text-brand-teal transition-colors duration-300",children:R.title}),a.jsx("p",{className:"text-gray-600",children:R.doctor})]}),a.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-brand-teal/10 text-brand-teal",children:R.type})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(zt,{className:"w-4 h-4 mr-2"}),a.jsx("span",{children:R.date})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ba,{className:"w-4 h-4 mr-2"}),a.jsx("span",{children:R.time})]})]})]}),a.jsx(Go,{onClick:()=>e("/appointments"),size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-r from-brand-teal to-brand-dark text-white",children:"View Details"})]})})},R.id)):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No upcoming appointments"})})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-brand-teal to-brand-dark bg-clip-text text-transparent mb-6 animate-slide-in-left",children:"Recent Activity"}),a.jsxs(im,{className:"bg-gradient-to-br from-white to-brand-light/50 backdrop-blur-sm animate-scale-in",children:[a.jsx("div",{className:"space-y-4",children:g.length>0?g.map((R,P)=>a.jsxs("div",{onClick:R.onClick,className:"flex items-start gap-4 p-3 rounded-xl hover:bg-white/60 transition-all duration-300 cursor-pointer group animate-slide-in-right",style:{animationDelay:`${P*100}ms`},children:[a.jsx("div",{className:`${R.color} p-2.5 rounded-xl text-white shadow-lg group-hover:scale-110 transition-transform duration-300`,children:R.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-brand-dark group-hover:text-brand-teal transition-colors duration-300",children:R.action}),a.jsx("p",{className:"text-sm text-gray-600",children:R.detail}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:R.time})]})]},R.id)):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent activity"})}),a.jsxs(Go,{onClick:()=>e("/appointments"),variant:"ghost",className:"w-full mt-4 text-brand-teal hover:text-brand-dark",children:["View All Activity ",a.jsx(vu,{className:"w-4 h-4 ml-2"})]})]}),a.jsxs("div",{className:"mt-6 animate-scale-in",style:{animationDelay:"0.4s"},children:[a.jsx("h3",{className:"text-xl font-bold text-brand-dark mb-4",children:"Quick Actions"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"Book",icon:a.jsx(zt,{className:"w-5 h-5"}),color:"from-brand-teal to-brand-dark",onClick:()=>e("/appointments")},{label:"Upload",icon:a.jsx(Ct,{className:"w-5 h-5"}),color:"from-brand-yellow to-orange-400",onClick:()=>e("/documents")},{label:"Message",icon:a.jsx(tm,{className:"w-5 h-5"}),color:"from-purple-500 to-brand-teal",onClick:()=>e("/chat")},{label:"History",icon:a.jsx(L2,{className:"w-5 h-5"}),color:"from-green-500 to-brand-teal",onClick:()=>e("/appointments")}].map((R,P)=>a.jsxs("button",{onClick:R.onClick,className:`p-4 rounded-xl bg-gradient-to-br ${R.color} text-white font-semibold hover:shadow-xl transform hover:scale-105 transition-all duration-300 animate-scale-in`,style:{animationDelay:`${.5+P*.1}s`},children:[R.icon,a.jsx("span",{className:"block mt-2 text-sm",children:R.label})]},R.label))})]})]})]})]})},TM=()=>{const{user:t,showToast:e,refreshUser:n}=lt(),[r,s]=A.useState(!1),[i,o]=A.useState(!1),[l,u]=A.useState(!0),[d,h]=A.useState(!1),[m,g]=A.useState(!1),[v,S]=A.useState({currentPassword:"",newPassword:"",confirmPassword:""}),N=A.useRef(null),[b,x]=A.useState({name:"",email:"",phone:"",address:"",dateOfBirth:"",bloodType:"",height:"",weight:"",allergies:"",emergencyContact:"",photoURL:""}),[y,E]=A.useState(0),[R,P]=A.useState(0),[O,T]=A.useState(0);A.useEffect(()=>{(async()=>{var z,B,F,L;if(t)try{u(!0);const q=await $a(t.uid),ee=await yu(t.uid);x(q?{name:q.name||t.displayName||"",email:q.email||t.email||"",phone:q.phone||"",address:q.address||"",dateOfBirth:q.dob||"",bloodType:q.bloodType||"",height:((B=(z=q.vitals)==null?void 0:z.heightCm)==null?void 0:B.toString())||"",weight:((L=(F=q.vitals)==null?void 0:F.weightKg)==null?void 0:L.toString())||"",allergies:Array.isArray(q.allergies)?q.allergies.join(", "):"",emergencyContact:q.emergencyContact||"",photoURL:q.photoURL||t.photoURL||""}:pe=>({...pe,name:t.displayName||"",email:t.email||"",photoURL:t.photoURL||""}));const we=ee.filter(pe=>pe.status==="Pending"||pe.status==="Confirmed").length,me=ee.filter(pe=>pe.status==="Completed").length;E(ee.length),P(me),T(we)}catch(q){console.error("Error fetching profile:",q),e("Failed to load profile data","error")}finally{u(!1)}})()},[t,e]);const w=async()=>{if(t)try{const G={name:b.name,email:b.email,phone:b.phone,address:b.address,dob:b.dateOfBirth,allergies:b.allergies?b.allergies.split(",").map(z=>z.trim()):[],vitals:{heightCm:b.height?parseFloat(b.height):void 0,weightKg:b.weight?parseFloat(b.weight):void 0},bloodType:b.bloodType,emergencyContact:b.emergencyContact,photoURL:b.photoURL};await Vi(t.uid,G),zn.currentUser&&b.name&&b.name!==t.displayName&&await Xb(zn.currentUser,{displayName:b.name}),s(!1),await n(),e("Profile updated successfully! ","success")}catch(G){console.error("Error saving profile:",G),e("Failed to update profile","error")}},I=async()=>{if(t)try{const G={bloodType:b.bloodType,allergies:b.allergies?b.allergies.split(",").map(z=>z.trim()):[],vitals:{heightCm:b.height?parseFloat(b.height):void 0,weightKg:b.weight?parseFloat(b.weight):void 0},emergencyContact:b.emergencyContact};await Vi(t.uid,G),o(!1),await n(),e("Medical information updated successfully! ","success")}catch(G){console.error("Error saving medical info:",G),e("Failed to update medical information","error")}},C=async G=>{if(!G.target.files||!G.target.files[0]||!t)return;const z=G.target.files[0];if(!z.type.startsWith("image/")){e("Please select an image file","error");return}if(z.size>5*1024*1024){e("Image size must be less than 5MB","error");return}try{h(!0);const B=xg(_g,`profile-pictures/${t.uid}/${Date.now()}_${z.name}`);await y6(B,z);const F=await N2(B),L={photoURL:F};await Vi(t.uid,L),x(q=>({...q,photoURL:F})),await n(),e("Profile picture updated successfully! ","success")}catch(B){console.error("Error uploading profile picture:",B),e("Failed to upload profile picture","error")}finally{h(!1)}},j=async()=>{if(!(!t||!t.email)){if(!v.currentPassword||!v.newPassword||!v.confirmPassword){e("Please fill in all password fields","error");return}if(v.newPassword!==v.confirmPassword){e("New passwords do not match","error");return}if(v.newPassword.length<6){e("Password must be at least 6 characters","error");return}try{const G=fr.credential(t.email,v.currentPassword);await jf(t,G),await Jb(t,v.newPassword),g(!1),S({currentPassword:"",newPassword:"",confirmPassword:""}),e("Password changed successfully! ","success")}catch(G){console.error("Error changing password:",G),G.code==="auth/wrong-password"?e("Current password is incorrect","error"):e("Failed to change password","error")}}},k=(()=>{let G=0;const z=[b.name,b.email,b.phone,b.address,b.dateOfBirth,b.bloodType,b.height,b.weight,b.emergencyContact],B=z.filter(F=>F&&F.trim()!=="").length;if(G+=B/z.length*60,y>0){const F=R/y*40;G+=F}return Math.round(G)})(),H=k>=80?"Excellent":k>=60?"Good":k>=40?"Fair":"Needs Attention",J=[{label:"Total Appointments",value:y.toString(),change:`${O} upcoming`,icon:zt,color:"from-blue-500 to-cyan-600"},{label:"Health Score",value:`${k}%`,change:H,icon:Pw,color:k>=80?"from-green-500 to-emerald-600":k>=60?"from-yellow-500 to-orange-500":"from-red-500 to-rose-600"},{label:"Completed Visits",value:R.toString(),change:`${Math.round(R/(y||1)*100)}% attendance`,icon:L2,color:"from-purple-500 to-violet-600"}];return l?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-brand-teal border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Loading profile..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8",children:[a.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"My Profile"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Manage your personal information and health records"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden animate-slide-in-left",children:[a.jsx("div",{className:"h-32 bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal relative",children:a.jsx("div",{className:"absolute inset-0 bg-black/10"})}),a.jsxs("div",{className:"px-6 pb-6",children:[a.jsxs("div",{className:"relative -mt-16 mb-4",children:[b.photoURL?a.jsx("img",{src:b.photoURL,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-xl mx-auto animate-scale-in"}):a.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-brand-yellow to-orange-400 flex items-center justify-center text-brand-dark font-bold text-5xl border-4 border-white shadow-xl mx-auto animate-scale-in",children:b.name.charAt(0).toUpperCase()}),a.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:C,className:"hidden"}),a.jsx("button",{onClick:()=>{var G;return(G=N.current)==null?void 0:G.click()},disabled:d,className:"absolute bottom-0 right-1/2 translate-x-16 w-10 h-10 bg-gradient-to-r from-brand-teal to-brand-dark rounded-full flex items-center justify-center text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"Upload profile picture",children:d?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(tM,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:b.name}),a.jsx("p",{className:"text-gray-600",children:b.email}),a.jsx("div",{className:"mt-4 inline-block px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-full text-sm font-semibold",children:"Active Patient"})]}),a.jsx("div",{className:"space-y-3",children:J.map((G,z)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-br from-brand-light to-white rounded-xl animate-fade-in",style:{animationDelay:`${z*.1}s`},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${G.color} flex items-center justify-center`,children:a.jsx(G.icon,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:G.label}),a.jsx("p",{className:"font-bold text-gray-800",children:G.value})]})]}),a.jsx("span",{className:"text-xs text-gray-500",children:G.change})]},G.label))}),a.jsxs("div",{className:"space-y-3 mt-6",children:[a.jsx("button",{onClick:()=>s(!r),className:"w-full bg-gradient-to-r from-brand-teal to-brand-dark text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2",children:r?a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-5 h-5"}),"Save Changes"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ch,{className:"w-5 h-5"}),"Edit Profile"]})}),a.jsxs("button",{onClick:()=>g(!0),className:"w-full bg-gradient-to-r from-purple-500 to-violet-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2",children:[a.jsx(Dn,{className:"w-5 h-5"}),"Change Password"]})]})]})]})}),a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-right",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-dark flex items-center justify-center",children:a.jsx(za,{className:"w-5 h-5 text-white"})}),"Personal Information"]}),!r&&a.jsx("button",{onClick:()=>s(!0),className:"text-brand-teal hover:text-brand-dark transition-colors duration-300",children:a.jsx(Ch,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.1s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),r?a.jsx("input",{type:"text",value:b.name,onChange:G=>x({...b,name:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsx("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium",children:b.name})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.2s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),r?a.jsx("input",{type:"email",value:b.email,onChange:G=>x({...b,email:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsxs("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium flex items-center gap-2",children:[a.jsx(_c,{className:"w-4 h-4 text-brand-teal"}),b.email]})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.3s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number"}),r?a.jsx("input",{type:"tel",value:b.phone,onChange:G=>x({...b,phone:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsxs("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium flex items-center gap-2",children:[a.jsx(M2,{className:"w-4 h-4 text-brand-teal"}),b.phone]})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.4s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Date of Birth"}),r?a.jsx("input",{type:"date",value:b.dateOfBirth,onChange:G=>x({...b,dateOfBirth:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsxs("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium flex items-center gap-2",children:[a.jsx(zt,{className:"w-4 h-4 text-brand-teal"}),new Date(b.dateOfBirth).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),a.jsxs("div",{className:"md:col-span-2 animate-fade-in",style:{animationDelay:"0.5s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Address"}),r?a.jsx("input",{type:"text",value:b.address,onChange:G=>x({...b,address:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsxs("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium flex items-center gap-2",children:[a.jsx(O2,{className:"w-4 h-4 text-brand-teal"}),b.address]})]})]}),r&&a.jsxs("div",{className:"mt-6 flex gap-4 animate-fade-in",children:[a.jsx("button",{onClick:w,className:"flex-1 bg-gradient-to-r from-brand-teal to-brand-dark text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Save Changes"}),a.jsx("button",{onClick:()=>s(!1),className:"px-8 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-300",children:"Cancel"})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-up",style:{animationDelay:"0.3s"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center",children:a.jsx(Pw,{className:"w-5 h-5 text-white"})}),"Medical Information"]}),!i&&a.jsx("button",{onClick:()=>o(!0),className:"text-brand-teal hover:text-brand-dark transition-colors duration-300",children:a.jsx(Ch,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.4s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Blood Type"}),i?a.jsxs("select",{value:b.bloodType,onChange:G=>x({...b,bloodType:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",children:[a.jsx("option",{value:"",children:"Select Blood Type"}),a.jsx("option",{value:"A+",children:"A+"}),a.jsx("option",{value:"A-",children:"A-"}),a.jsx("option",{value:"B+",children:"B+"}),a.jsx("option",{value:"B-",children:"B-"}),a.jsx("option",{value:"AB+",children:"AB+"}),a.jsx("option",{value:"AB-",children:"AB-"}),a.jsx("option",{value:"O+",children:"O+"}),a.jsx("option",{value:"O-",children:"O-"})]}):a.jsx("div",{className:"px-4 py-3 bg-red-50 rounded-xl text-red-800 font-bold",children:b.bloodType||"Not specified"})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.5s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Allergies (comma-separated)"}),i?a.jsx("input",{type:"text",value:b.allergies,onChange:G=>x({...b,allergies:G.target.value}),placeholder:"e.g., Penicillin, Peanuts",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsx("div",{className:"px-4 py-3 bg-orange-50 rounded-xl text-orange-800 font-medium",children:b.allergies||"None"})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.6s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Height (cm)"}),i?a.jsx("input",{type:"number",value:b.height,onChange:G=>x({...b,height:G.target.value}),placeholder:"e.g., 170",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsx("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium",children:b.height?`${b.height} cm`:"Not specified"})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.7s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Weight (kg)"}),i?a.jsx("input",{type:"number",value:b.weight,onChange:G=>x({...b,weight:G.target.value}),placeholder:"e.g., 70",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsx("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium",children:b.weight?`${b.weight} kg`:"Not specified"})]}),a.jsxs("div",{className:"md:col-span-2 animate-fade-in",style:{animationDelay:"0.8s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Emergency Contact"}),i?a.jsx("input",{type:"text",value:b.emergencyContact,onChange:G=>x({...b,emergencyContact:G.target.value}),placeholder:"Name and phone number",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300"}):a.jsx("div",{className:"px-4 py-3 bg-brand-light rounded-xl text-gray-800 font-medium",children:b.emergencyContact||"Not specified"})]})]}),i&&a.jsxs("div",{className:"mt-6 flex gap-4 animate-fade-in",children:[a.jsx("button",{onClick:I,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Save Medical Info"}),a.jsx("button",{onClick:()=>o(!1),className:"px-8 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-300",children:"Cancel"})]})]})]})]}),m&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center",children:a.jsx(Dn,{className:"w-5 h-5 text-white"})}),"Change Password"]}),a.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Current Password"}),a.jsx("input",{type:"password",value:v.currentPassword,onChange:G=>S({...v,currentPassword:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Enter current password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"New Password"}),a.jsx("input",{type:"password",value:v.newPassword,onChange:G=>S({...v,newPassword:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Enter new password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:v.confirmPassword,onChange:G=>S({...v,confirmPassword:G.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Confirm new password"})]}),a.jsxs("div",{className:"flex gap-4 mt-6",children:[a.jsx("button",{onClick:j,className:"flex-1 bg-gradient-to-r from-purple-500 to-violet-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Change Password"}),a.jsx("button",{onClick:()=>{g(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})},className:"px-8 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-300",children:"Cancel"})]})]})]})})]})},Q2=A.createContext(void 0),IM=()=>{const t=A.useContext(Q2);if(!t)throw new Error("useAppearance must be used within AppearanceProvider");return t},NM=({children:t})=>{const{user:e}=lt(),[n,r]=A.useState({theme:"light",fontSize:"medium"});A.useEffect(()=>{(async()=>{var o;if(e!=null&&e.uid)try{const l=await $a(e.uid);(o=l==null?void 0:l.settings)!=null&&o.appearance&&r(l.settings.appearance)}catch(l){console.error("Error loading appearance settings:",l)}})()},[e==null?void 0:e.uid]),A.useEffect(()=>{const i=document.documentElement;let o=n.theme;switch(n.theme==="auto"&&(o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),o==="dark"?i.classList.add("dark"):i.classList.remove("dark"),n.fontSize){case"small":i.style.fontSize="13px";break;case"medium":i.style.fontSize="14px";break;case"large":i.style.fontSize="15px";break}},[n]);const s=i=>{r(i)};return a.jsx(Q2.Provider,{value:{appearance:n,setAppearance:s},children:t})},SM=()=>{const{user:t,showToast:e,logout:n}=lt(),{appearance:r,setAppearance:s}=IM(),[i,o]=A.useState(!1),[l,u]=A.useState(!1),[d,h]=A.useState(!1),[m,g]=A.useState(!1),[v,S]=A.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[N,b]=A.useState(""),[x,y]=A.useState([{id:"email_notifications",label:"Email Notifications",description:"Receive email updates about appointments and health reminders",enabled:!0},{id:"sms_notifications",label:"SMS Notifications",description:"Get text messages for appointment reminders",enabled:!1},{id:"push_notifications",label:"Push Notifications",description:"Receive push notifications on your devices",enabled:!0},{id:"marketing_emails",label:"Marketing Emails",description:"Receive newsletters and promotional content",enabled:!1}]),[E,R]=A.useState([{id:"profile_visibility",label:"Profile Visibility",description:"Make your profile visible to healthcare providers",enabled:!0},{id:"share_data",label:"Share Anonymous Data",description:"Help improve our services with anonymous usage data",enabled:!1},{id:"two_factor",label:"Two-Factor Authentication",description:"Add an extra layer of security to your account",enabled:!0}]);A.useEffect(()=>{(async()=>{var J,G;if(t!=null&&t.uid)try{const z=await $a(t.uid);(J=z==null?void 0:z.settings)!=null&&J.notifications&&y(z.settings.notifications),(G=z==null?void 0:z.settings)!=null&&G.privacy&&R(z.settings.privacy)}catch(z){console.error("Error loading settings:",z)}})()},[t]);const P=async()=>{if(t!=null&&t.uid)try{o(!0),await Vi(t.uid,{settings:{notifications:x,privacy:E,appearance:r}}),e("Settings saved successfully!","success"),o(!1)}catch(H){console.error("Error saving settings:",H),e("Failed to save settings","error"),o(!1)}},O=H=>{y(x.map(J=>J.id===H?{...J,enabled:!J.enabled}:J)),setTimeout(P,500)},T=H=>{R(E.map(J=>J.id===H?{...J,enabled:!J.enabled}:J)),setTimeout(P,500)},w=async H=>{const J={...r,theme:H};s(J);try{t!=null&&t.uid&&await Vi(t.uid,{settings:{notifications:x,privacy:E,appearance:J}})}catch(G){console.error("Error saving theme:",G)}},I=async H=>{const J={...r,fontSize:H};s(J);try{t!=null&&t.uid&&await Vi(t.uid,{settings:{notifications:x,privacy:E,appearance:J}})}catch(G){console.error("Error saving font size:",G)}},C=async()=>{if(!v.currentPassword||!v.newPassword||!v.confirmPassword){e("Please fill in all password fields","error");return}if(v.newPassword!==v.confirmPassword){e("New passwords don't match","error");return}if(v.newPassword.length<6){e("Password must be at least 6 characters","error");return}try{const H=zn.currentUser;if(!H||!H.email){e("No user logged in","error");return}const J=fr.credential(H.email,v.currentPassword);await jf(H,J),await Jb(H,v.newPassword),e("Password changed successfully!","success"),u(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})}catch(H){console.error("Error changing password:",H),H.code==="auth/wrong-password"?e("Current password is incorrect","error"):e("Failed to change password","error")}},j=async()=>{if(!N){e("Please enter your password to confirm","error");return}try{const H=zn.currentUser;if(!H||!H.email){e("No user logged in","error");return}const J=fr.credential(H.email,N);await jf(H,J),await mP(H),e("Account deleted successfully","success"),h(!1)}catch(H){console.error("Error deleting account:",H),H.code==="auth/wrong-password"?e("Password is incorrect","error"):e("Failed to delete account","error")}},D=async()=>{try{await n(),e("Signed out successfully","success")}catch(H){console.error("Error signing out:",H),e("Failed to sign out","error")}},k=({enabled:H,onToggle:J})=>a.jsx("button",{onClick:J,className:`relative w-14 h-7 rounded-full transition-all duration-300 ${H?"bg-gradient-to-r from-brand-teal to-brand-dark":"bg-gray-300"}`,children:a.jsx("div",{className:`absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow-md transition-transform duration-300 ${H?"transform translate-x-7":""}`})});return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8",children:[a.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"Settings"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Manage your account preferences and settings"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 sticky top-8 animate-slide-in-left",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Quick Navigation"}),a.jsx("nav",{className:"space-y-2",children:[{icon:kw,label:"Notifications",href:"#notifications"},{icon:Rw,label:"Privacy & Security",href:"#privacy"},{icon:jw,label:"Appearance",href:"#appearance"},{icon:Dn,label:"Account",href:"#account"}].map((H,J)=>a.jsxs("a",{href:H.href,className:"flex items-center gap-3 p-3 rounded-xl hover:bg-brand-light transition-all duration-300 group animate-fade-in",style:{animationDelay:`${J*.1}s`},children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-dark flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:a.jsx(H.icon,{className:"w-5 h-5 text-white"})}),a.jsx("span",{className:"font-semibold text-gray-700 group-hover:text-brand-teal transition-colors duration-300",children:H.label})]},H.label))})]})}),a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{id:"notifications",className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-right",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 flex items-center justify-center",children:a.jsx(kw,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Notifications"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Manage how you receive notifications"})]})]}),a.jsx("div",{className:"space-y-4",children:x.map((H,J)=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-brand-light rounded-xl hover:bg-brand-light/70 transition-all duration-300 animate-fade-in",style:{animationDelay:`${J*.1}s`},children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:H.label}),a.jsx("p",{className:"text-sm text-gray-600",children:H.description})]}),a.jsx(k,{enabled:H.enabled,onToggle:()=>O(H.id)})]},H.id))})]}),a.jsxs("div",{id:"privacy",className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-right",style:{animationDelay:"0.2s"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center",children:a.jsx(Rw,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Privacy & Security"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Control your privacy and security settings"})]})]}),a.jsx("div",{className:"space-y-4 mb-6",children:E.map((H,J)=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-brand-light rounded-xl hover:bg-brand-light/70 transition-all duration-300 animate-fade-in",style:{animationDelay:`${.3+J*.1}s`},children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:H.label}),a.jsx("p",{className:"text-sm text-gray-600",children:H.description})]}),a.jsx(k,{enabled:H.enabled,onToggle:()=>T(H.id)})]},H.id))}),a.jsx("div",{className:"pt-6 border-t border-gray-200",children:a.jsxs("button",{onClick:()=>u(!0),className:"w-full bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2",children:[a.jsx(Dn,{className:"w-5 h-5"}),"Change Password"]})})]}),a.jsxs("div",{id:"appearance",className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-right",style:{animationDelay:"0.4s"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center",children:a.jsx(jw,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Appearance"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Customize how the app looks"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.5s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Theme"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:["light","dark","auto"].map(H=>a.jsx("button",{onClick:()=>w(H),className:`p-3 rounded-xl border-2 font-semibold transition-all duration-300 transform hover:scale-105 ${r.theme===H?"border-brand-teal bg-brand-light text-brand-teal":"border-gray-200 bg-white text-gray-700 hover:border-brand-teal"}`,children:H.charAt(0).toUpperCase()+H.slice(1)},H))})]}),a.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"0.6s"},children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Font Size"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:["small","medium","large"].map(H=>a.jsx("button",{onClick:()=>I(H),className:`p-3 rounded-xl border-2 font-semibold transition-all duration-300 transform hover:scale-105 ${r.fontSize===H?"border-brand-teal bg-brand-light text-brand-teal":"border-gray-200 bg-white text-gray-700 hover:border-brand-teal"}`,children:H.charAt(0).toUpperCase()+H.slice(1)},H))})]})]})]}),a.jsxs("div",{id:"account",className:"bg-white rounded-2xl shadow-xl p-6 animate-slide-in-right",style:{animationDelay:"0.6s"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center",children:a.jsx(Dn,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Account Actions"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Manage your account data"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-between p-4 bg-yellow-50 hover:bg-yellow-100 rounded-xl transition-all duration-300 group animate-fade-in",style:{animationDelay:"0.8s"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(qa,{className:"w-5 h-5 text-yellow-600"}),a.jsxs("div",{className:"text-left",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Privacy Policy"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Review how we protect your data"})]})]}),a.jsx("div",{className:"text-yellow-600 group-hover:translate-x-1 transition-transform duration-300",children:""})]}),a.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-between p-4 bg-red-50 hover:bg-red-100 rounded-xl transition-all duration-300 group animate-fade-in",style:{animationDelay:"0.9s"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(nm,{className:"w-5 h-5 text-red-600"}),a.jsxs("div",{className:"text-left",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Delete Account"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Permanently delete your account and data"})]})]}),a.jsx("div",{className:"text-red-600 group-hover:translate-x-1 transition-transform duration-300",children:""})]}),a.jsxs("button",{onClick:D,className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-brand-teal to-brand-dark text-white rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 animate-fade-in",style:{animationDelay:"1s"},children:[a.jsx(j2,{className:"w-5 h-5"}),"Sign Out"]})]})]})]})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-yellow to-orange-400 flex items-center justify-center",children:a.jsx(Dn,{className:"w-5 h-5 text-white"})}),"Change Password"]}),a.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Current Password"}),a.jsx("input",{type:"password",value:v.currentPassword,onChange:H=>S({...v,currentPassword:H.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Enter current password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"New Password"}),a.jsx("input",{type:"password",value:v.newPassword,onChange:H=>S({...v,newPassword:H.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Enter new password (min 6 characters)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm New Password"}),a.jsx("input",{type:"password",value:v.confirmPassword,onChange:H=>S({...v,confirmPassword:H.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300",placeholder:"Confirm new password"})]}),a.jsxs("div",{className:"flex gap-4 mt-6",children:[a.jsx("button",{onClick:C,className:"flex-1 bg-gradient-to-r from-brand-yellow to-orange-400 text-brand-dark py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Change Password"}),a.jsx("button",{onClick:()=>{u(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})},className:"px-8 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-300",children:"Cancel"})]})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:a.jsx(nm,{className:"w-5 h-5 text-white"})}),"Delete Account"]}),a.jsx("button",{onClick:()=>h(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("p",{className:"text-gray-700 mb-4",children:[a.jsx("strong",{className:"text-red-600",children:"Warning:"})," This action cannot be undone. All your data, including appointments, medical records, and billing information will be permanently deleted."]}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Please enter your password to confirm account deletion."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),a.jsx("input",{type:"password",value:N,onChange:H=>b(H.target.value),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-red-500 outline-none transition-all duration-300",placeholder:"Enter your password"})]}),a.jsxs("div",{className:"flex gap-4 mt-6",children:[a.jsx("button",{onClick:j,className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Delete Account"}),a.jsx("button",{onClick:()=>{h(!1),b("")},className:"px-8 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-300",children:"Cancel"})]})]})]})}),m&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6 shadow-2xl animate-scale-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-white pb-4 border-b",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-500 to-amber-600 flex items-center justify-center",children:a.jsx(qa,{className:"w-5 h-5 text-white"})}),"Privacy Policy"]}),a.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-6 text-gray-700",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-3",children:"Data Collection"}),a.jsx("p",{className:"mb-2",children:"We collect and process your personal health information to provide you with quality healthcare services. This includes:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[a.jsx("li",{children:"Personal identification information (name, email, phone)"}),a.jsx("li",{children:"Medical history and health records"}),a.jsx("li",{children:"Appointment and consultation details"}),a.jsx("li",{children:"Billing and payment information"})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-3",children:"Data Protection"}),a.jsx("p",{children:"Your data is encrypted both in transit and at rest. We use industry-standard security measures including SSL encryption, secure cloud storage, and regular security audits to protect your information."})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-3",children:"Data Sharing"}),a.jsx("p",{children:"We do not sell your personal information. Your data is only shared with:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[a.jsx("li",{children:"Healthcare providers involved in your care"}),a.jsx("li",{children:"Payment processors for billing purposes"}),a.jsx("li",{children:"Legal authorities when required by law"})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-3",children:"Your Rights"}),a.jsx("p",{className:"mb-2",children:"You have the right to:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[a.jsx("li",{children:"Access your personal data at any time"}),a.jsx("li",{children:"Request correction of inaccurate data"}),a.jsx("li",{children:"Request deletion of your account and data"}),a.jsx("li",{children:"Export your data in a machine-readable format"}),a.jsx("li",{children:"Opt-out of marketing communications"})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-3",children:"Contact Us"}),a.jsxs("p",{children:["If you have any questions about our privacy practices, please contact us at"," ",a.jsx("a",{href:"mailto:privacy@dermaglare.com",className:"text-brand-teal hover:underline",children:"privacy@dermaglare.com"})]})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["Last updated: ",new Date().toLocaleDateString()]})})]}),a.jsx("div",{className:"mt-6 pt-4 border-t",children:a.jsx("button",{onClick:()=>g(!1),className:"w-full bg-gradient-to-r from-brand-teal to-brand-dark text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Close"})})]})})]})},kM=()=>{const{user:t,showToast:e}=lt(),[n,r]=A.useState("all"),[s,i]=A.useState(!1),[o,l]=A.useState([]),[u,d]=A.useState(!0),[h,m]=A.useState(!1),[g,v]=A.useState("list"),[S,N]=A.useState(new Date),[b,x]=A.useState(null),[y,E]=A.useState({date:"",time:"",type:"",notes:"",doctorName:"Dr. Jabu Nkehli"});A.useEffect(()=>{(async()=>{if(t)try{d(!0);const ee=(await yu(t.uid)).map(we=>{let me="upcoming";return we.status==="Completed"?me="completed":we.status==="Cancelled"?me="cancelled":me="upcoming",{id:we.id||"",title:we.type,doctor:we.doctorName||"Dr. Jabu Nkehli",date:we.date,time:we.time,location:"Dermaglare Clinic - Main Branch",type:we.type,status:me}});l(ee)}catch(q){console.error("Error fetching appointments:",q),e("Failed to load appointments","error")}finally{d(!1)}})()},[t,e]);const R=async L=>{try{await R6(String(L)),l(o.map(q=>q.id===L?{...q,status:"cancelled"}:q)),e("Appointment cancelled successfully","success")}catch(q){console.error("Error cancelling appointment:",q),e("Failed to cancel appointment","error")}},P=async L=>{if(L.preventDefault(),console.log("=== Booking Appointment ==="),console.log("User:",t),console.log("Form data:",y),!t){e("Please login to book an appointment","error");return}if(!y.date||!y.time||!y.type){console.log("Validation failed - missing fields"),e("Please fill in all required fields","error");return}try{m(!0);const{getServicePrice:q}=await ts(async()=>{const{getServicePrice:tt}=await Promise.resolve().then(()=>bg);return{getServicePrice:tt}},void 0),ee=q(y.type),we=(ee==null?void 0:ee.basePrice)||0,me={patientId:t.uid,patientName:t.displayName||t.email||"Patient",patientEmail:t.email||"",date:y.date,time:y.time,type:y.type,status:"Pending",doctorName:y.doctorName,notes:y.notes,amount:we};console.log("Appointment data to save:",me),console.log("Service amount:",we);const pe=await P6(me);console.log("Appointment booked with ID:",pe);const Pe=await yu(t.uid);console.log("Fetched appointments:",Pe);const ct=Pe.map(tt=>{let Hn="upcoming";return tt.status==="Completed"?Hn="completed":tt.status==="Cancelled"?Hn="cancelled":Hn="upcoming",{id:tt.id||"",title:tt.type,doctor:tt.doctorName||"Dr. Jabu Nkehli",date:tt.date,time:tt.time,location:"Dermaglare Clinic - Main Branch",type:tt.type,status:Hn}});console.log("Transformed appointments:",ct),l(ct),E({date:"",time:"",type:"",notes:"",doctorName:"Dr. Jabu Nkehli"}),i(!1),m(!1),e("Appointment booked successfully! ","success")}catch(q){console.error("Error booking appointment:",q),e(`Failed to book appointment: ${q}`,"error"),m(!1)}},O=n==="all"?o:o.filter(L=>L.status===n),T=o.filter(L=>L.status==="upcoming").length,w=o.filter(L=>L.status==="completed").length,I=new Date().getMonth(),C=new Date().getFullYear(),j=o.filter(L=>{const q=new Date(L.date);return q.getMonth()===I&&q.getFullYear()===C}).length,D=L=>{const q=L.getFullYear(),ee=L.getMonth(),we=new Date(q,ee,1),pe=new Date(q,ee+1,0).getDate(),Pe=we.getDay();return{daysInMonth:pe,startingDayOfWeek:Pe,year:q,month:ee}},k=L=>o.filter(q=>{const ee=new Date(q.date);return ee.getDate()===L.getDate()&&ee.getMonth()===L.getMonth()&&ee.getFullYear()===L.getFullYear()}),H=()=>{N(new Date(S.getFullYear(),S.getMonth()-1,1))},J=()=>{N(new Date(S.getFullYear(),S.getMonth()+1,1))},G=L=>{const q=new Date;return L.getDate()===q.getDate()&&L.getMonth()===q.getMonth()&&L.getFullYear()===q.getFullYear()},z=(L,q)=>L?L.getDate()===q.getDate()&&L.getMonth()===q.getMonth()&&L.getFullYear()===q.getFullYear():!1,B=L=>{switch(L){case"upcoming":return"from-green-500 to-emerald-600";case"completed":return"from-blue-500 to-cyan-600";case"cancelled":return"from-red-500 to-rose-600";default:return"from-gray-500 to-slate-600"}},F=L=>{switch(L){case"upcoming":return a.jsx(Ba,{className:"w-5 h-5"});case"completed":return a.jsx(Gt,{className:"w-5 h-5"});case"cancelled":return a.jsx(ir,{className:"w-5 h-5"});default:return null}};return u?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-brand-teal border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Loading appointments..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8",children:[a.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"Appointments"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Manage your healthcare appointments"})]}),a.jsxs("button",{onClick:()=>i(!0),className:"bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center gap-2 animate-scale-in",children:[a.jsx(B6,{className:"w-5 h-5"}),"Book Appointment"]})]}),a.jsxs("div",{className:"flex gap-4 items-center animate-slide-in-up",style:{animationDelay:"0.1s"},children:[a.jsx("div",{className:"flex gap-2",children:["all","upcoming","completed","cancelled"].map(L=>a.jsx("button",{onClick:()=>r(L),className:`px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 ${n===L?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"bg-white text-gray-700 hover:bg-gray-50 shadow"}`,children:L.charAt(0).toUpperCase()+L.slice(1)},L))}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{className:"p-2 bg-white rounded-lg shadow hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:a.jsx(V2,{className:"w-5 h-5 text-brand-teal"})}),a.jsx("button",{className:"p-2 bg-white rounded-lg shadow hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:a.jsx(F2,{className:"w-5 h-5 text-brand-teal"})})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[{label:"Upcoming",count:T,color:"from-green-500 to-emerald-600",delay:"0.2s"},{label:"Completed",count:w,color:"from-blue-500 to-cyan-600",delay:"0.3s"},{label:"This Month",count:j,color:"from-purple-500 to-violet-600",delay:"0.4s"}].map(L=>a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 animate-fade-in-up",style:{animationDelay:L.delay},children:[a.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${L.color} flex items-center justify-center mb-4 animate-pulse-glow`,children:a.jsx(zt,{className:"w-6 h-6 text-white"})}),a.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:L.count}),a.jsx("div",{className:"text-gray-600 font-medium",children:L.label})]},L.label))}),a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("div",{className:"flex gap-2 bg-white rounded-xl p-1 shadow-md",children:[a.jsx("button",{onClick:()=>v("list"),className:`px-6 py-2 rounded-lg font-semibold transition-all duration-300 ${g==="list"?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"text-gray-600 hover:text-brand-teal"}`,children:"List View"}),a.jsx("button",{onClick:()=>v("calendar"),className:`px-6 py-2 rounded-lg font-semibold transition-all duration-300 ${g==="calendar"?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"text-gray-600 hover:text-brand-teal"}`,children:"Calendar View"})]})}),g==="calendar"&&a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl mb-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:S.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:H,className:"p-2 hover:bg-brand-light rounded-lg transition-colors",children:a.jsx(q6,{className:"w-6 h-6 text-brand-teal"})}),a.jsx("button",{onClick:J,className:"p-2 hover:bg-brand-light rounded-lg transition-colors",children:a.jsx(z6,{className:"w-6 h-6 text-brand-teal"})})]})]}),a.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(L=>a.jsx("div",{className:"text-center font-bold text-gray-600 py-2",children:L},L)),(()=>{const{daysInMonth:L,startingDayOfWeek:q,year:ee,month:we}=D(S),me=[];for(let pe=0;pe<q;pe++)me.push(a.jsx("div",{className:"aspect-square"},`empty-${pe}`));for(let pe=1;pe<=L;pe++){const Pe=new Date(ee,we,pe),ct=k(Pe),tt=G(Pe),Hn=z(b,Pe);me.push(a.jsx("div",{onClick:()=>x(Pe),className:`aspect-square p-2 rounded-lg border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${tt?"border-brand-yellow bg-brand-yellow/10 ring-2 ring-brand-yellow ring-offset-2":Hn?"border-brand-teal bg-brand-teal/10":"border-gray-200 hover:border-brand-teal/50"}`,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("span",{className:`text-sm font-semibold ${tt?"text-brand-teal":"text-gray-700"}`,children:pe}),ct.length>0&&a.jsxs("div",{className:"flex-1 flex flex-col gap-1 mt-1",children:[ct.slice(0,2).map((ws,gd)=>a.jsx("div",{className:`text-xs px-1 py-0.5 rounded truncate ${ws.status==="upcoming"?"bg-green-100 text-green-700":ws.status==="completed"?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,title:`${ws.time} - ${ws.title}`,children:ws.time},gd)),ct.length>2&&a.jsxs("div",{className:"text-xs text-gray-500",children:["+",ct.length-2," more"]})]})]})},pe))}return me})()]}),b&&a.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[a.jsxs("h4",{className:"text-lg font-bold text-gray-800 mb-4",children:["Appointments on"," ",b.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),k(b).length>0?a.jsx("div",{className:"space-y-3",children:k(b).map(L=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-brand-light rounded-xl hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${L.status==="upcoming"?"bg-green-500":L.status==="completed"?"bg-blue-500":"bg-red-500"}`}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:L.title}),a.jsxs("p",{className:"text-sm text-gray-600",children:[L.time,"  ",L.doctor]})]})]}),L.status==="upcoming"&&a.jsx("button",{onClick:()=>R(L.id),className:"text-red-600 hover:text-red-700 text-sm font-semibold hover:underline transition-colors",children:"Cancel"})]},L.id))}):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No appointments on this date"})]})]}),g==="list"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:O.map((L,q)=>a.jsxs("div",{className:"group bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:scale-[1.02] animate-slide-in-up",style:{animationDelay:`${.5+q*.1}s`},children:[a.jsx("div",{className:`h-2 bg-gradient-to-r ${B(L.status)} animate-shimmer`}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1 group-hover:text-brand-teal transition-colors duration-300",children:L.title}),a.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold bg-brand-light text-brand-teal",children:L.type})]}),a.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full bg-gradient-to-r ${B(L.status)} text-white text-sm font-semibold`,children:[F(L.status),L.status]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-dark flex items-center justify-center",children:a.jsx(za,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Doctor"}),a.jsx("p",{className:"font-semibold",children:L.doctor})]})]}),a.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-yellow to-orange-400 flex items-center justify-center",children:a.jsx(zt,{className:"w-5 h-5 text-brand-dark"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date & Time"}),a.jsxs("p",{className:"font-semibold",children:[new Date(L.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})," ","at ",L.time]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center",children:a.jsx(O2,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Location"}),a.jsx("p",{className:"font-semibold",children:L.location})]})]})]}),a.jsxs("div",{className:"mt-6 flex gap-3",children:[L.status==="upcoming"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"flex-1 bg-gradient-to-r from-brand-teal to-brand-dark text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"Reschedule"}),a.jsx("button",{onClick:()=>R(L.id),className:"px-6 bg-red-50 text-red-600 py-3 rounded-xl font-semibold hover:bg-red-100 transform hover:scale-105 transition-all duration-300",children:"Cancel"})]}),L.status==="completed"&&a.jsx("button",{className:"flex-1 bg-gradient-to-r from-blue-500 to-cyan-600 text-white py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300",children:"View Details"})]})]})]},L.id))}),O.length===0&&a.jsxs("div",{className:"text-center py-16 animate-fade-in",children:[a.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-brand-teal to-brand-dark rounded-full flex items-center justify-center animate-float",children:a.jsx(zt,{className:"w-12 h-12 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No appointments found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:n==="all"?"You don't have any appointments scheduled yet.":`No ${n} appointments.`}),a.jsx("button",{onClick:()=>i(!0),className:"bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",children:"Book Your First Appointment"})]})]}),s&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full mx-4 shadow-2xl animate-scale-in max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-brand-teal to-brand-dark p-6 rounded-t-2xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-white mb-1",children:"Book New Appointment"}),a.jsx("p",{className:"text-brand-yellow",children:"Schedule your visit with us"})]}),a.jsx("button",{onClick:()=>i(!1),className:"text-white hover:text-brand-yellow transition-colors p-2 hover:bg-white/10 rounded-lg",children:a.jsx(ir,{className:"w-6 h-6"})})]})}),a.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Appointment Type ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:y.type,onChange:L=>E({...y,type:L.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-teal focus:outline-none transition-colors text-gray-700",required:!0,children:[a.jsx("option",{value:"",children:"Select appointment type"}),a.jsx("option",{value:"Standard Consultation",children:"Standard Consultation - R1,300"}),a.jsx("option",{value:"Medical Dermatology",children:"Medical Dermatology - R1,500"}),a.jsx("option",{value:"Cosmetic Dermatology",children:"Cosmetic Dermatology - R1,600"}),a.jsx("option",{value:"Laser Treatment",children:"Laser Treatment - R3,500"}),a.jsx("option",{value:"Chemical Peel",children:"Chemical Peel - R1,800"}),a.jsx("option",{value:"Microneedling",children:"Microneedling - R1,900"}),a.jsx("option",{value:"Botox Injections",children:"Botox Injections - R4,500"}),a.jsx("option",{value:"Platelet-Rich Plasma (PRP)",children:"PRP Therapy - R3,200"}),a.jsx("option",{value:"Skin Tightening",children:"Skin Tightening - R2,200"}),a.jsx("option",{value:"Mole Removal",children:"Mole Removal - R1,800"}),a.jsx("option",{value:"Skin Cancer Screening",children:"Skin Cancer Screening - R1,750"}),a.jsx("option",{value:"Acne Treatment",children:"Acne Treatment - R1,650"}),a.jsx("option",{value:"Paediatric Dermatology",children:"Paediatric Dermatology - R1,450"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Doctor ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:y.doctorName,onChange:L=>E({...y,doctorName:L.target.value}),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-teal focus:outline-none transition-colors text-gray-700",required:!0,children:[a.jsx("option",{value:"Dr. Jabu Nkehli",children:"Dr. Jabu Nkehli - Dermatologist"}),a.jsx("option",{value:"Dr. Sarah Johnson",children:"Dr. Sarah Johnson - Specialist"}),a.jsx("option",{value:"Dr. Michael Chen",children:"Dr. Michael Chen - Cosmetic Dermatology"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Preferred Date ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"date",value:y.date,onChange:L=>E({...y,date:L.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-teal focus:outline-none transition-colors text-gray-700",required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Preferred Time ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ba,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsxs("select",{value:y.time,onChange:L=>E({...y,time:L.target.value}),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-teal focus:outline-none transition-colors text-gray-700",required:!0,children:[a.jsx("option",{value:"",children:"Select time"}),a.jsx("option",{value:"08:00 AM",children:"08:00 AM"}),a.jsx("option",{value:"09:00 AM",children:"09:00 AM"}),a.jsx("option",{value:"10:00 AM",children:"10:00 AM"}),a.jsx("option",{value:"11:00 AM",children:"11:00 AM"}),a.jsx("option",{value:"12:00 PM",children:"12:00 PM"}),a.jsx("option",{value:"01:00 PM",children:"01:00 PM"}),a.jsx("option",{value:"02:00 PM",children:"02:00 PM"}),a.jsx("option",{value:"03:00 PM",children:"03:00 PM"}),a.jsx("option",{value:"04:00 PM",children:"04:00 PM"}),a.jsx("option",{value:"05:00 PM",children:"05:00 PM"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Additional Notes (Optional)"}),a.jsx("textarea",{value:y.notes,onChange:L=>E({...y,notes:L.target.value}),rows:4,placeholder:"Please provide any additional information about your condition or concerns...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-brand-teal focus:outline-none transition-colors resize-none text-gray-700"})]}),a.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx(zt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Important Information:"}),a.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Appointments are subject to availability and confirmation"}),a.jsx("li",{children:"You will receive a confirmation email within 24 hours"}),a.jsx("li",{children:"Please arrive 10 minutes before your appointment"})]})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-300",disabled:h,children:"Cancel"}),a.jsx("button",{type:"submit",disabled:h,className:"flex-1 bg-gradient-to-r from-brand-teal to-brand-dark text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Booking..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-5 h-5"}),a.jsx("span",{children:"Confirm Booking"})]})})]})]})]})})]})},CM=()=>{const{user:t,showToast:e}=lt(),[n,r]=A.useState("all"),[s,i]=A.useState(""),[o,l]=A.useState([]),[u,d]=A.useState(!0),[h,m]=A.useState(!1),[g,v]=A.useState(!1),[S,N]=A.useState(0),[b,x]=A.useState(null),y=A.useRef(null);A.useEffect(()=>{(async()=>{if(t)try{d(!0);const F=(await em(t.uid)).map(L=>({id:L.id||"",name:L.name,type:L.type||"PDF",category:L.category||"General",size:L.size||"Unknown",date:L.date,url:L.fileUrl||L.url,storagePath:L.storagePath}));l(F)}catch(B){console.error("Error fetching documents:",B),e("Failed to load documents","error")}finally{d(!1)}})()},[t,e]);const E=async z=>{if(confirm("Are you sure you want to delete this document?"))try{const B=o.find(F=>F.id===z);if(!B||!B.storagePath){e("Cannot delete document: storage path not found","error");return}await D6(String(z),B.storagePath),l(o.filter(F=>F.id!==z)),e("Document deleted successfully","success")}catch(B){console.error("Error deleting document:",B),e("Failed to delete document","error")}},R=z=>{z.url?window.open(z.url,"_blank"):e("Document URL not available","error")},P=z=>{var F;const B=(F=z.target.files)==null?void 0:F[0];if(B){if(B.size>10*1024*1024){e("File size must be less than 10MB","error");return}x(B),m(!0)}},O=async()=>{if(!(!b||!t))try{v(!0),N(0),await j6(t.uid,b,F=>{N(F)});const B=(await em(t.uid)).map(F=>({id:F.id||"",name:F.name,type:F.type||"PDF",category:F.category||"General",size:F.size||"Unknown",date:F.date,url:F.fileUrl||F.url,storagePath:F.storagePath}));l(B),m(!1),x(null),N(0),e("Document uploaded successfully! ","success")}catch(z){console.error("Error uploading document:",z),e("Failed to upload document","error")}finally{v(!1)}},T=()=>{m(!1),x(null),N(0),y.current&&(y.current.value="")},w=["all",...Array.from(new Set(o.map(z=>z.category)))],I=w.length>1?w:["all","Lab Results","Prescriptions","Treatment Plans","Insurance","Forms","Reports"],C=o.filter(z=>{const B=n==="all"||z.category===n,F=z.name.toLowerCase().includes(s.toLowerCase());return B&&F}),j=o.filter(z=>z.category==="Lab Results").length,D=o.filter(z=>z.category==="Prescriptions").length,k=o.reduce((z,B)=>{const F=B.size.match(/([\d.]+)\s*(KB|MB)/i);if(F){const L=parseFloat(F[1]),q=F[2].toUpperCase();return z+(q==="MB"?L:L/1024)}return z},0),H=k<1?`${(k*1024).toFixed(1)} KB`:`${k.toFixed(1)} MB`,J=z=>({"Lab Results":"from-blue-500 to-cyan-600",Prescriptions:"from-green-500 to-emerald-600","Treatment Plans":"from-purple-500 to-violet-600",Insurance:"from-orange-500 to-amber-600",Forms:"from-pink-500 to-rose-600",Reports:"from-indigo-500 to-blue-600"})[z]||"from-gray-500 to-slate-600",G=z=>a.jsx(Ct,{className:"w-8 h-8 text-white"});return u?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-brand-teal border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Loading documents..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8",children:[a.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"Documents"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Access and manage your medical documents"})]}),a.jsxs("button",{onClick:()=>{var z;return(z=y.current)==null?void 0:z.click()},className:"bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center gap-2 animate-scale-in",children:[a.jsx(K6,{className:"w-5 h-5"}),"Upload Document"]}),a.jsx("input",{ref:y,type:"file",onChange:P,className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif"})]}),a.jsxs("div",{className:"flex gap-4 animate-slide-in-up",style:{animationDelay:"0.1s"},children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(F2,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search documents...",value:s,onChange:z=>i(z.target.value),className:"w-full pl-12 pr-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300 shadow-sm hover:shadow-md"})]}),a.jsx("button",{className:"p-3 bg-white rounded-xl shadow hover:shadow-lg transition-all duration-300 transform hover:scale-105 border-2 border-gray-200",children:a.jsx(V2,{className:"w-6 h-6 text-brand-teal"})})]})]}),a.jsx("div",{className:"mb-8 overflow-x-auto animate-slide-in-up",style:{animationDelay:"0.2s"},children:a.jsx("div",{className:"flex gap-3 min-w-max pb-2",children:I.map(z=>a.jsx("button",{onClick:()=>r(z),className:`px-5 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 whitespace-nowrap ${n===z?"bg-gradient-to-r from-brand-teal to-brand-dark text-white shadow-lg":"bg-white text-gray-700 hover:bg-gray-50 shadow"}`,children:z==="all"?"All Documents":z},z))})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[{label:"Total Documents",count:o.length,icon:Ct,color:"from-blue-500 to-cyan-600",delay:"0.3s"},{label:"Lab Results",count:j,icon:Ct,color:"from-green-500 to-emerald-600",delay:"0.4s"},{label:"Prescriptions",count:D,icon:Ct,color:"from-purple-500 to-violet-600",delay:"0.5s"},{label:"Storage Used",count:H,icon:Q6,color:"from-orange-500 to-amber-600",delay:"0.6s"}].map(z=>a.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 animate-fade-in-up",style:{animationDelay:z.delay},children:[a.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${z.color} flex items-center justify-center mb-3 animate-pulse-glow`,children:a.jsx(z.icon,{className:"w-6 h-6 text-white"})}),a.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:(typeof z.count=="number",z.count)}),a.jsx("div",{className:"text-gray-600 text-sm font-medium",children:z.label})]},z.label))}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((z,B)=>a.jsxs("div",{className:"group bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:scale-[1.02] animate-slide-in-up",style:{animationDelay:`${.7+B*.1}s`},children:[a.jsxs("div",{className:`h-48 bg-gradient-to-br ${J(z.category)} flex items-center justify-center relative overflow-hidden`,children:[a.jsx("div",{className:"absolute inset-0 bg-black/10 group-hover:bg-black/20 transition-all duration-300"}),G(z.type),a.jsx("div",{className:"absolute top-4 right-4 px-3 py-1 bg-white/90 backdrop-blur-sm rounded-full text-xs font-semibold text-gray-800",children:z.type})]}),a.jsxs("div",{className:"p-5",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2 group-hover:text-brand-teal transition-colors duration-300 line-clamp-2",children:z.name}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx("span",{className:`px-2 py-1 rounded-lg bg-gradient-to-r ${J(z.category)} text-white text-xs font-semibold`,children:z.category}),a.jsx("span",{children:z.size})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:new Date(z.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>R(z),className:"flex-1 bg-gradient-to-r from-brand-teal to-brand-dark text-white py-2 rounded-lg font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2",children:[a.jsx(qa,{className:"w-4 h-4"}),"View"]}),a.jsx("button",{onClick:()=>R(z),className:"p-2 bg-brand-light text-brand-teal rounded-lg hover:bg-brand-teal hover:text-white transform hover:scale-110 transition-all duration-300",children:a.jsx(P2,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>E(z.id),className:"p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transform hover:scale-110 transition-all duration-300",children:a.jsx(nm,{className:"w-5 h-5"})})]})]})]},z.id))}),C.length===0&&a.jsxs("div",{className:"text-center py-16 animate-fade-in",children:[a.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-brand-teal to-brand-dark rounded-full flex items-center justify-center animate-float",children:a.jsx(Ct,{className:"w-12 h-12 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No documents found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:s?`No documents match "${s}"`:n==="all"?"Upload your first document to get started.":`No documents in ${n}.`}),a.jsx("button",{onClick:()=>{var z;return(z=y.current)==null?void 0:z.click()},className:"bg-gradient-to-r from-brand-yellow to-orange-400 hover:from-orange-400 hover:to-brand-yellow text-brand-dark px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",children:"Upload Document"})]}),h&&b&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full mx-4 shadow-2xl animate-scale-in",children:[a.jsx("div",{className:"bg-gradient-to-r from-brand-teal to-brand-dark p-6 rounded-t-2xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Upload Document"}),a.jsx("p",{className:"text-brand-yellow text-sm",children:"Uploading to your medical records"})]}),!g&&a.jsx("button",{onClick:T,className:"text-white hover:text-brand-yellow transition-colors p-2 hover:bg-white/10 rounded-lg",children:a.jsx(ir,{className:"w-6 h-6"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"mb-6 p-4 bg-brand-light rounded-xl",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-brand-teal to-brand-dark flex items-center justify-center flex-shrink-0",children:a.jsx(Ct,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-gray-800 truncate",children:b.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[(b.size/1024).toFixed(2)," KB"]})]})]})}),g&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Uploading..."}),a.jsxs("span",{className:"text-sm font-semibold text-brand-teal",children:[S,"%"]})]}),a.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-brand-teal to-brand-dark transition-all duration-300 rounded-full",style:{width:`${S}%`}})})]}),a.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ct,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Important:"}),a.jsxs("ul",{className:"space-y-1 list-disc list-inside text-xs",children:[a.jsx("li",{children:"Maximum file size: 10MB"}),a.jsx("li",{children:"Supported formats: PDF, DOC, DOCX, JPG, PNG"}),a.jsx("li",{children:"Documents are securely encrypted"})]})]})]})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:T,disabled:g,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),a.jsx("button",{onClick:O,disabled:g,className:"flex-1 bg-gradient-to-r from-brand-teal to-brand-dark text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Gt,{className:"w-5 h-5"}),a.jsx("span",{children:"Upload"})]})})]})]})]})})]})},AM=()=>{const{user:t,showToast:e}=lt(),[n,r]=A.useState(""),[s,i]=A.useState([]),[o,l]=A.useState(null),[u,d]=A.useState(!0),[h,m]=A.useState(!1),g=A.useRef(null),v={name:"Dermaglare Support",role:"Customer Support",avatar:"DS"};A.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{d(!0);const E=await M6(t.uid,t.displayName||t.email||"Patient");l(E);const R=await O6(E),P=R.map(O=>{var I;let T="support",w="";return O.senderId===t.uid?T="user":O.senderRole==="doctor"||O.senderId==="doctor"||(I=O.senderName)!=null&&I.toLowerCase().includes("dr")?(T="doctor",w=O.senderName||"Dr. Jabu Nkehli"):(T="support",w=O.senderName||"Support Team"),{id:O.id||"",sender:T,text:O.text,timestamp:S(O.timestamp),read:O.read||!1,senderName:w}});i(P),R.length>0&&await F6(E),d(!1)}catch(E){console.error("Error initializing chat:",E),e("Failed to load chat","error"),d(!1)}})()},[t]),A.useEffect(()=>{if(!o||!(t!=null&&t.uid))return;const y=U6(o,E=>{const R=E.map(P=>{var w;let O="support",T="";return P.senderId===t.uid?O="user":P.senderRole==="doctor"||P.senderId==="doctor"||(w=P.senderName)!=null&&w.toLowerCase().includes("dr")?(O="doctor",T=P.senderName||"Dr. Jabu Nkehli"):(O="support",T=P.senderName||"Support Team"),{id:P.id||"",sender:O,text:P.text,timestamp:S(P.timestamp),read:P.read||!1,senderName:T}});i(R)});return()=>y()},[o,t]);const S=y=>{if(!y)return"";let E;return y.toDate?E=y.toDate():y.seconds?E=new Date(y.seconds*1e3):E=new Date(y),E.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},N=()=>{var y;(y=g.current)==null||y.scrollIntoView({behavior:"smooth"})};A.useEffect(()=>{N()},[s]);const b=async y=>{var R;if(y.preventDefault(),!n.trim()||!o||!(t!=null&&t.uid)||h)return;const E=n.trim();try{m(!0),r("");const P=t.displayName||((R=t.email)==null?void 0:R.split("@")[0])||"Patient";await V6(o,t.uid,E,P),N()}catch(P){console.error("Error sending message:",P),e("Failed to send message","error"),r(E)}finally{m(!1)}},x=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),b(y))};return a.jsxs("div",{className:"h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 p-8 flex flex-col",children:[a.jsxs("div",{className:"mb-6 animate-fade-in-down",children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-2 animate-gradient-x",children:"Messages"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Connect with your healthcare providers"})]}),a.jsx("div",{className:"flex-1 flex flex-col overflow-hidden animate-slide-in-up",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col h-full",children:[a.jsxs("div",{className:"bg-gradient-to-r from-brand-teal to-brand-dark p-4 flex items-center justify-between animate-slide-in-down",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center text-brand-teal font-bold",children:v.avatar}),a.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 rounded-full border-2 border-white animate-pulse-glow"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:v.name}),a.jsxs("p",{className:"text-xs text-brand-yellow",children:["Online"," "," ",v.role]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 transform hover:scale-110",children:a.jsx(M2,{className:"w-5 h-5 text-white"})}),a.jsx("button",{className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 transform hover:scale-110",children:a.jsx(X6,{className:"w-5 h-5 text-white"})}),a.jsx("button",{className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 transform hover:scale-110",children:a.jsx(J6,{className:"w-5 h-5 text-white"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-b from-brand-light/20 to-white",children:[u?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-brand-teal mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]})}):s.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center animate-fade-in",children:[a.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-brand-teal to-brand-dark rounded-full flex items-center justify-center animate-float",children:a.jsx(Aw,{className:"w-10 h-10 text-white"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Start the conversation"}),a.jsxs("p",{className:"text-gray-500",children:["Send a message to ",v.name]})]})}):s.map((y,E)=>a.jsx("div",{className:`flex ${y.sender==="user"?"justify-end":"justify-start"} animate-slide-in-up`,style:{animationDelay:`${E*.05}s`},children:a.jsxs("div",{className:"max-w-[70%]",children:[y.sender==="doctor"&&a.jsxs("div",{className:"flex items-center gap-2 mb-2 ml-2",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center text-white text-xs font-bold",children:"JN"}),a.jsx("span",{className:"text-xs font-semibold text-purple-600 bg-purple-50 px-2 py-1 rounded-full",children:y.senderName||"Dr. Jabu Nkehli"})]}),y.sender==="support"&&a.jsx("div",{className:"flex items-center gap-2 mb-2 ml-2",children:a.jsx("span",{className:"text-xs font-semibold text-gray-600 bg-gray-100 px-2 py-1 rounded-full",children:y.senderName||"Support Team"})}),a.jsxs("div",{className:`${y.sender==="user"?"bg-gradient-to-br from-brand-teal to-brand-dark text-white":y.sender==="doctor"?"bg-gradient-to-br from-purple-500 to-violet-600 text-white border-2 border-purple-300":"bg-white shadow-md"} rounded-2xl p-4 transform hover:scale-[1.02] transition-all duration-300`,children:[a.jsx("p",{className:`mb-2 ${y.sender==="user"||y.sender==="doctor"?"text-white":"text-gray-800"}`,children:y.text}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:`text-xs ${y.sender==="user"?"text-brand-yellow":y.sender==="doctor"?"text-purple-200":"text-gray-500"}`,children:y.timestamp}),y.sender==="user"&&a.jsx(Gt,{className:`w-4 h-4 ${y.read?"text-brand-yellow":"text-white/50"}`})]})]})]})},y.id)),h&&a.jsx("div",{className:"flex justify-end animate-fade-in",children:a.jsx("div",{className:"max-w-[70%] bg-gradient-to-br from-brand-teal/50 to-brand-dark/50 text-white rounded-2xl p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce"}),a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),a.jsx("span",{className:"text-xs text-brand-yellow",children:"Sending..."})]})})}),a.jsx("div",{ref:g})]}),a.jsx("form",{onSubmit:b,className:"p-4 border-t border-gray-200 bg-white",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",className:"p-2 text-brand-teal hover:bg-brand-light rounded-lg transition-all duration-300 transform hover:scale-110",children:a.jsx(Y6,{className:"w-5 h-5"})}),a.jsx("button",{type:"button",className:"p-2 text-brand-teal hover:bg-brand-light rounded-lg transition-all duration-300 transform hover:scale-110",children:a.jsx(Z6,{className:"w-5 h-5"})}),a.jsx("input",{type:"text",value:n,onChange:y=>r(y.target.value),onKeyPress:x,placeholder:"Type your message...",disabled:h,className:"flex-1 px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-brand-teal outline-none transition-all duration-300 disabled:opacity-50"}),a.jsx("button",{type:"submit",disabled:!n.trim()||h,className:"bg-gradient-to-r from-brand-teal to-brand-dark text-white p-3 rounded-xl hover:shadow-lg transform hover:scale-110 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center min-w-[48px]",children:h?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(Aw,{className:"w-5 h-5"})})]})})]})})]})},PM=()=>{const[t,e]=A.useState([]),[n,r]=A.useState("all"),[s,i]=A.useState(!0),{user:o,showToast:l}=lt(),u=Xa();A.useEffect(()=>{(async()=>{if(o!=null&&o.uid)try{i(!0);const b=await vM(o.uid);e(b)}catch(b){console.error("Error fetching notifications:",b),l("Failed to load notifications","error")}finally{i(!1)}})()},[o,l]);const d=n==="unread"?t.filter(N=>!N.read):t,h=t.filter(N=>!N.read).length,m=async N=>{var b;try{N.read||(await W2(N.id),e(t.map(x=>x.id===N.id?{...x,read:!0}:x))),N.actionUrl?u(N.actionUrl):(b=N.relatedTo)!=null&&b.appointmentId&&u("/appointments")}catch(x){console.error("Error handling notification click:",x),l("Failed to mark notification as read","error")}},g=async()=>{if(o!=null&&o.uid)try{await wM(o.uid),e(t.map(N=>({...N,read:!0}))),l("All notifications marked as read","success")}catch(N){console.error("Error marking all as read:",N),l("Failed to mark all as read","error")}},v=N=>{switch(N){case"urgent":return"border-red-500 bg-red-50";case"high":return"border-orange-500 bg-orange-50";case"medium":return"border-blue-500 bg-blue-50";case"low":return"border-gray-300 bg-gray-50";default:return"border-gray-300 bg-gray-50"}},S=N=>{switch(N){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return s?a.jsx("div",{className:"max-w-6xl mx-auto",children:a.jsxs("div",{className:"animate-pulse space-y-4",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),a.jsx("div",{className:"h-32 bg-gray-200 rounded"}),a.jsx("div",{className:"h-32 bg-gray-200 rounded"}),a.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})}):a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),h>0&&a.jsx("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg transition-colors",children:"Mark all as read"})]}),a.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[a.jsxs("button",{onClick:()=>r("all"),className:`px-6 py-3 font-medium transition-colors relative ${n==="all"?"text-teal-600 border-b-2 border-teal-600":"text-gray-600 hover:text-gray-900"}`,children:["All",a.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",t.length,")"]})]}),a.jsxs("button",{onClick:()=>r("unread"),className:`px-6 py-3 font-medium transition-colors relative ${n==="unread"?"text-teal-600 border-b-2 border-teal-600":"text-gray-600 hover:text-gray-900"}`,children:["Unread",h>0&&a.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-semibold bg-red-500 text-white rounded-full",children:h})]})]})]}),a.jsx("div",{className:"space-y-4",children:d.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n==="unread"?"No unread notifications":"No notifications yet"}),a.jsx("p",{className:"text-gray-500",children:n==="unread"?"You're all caught up! All notifications have been read.":"You'll see notifications here when you receive them."})]}):d.map(N=>a.jsx("div",{onClick:()=>m(N),className:`bg-white rounded-xl shadow-sm border-l-4 cursor-pointer hover:shadow-md transition-all ${N.read?"border-gray-300":v(N.priority)}`,children:a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsx("div",{className:"text-4xl flex-shrink-0",children:G2(N.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:N.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[N.priority!=="low"&&a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${S(N.priority)}`,children:N.priority.toUpperCase()}),!N.read&&a.jsx("div",{className:"w-3 h-3 bg-teal-500 rounded-full"})]})]}),a.jsx("p",{className:"text-gray-700 whitespace-pre-line mb-3",children:N.message}),a.jsx("p",{className:"text-sm text-gray-500",children:K2(N.createdAt)})]})]})})})},N.id))}),t.length===0&&a.jsxs("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-xl p-6",children:[a.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:" How Notifications Work"}),a.jsx("p",{className:"text-sm text-blue-700",children:"You'll receive notifications when:"}),a.jsxs("ul",{className:"mt-2 text-sm text-blue-700 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Your appointment is approved or declined"}),a.jsx("li",{children:"Payment is confirmed"}),a.jsx("li",{children:"Important updates about your account"})]})]})]})},RM=({onLoadingComplete:t})=>{const[e,n]=A.useState(0),[r,s]=A.useState(!1);return A.useEffect(()=>{const i=setInterval(()=>{n(l=>l>=100?(clearInterval(i),100):l+2)},100),o=setTimeout(()=>{s(!0),setTimeout(()=>{t()},500)},5e3);return()=>{clearInterval(i),clearTimeout(o)}},[t]),a.jsxs("div",{className:`fixed inset-0 bg-gradient-to-br from-brand-light via-white to-brand-yellow/20 flex items-center justify-center z-[9999] transition-opacity duration-500 ${r?"opacity-0":"opacity-100"}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(20)].map((i,o)=>a.jsx("div",{className:"absolute w-2 h-2 bg-brand-teal/30 rounded-full animate-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`,animationDuration:`${5+Math.random()*10}s`}},o)),a.jsx("div",{className:"absolute top-20 left-20 w-64 h-64 bg-brand-teal/20 rounded-full blur-3xl animate-pulse-glow"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-brand-yellow/30 rounded-full blur-3xl animate-pulse-glow",style:{animationDelay:"1s"}}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-gradient-to-r from-brand-teal/10 to-brand-yellow/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),a.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[a.jsxs("div",{className:"relative mb-12 animate-scale-in",children:[a.jsx("div",{className:"absolute inset-0 -m-8",children:a.jsx("div",{className:"w-full h-full border-4 border-brand-teal/30 rounded-full animate-ping"})}),a.jsx("div",{className:"absolute inset-0 -m-12",children:a.jsx("div",{className:"w-full h-full border-2 border-brand-yellow/30 rounded-full animate-pulse",style:{animationDelay:"0.5s"}})}),a.jsx("div",{className:"absolute inset-0 -m-16",children:a.jsx("div",{className:"w-full h-full border-2 border-brand-teal/20 rounded-full animate-ping",style:{animationDelay:"1s"}})}),a.jsx("div",{className:"relative bg-white p-8 rounded-3xl shadow-2xl",children:a.jsx("img",{src:"https://dermaglareskin.co.za/wp-content/uploads/2023/07/Dermaglare-Skin.png",alt:"Dermaglare",className:"h-24 w-auto object-contain animate-pulse-glow"})}),a.jsx("div",{className:"absolute -top-4 -right-4 w-8 h-8 bg-brand-yellow rounded-full animate-bounce opacity-75"}),a.jsx("div",{className:"absolute -bottom-4 -left-4 w-6 h-6 bg-brand-teal rounded-full animate-bounce opacity-75",style:{animationDelay:"0.3s"}})]}),a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-brand-teal via-brand-dark to-brand-teal bg-clip-text text-transparent mb-4 animate-gradient-x",children:"Welcome to Dermaglare"}),a.jsx("p",{className:"text-gray-600 text-lg mb-8 animate-fade-in",children:"Preparing your skincare journey..."}),a.jsx("div",{className:"w-80 h-3 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-brand-teal via-brand-yellow to-brand-teal rounded-full transition-all duration-300 ease-out animate-shimmer",style:{width:`${e}%`,backgroundSize:"200% 100%"}})}),a.jsxs("p",{className:"text-brand-teal font-semibold mt-3 text-sm",children:[e,"% Complete"]}),a.jsxs("div",{className:"flex gap-2 mt-8",children:[a.jsx("div",{className:"w-3 h-3 bg-brand-teal rounded-full animate-bounce"}),a.jsx("div",{className:"w-3 h-3 bg-brand-yellow rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-3 h-3 bg-brand-dark rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-500 text-sm italic animate-fade-in",children:[e<20&&" Loading your personalized dashboard...",e>=20&&e<40&&" Securing your data...",e>=40&&e<60&&" Syncing appointments...",e>=60&&e<80&&" Preparing documents...",e>=80&&e<100&&" Almost there...",e>=100&&" Ready!"]})})]}),a.jsx("div",{className:"absolute bottom-10 left-10 w-16 h-16 border-4 border-brand-teal/20 rounded-full animate-spin-slow"}),a.jsx("div",{className:"absolute top-10 right-10 w-12 h-12 border-4 border-brand-yellow/20 rounded-full animate-spin-slow",style:{animationDelay:"1s"}})]})};class jM extends A.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.handleReload=()=>{window.location.href="/login"}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-brand-light via-white to-brand-light/50 flex items-center justify-center p-8",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8 text-center",children:[a.jsx("div",{className:"w-20 h-20 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-6",children:a.jsx("svg",{className:"w-10 h-10 text-red-600",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Oops! Something went wrong"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry, but something unexpected happened. Please try reloading the page."}),this.state.error&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 text-left",children:a.jsx("p",{className:"text-sm text-red-800 font-mono break-all",children:this.state.error.message})}),a.jsx("button",{onClick:this.handleReload,className:"w-full px-6 py-3 bg-gradient-to-r from-brand-teal to-brand-dark text-white rounded-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all",children:"Return to Login"})]})}):this.props.children}}const DM=()=>{const{user:t}=lt();return t?a.jsx(_M,{children:a.jsxs(nb,{children:[a.jsx($t,{path:"dashboard",element:a.jsx(EM,{})}),a.jsx($t,{path:"appointments",element:a.jsx(kM,{})}),a.jsx($t,{path:"documents",element:a.jsx(CM,{})}),a.jsx($t,{path:"chat",element:a.jsx(AM,{})}),a.jsx($t,{path:"billing",element:a.jsx(fM,{})}),a.jsx($t,{path:"notifications",element:a.jsx(PM,{})}),a.jsx($t,{path:"profile",element:a.jsx(TM,{})}),a.jsx($t,{path:"settings",element:a.jsx(SM,{})}),a.jsx($t,{path:"*",element:a.jsx(ip,{to:"/dashboard",replace:!0})})]})}):null},LM=()=>{const{user:t}=lt();return t?a.jsx(DM,{}):a.jsx(ip,{to:"/login",replace:!0})},MM=()=>{const{user:t}=lt();return t?a.jsx(ip,{to:"/dashboard",replace:!0}):a.jsx(US,{})};function OM(){const{loading:t}=lt(),[e,n]=A.useState(()=>{try{return!sessionStorage.getItem("hasShownLoading")}catch(s){return console.error("SessionStorage error:",s),!1}}),r=()=>{n(!1);try{sessionStorage.setItem("hasShownLoading","true")}catch(s){console.error("SessionStorage error:",s)}};return e&&!t?a.jsx(RM,{onLoadingComplete:r}):t?a.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900 text-white",children:a.jsx("div",{className:"text-xl font-semibold animate-pulse",children:"Loading Patient Portal..."})}):a.jsx(jM,{children:a.jsxs(nb,{children:[a.jsx($t,{element:a.jsx(MM,{}),children:a.jsx($t,{path:"/login",element:a.jsx(gM,{})})}),a.jsx($t,{path:"/*",element:a.jsx(LM,{})})]})})}Ah.createRoot(document.getElementById("root")).render(a.jsx(qw.StrictMode,{children:a.jsx(uk,{children:a.jsx($6,{children:a.jsx(NM,{children:a.jsx(OM,{})})})})}));export{re as a,Ft as b,Ae as c,je as d,En as g,ye as s};
